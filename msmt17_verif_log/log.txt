[08/23 10:54:15] fastreid INFO: Rank of current process: 0. World size: 1
[08/23 10:54:16] fastreid INFO: Environment info:
----------------------  ------------------------------------------------------------------------------------
sys.platform            linux
Python                  3.7.9 (default, Aug 31 2020, 12:42:55) [GCC 7.3.0]
numpy                   1.19.2
fastreid                1.3 @./fastreid
FASTREID_ENV_MODULE     <not set>
PyTorch                 1.6.0 @/home/huangju/anaconda3/envs/fastreid/lib/python3.7/site-packages/torch
PyTorch debug build     False
GPU available           True
GPU 0                   NVIDIA GeForce GTX 1080 Ti
CUDA_HOME               /usr/local/cuda
Pillow                  8.1.0
torchvision             0.7.0 @/home/huangju/anaconda3/envs/fastreid/lib/python3.7/site-packages/torchvision
torchvision arch flags  sm_35, sm_50, sm_60, sm_70, sm_75
cv2                     3.4.2
----------------------  ------------------------------------------------------------------------------------
PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) Math Kernel Library Version 2020.0.2 Product Build 20200624 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v1.5.0 (Git Hash e2ac1fac44c5078ca927cb9b90e1b3066a0b2ed0)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 10.2
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_37,code=compute_37
  - CuDNN 7.6.5
  - Magma 2.5.2
  - Build settings: BLAS=MKL, BUILD_TYPE=Release, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DUSE_VULKAN_WRAPPER -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, USE_CUDA=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_STATIC_DISPATCH=OFF, 

[08/23 10:54:16] fastreid INFO: Command line arguments: Namespace(config_file='./configs/BOT-verif-msmt17.yml', dist_url='tcp://127.0.0.1:50190', eval_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=[], resume=False)
[08/23 10:54:16] fastreid INFO: Contents of args.config_file=./configs/BOT-verif-msmt17.yml:
_BASE_: "./Base-bagtricks.yml"
MODEL:
  META_ARCHITECTURE: "BaselineVerifMemBank"

  BACKBONE:
    NAME: "build_resnet_backbone"
  LOSSES:
    NAME: ("VerificationLoss")

TEST:
  EVAL_PERIOD: 5

DATASETS:
  NAMES: ("Market1501",)
  TESTS: ("Market1501",)

DATALOADER:
  PK_SAMPLER: True
  NAIVE_WAY: True
  PERSON_NUMBER: 1041
  PERSON_NUMBER_TEST: 3060
OUTPUT_DIR: "logs/BoT_verif_msmt17"
[08/23 10:54:16] fastreid INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  NAIVE_WAY: True
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  PERSON_NUMBER: 1041
  PERSON_NUMBER_TEST: 3060
  PK_SAMPLER: True
  SEQ_LEN: 8
  TEST_SEQ_LEN: 0
DATASETS:
  COMBINEALL: False
  NAMES: ('Market1501',)
  TESTS: ('Market1501',)
INPUT:
  AUGMIX_PROB: 0.0
  AUTOAUG_PROB: 0.0
  CJ:
    BRIGHTNESS: 0.15
    CONTRAST: 0.15
    ENABLED: False
    HUE: 0.1
    PROB: 0.5
    SATURATION: 0.1
  DO_AUGMIX: False
  DO_AUTOAUG: False
  DO_FLIP: True
  DO_PAD: True
  DO_RANDAUG: False
  FLIP_PROB: 0.5
  MIX_TRACKLET: False
  PADDING: 10
  PADDING_MODE: constant
  RANDAUG_PROB: 0.5
  RANDAUG_STR: rand-m9-mstd0.5
  REA:
    ENABLED: True
    PROB: 0.5
    VALUE: [151.98, 142.29000000000002, 126.735]
  RPT:
    ENABLED: False
    PROB: 0.5
  SIZE_TEST: [256, 128]
  SIZE_TRAIN: [256, 128]
MODEL:
  BACKBONE:
    DEPTH: 50x
    FEAT_DIM: 2560
    LAST_STRIDE: 1
    NAME: build_resnet_backbone
    NORM: BN
    PRETRAIN: True
    PRETRAIN_PATH: 
    REMOVE: (3, 4)
    WITH_IBN: False
    WITH_NL: False
    WITH_SE: False
  DEVICE: cuda
  FREEZE_LAYERS: ['']
  HEADS:
    CLS_LAYER: linear
    EMBEDDING_DIM: 0
    HASH_LAYER_DIMS: []
    HASH_LAYER_NUM: 1
    MARGIN: 0.15
    NAME: EmbeddingHead
    NECK_FEAT: before
    NORM: BN
    NUM_CLASSES: 0
    POOL_LAYER: avgpool
    SCALE: 128
    TEMP: 1.0
    WITH_BNNECK: True
  LOSSES:
    CE:
      ALPHA: 0.2
      EPSILON: 0.1
      SCALE: 1.0
    CIRCLE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    COSFACE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    FL:
      ALPHA: 0.25
      GAMMA: 2
      SCALE: 1.0
    NAME: VerificationLoss
    TRI:
      HARD_MINING: True
      MARGIN: 0.3
      NORM_FEAT: False
      SCALE: 1.0
  META_ARCHITECTURE: BaselineVerifMemBank
  PIXEL_MEAN: [123.675, 116.28, 103.53]
  PIXEL_STD: [58.395, 57.120000000000005, 57.375]
  TRANSFORMER:
    DEPTH: 12
    EMBED_DIM: 768
    ENABLE_POS: False
    FEATURE_DIM: 2048
    INPUT_SIZE: (512, 64, 32)
    NAME: TransformerHead
    NUM_HEADS: 3
    PART_H: 4
    PART_STR: ('4x1',)
    PART_V: 1
    PATH_DROP: 0.1
    POS_DROP: 0.0
  TRANSFORMER_S:
    ATTN_DROP: 0.0
    CE_SCALE: 1.0
    DEPTH: 12
    EMBED_DIM: 768
    ENABLE_POS: False
    FEATURE_DIM: 2048
    GAP: False
    INPUT_SIZE: (512, 64, 32)
    LOCAL_PART: 4
    NAME: SpatialTransformerHead
    NUM_HEADS: 3
    PART_STR: 8x4
    PATH_DROP: 0.1
    POS_DROP: 0.0
    RET_ALL: False
  TRANSFORMER_T:
    ATTN_DROP: 0.0
    DEPTH: 12
    EMBED_DIM: 768
    ENABLE_POS: False
    GAP: False
    NAME: TemporalTransformerHead
    NUM_HEADS: 3
    PATH_DROP: 0.1
    POS_DROP: 0.0
    RET_ALL: False
    RET_ATTN: False
  WEIGHTS: 
OUTPUT_DIR: logs/BoT_verif_msmt17
SOLVER:
  BASE_LR: 0.00035
  BIAS_LR_FACTOR: 2.0
  CHECKPOINT_PERIOD: 30
  CLIP_GRADIENTS:
    CLIP_TYPE: norm
    CLIP_VALUE: 5.0
    ENABLED: False
    NORM_TYPE: 2.0
  DELAY_EPOCHS: 0
  ETA_MIN_LR: 1e-07
  FP16_ENABLED: True
  FREEZE_FC_ITERS: 0
  FREEZE_ITERS: 0
  GAMMA: 0.1
  HEADS_LR_FACTOR: 1.0
  IMS_PER_BATCH: 32
  MAX_EPOCH: 60
  MOMENTUM: 0.9
  OPT: Adam
  SCHED: MultiStepLR
  STEPS: [40, 90]
  TRANS_LR_FACTOR: 1.0
  WARMUP_FACTOR: 0.1
  WARMUP_ITERS: 2000
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0005
  WEIGHT_DECAY_BIAS: 0.0005
  WEIGHT_DECAY_NORM: 0.0005
  WEIGHT_DECAY_TRANS: 0.0005
TEST:
  AQE:
    ALPHA: 3.0
    ENABLED: False
    QE_K: 5
    QE_TIME: 1
  ERASE_NUM: 64
  EVAL_PERIOD: 5
  FLIP_ENABLED: False
  HASH_RATE: 0.3
  IMS_PER_BATCH: 128
  METRIC: cosine
  NEIGHBOR_RANGE: 100
  PRECISE_BN:
    DATASET: Market1501
    ENABLED: False
    NUM_ITER: 300
  RERANK:
    ENABLED: False
    K1: 20
    K2: 6
    LAMBDA: 0.3
  ROC_ENABLED: False
  SEQ_TEST: False
  TIMES: 1
  VERIF: False
[08/23 10:54:16] fastreid INFO: Full config saved to /home/huangju/codes/fast-reid/logs/BoT_verif_msmt17/config.yaml
[08/23 10:54:16] fastreid.utils.env INFO: Using a generated random seed 18207642
[08/23 10:54:17] fastreid INFO: Model:
BaselineVerifMemBank(
  (heads): EmbeddingHead(
    (pool_layer): AdaptiveAvgPool2d(output_size=1)
    (bottleneck): Sequential(
      (0): BatchNorm(2560, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (classifier): Linear(in_features=2560, out_features=0, bias=False)
  )
  (verif_model): VerifHead(
    (pool_layer): AdaptiveAvgPool2d(output_size=1)
    (bottleneck): Sequential(
      (0): Conv2d(2560, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
    )
    (classifier): Sequential(
      (0): Linear(in_features=1024, out_features=512, bias=True)
      (1): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): Dropout(p=0.2, inplace=False)
      (3): PReLU(num_parameters=1)
      (4): Linear(in_features=512, out_features=256, bias=True)
      (5): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (6): PReLU(num_parameters=1)
      (7): Linear(in_features=256, out_features=128, bias=True)
      (8): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (9): PReLU(num_parameters=1)
      (10): Linear(in_features=128, out_features=64, bias=True)
      (11): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (12): PReLU(num_parameters=1)
      (13): Linear(in_features=64, out_features=32, bias=True)
      (14): BatchNorm1d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (15): PReLU(num_parameters=1)
      (16): Linear(in_features=32, out_features=16, bias=True)
      (17): BatchNorm1d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (18): PReLU(num_parameters=1)
      (19): Linear(in_features=16, out_features=2, bias=False)
    )
    (drop): Dropout(p=0.5, inplace=False)
  )
)
[08/23 10:54:18] fastreid.utils.checkpoint INFO: No checkpoint found. Training model from scratch
[08/23 10:54:19] fastreid INFO: Start training from epoch 0
[08/23 10:58:57] fastreid.utils.events INFO:  epoch/iter: 0/199  total_loss: 645.5  loss_bank_verif: 645.5  lr: 6.63e-05  max_mem: 1278M
[08/23 11:00:15] fastreid.utils.events INFO:  eta: 5:43:20  epoch/iter: 0/257  total_loss: 556.4  loss_bank_verif: 556.4  lr: 7.55e-05  max_mem: 3748M
[08/23 11:03:27] fastreid.utils.events INFO:  eta: 5:37:15  epoch/iter: 1/399  total_loss: 339.7  loss_bank_verif: 339.7  lr: 9.78e-05  max_mem: 3748M
[08/23 11:06:01] fastreid.utils.events INFO:  eta: 5:30:21  epoch/iter: 1/515  total_loss: 235.7  loss_bank_verif: 235.7  lr: 1.16e-04  max_mem: 3748M
[08/23 11:07:53] fastreid.utils.events INFO:  eta: 5:30:47  epoch/iter: 2/599  total_loss: 176.1  loss_bank_verif: 176.1  lr: 1.29e-04  max_mem: 3748M
[08/23 11:11:46] fastreid.utils.events INFO:  eta: 5:26:10  epoch/iter: 2/773  total_loss: 108.8  loss_bank_verif: 108.8  lr: 1.57e-04  max_mem: 3748M
[08/23 11:12:21] fastreid.utils.events INFO:  eta: 5:27:26  epoch/iter: 3/799  total_loss: 101.1  loss_bank_verif: 101.1  lr: 1.61e-04  max_mem: 3748M
[08/23 11:16:50] fastreid.utils.events INFO:  eta: 5:22:55  epoch/iter: 3/999  total_loss: 36.69  loss_bank_verif: 36.69  lr: 1.92e-04  max_mem: 3748M
[08/23 11:17:32] fastreid.utils.events INFO:  eta: 5:14:35  epoch/iter: 3/1031  total_loss: 33.36  loss_bank_verif: 33.36  lr: 1.97e-04  max_mem: 3748M
[08/23 11:21:17] fastreid.utils.events INFO:  eta: 5:18:29  epoch/iter: 4/1199  total_loss: 17.69  loss_bank_verif: 17.69  lr: 2.24e-04  max_mem: 3748M
[08/23 11:23:18] fastreid.utils.events INFO:  eta: 5:14:25  epoch/iter: 4/1289  total_loss: 14.74  loss_bank_verif: 14.74  lr: 2.38e-04  max_mem: 3748M
[08/23 12:35:04] fastreid INFO: accuracy on test set: 99.967320 %
[08/23 12:35:04] fastreid INFO: img_correct on test set: 0 %
[08/23 12:35:04] fastreid INFO: img_accuracy on test set: 0.000000 %
[08/23 12:37:32] fastreid.utils.events INFO:  eta: 6 days, 13:42:22  epoch/iter: 5/1399  total_loss: 10.32  loss_bank_verif: 10.32  lr: 2.55e-04  max_mem: 3748M
[08/23 12:40:50] fastreid.utils.events INFO:  eta: 5:08:44  epoch/iter: 5/1547  total_loss: 5.98  loss_bank_verif: 5.98  lr: 2.79e-04  max_mem: 3748M
[08/23 12:41:59] fastreid.utils.events INFO:  eta: 5:08:54  epoch/iter: 6/1599  total_loss: 5.271  loss_bank_verif: 5.271  lr: 2.87e-04  max_mem: 3748M
[08/23 12:46:28] fastreid.utils.events INFO:  eta: 5:04:39  epoch/iter: 6/1799  total_loss: 3.331  loss_bank_verif: 3.331  lr: 3.18e-04  max_mem: 3748M
[08/23 12:46:35] fastreid.utils.events INFO:  eta: 4:27:46  epoch/iter: 6/1805  total_loss: 3.273  loss_bank_verif: 3.273  lr: 3.19e-04  max_mem: 3748M
[08/23 12:50:56] fastreid.utils.events INFO:  eta: 5:01:09  epoch/iter: 7/1999  total_loss: 2.293  loss_bank_verif: 2.293  lr: 3.50e-04  max_mem: 3748M
[08/23 12:52:21] fastreid.utils.events INFO:  eta: 4:55:20  epoch/iter: 7/2063  total_loss: 2.206  loss_bank_verif: 2.206  lr: 3.50e-04  max_mem: 3748M
[08/23 12:55:24] fastreid.utils.events INFO:  eta: 4:55:50  epoch/iter: 8/2199  total_loss: 1.785  loss_bank_verif: 1.785  lr: 3.50e-04  max_mem: 3748M
[08/23 12:58:06] fastreid.utils.events INFO:  eta: 4:50:33  epoch/iter: 8/2321  total_loss: 1.391  loss_bank_verif: 1.391  lr: 3.50e-04  max_mem: 3748M
[08/23 12:59:51] fastreid.utils.events INFO:  eta: 4:52:15  epoch/iter: 9/2399  total_loss: 1.209  loss_bank_verif: 1.209  lr: 3.50e-04  max_mem: 3748M
[08/23 13:03:52] fastreid.utils.events INFO:  eta: 4:46:13  epoch/iter: 9/2579  total_loss: 0.9329  loss_bank_verif: 0.9329  lr: 3.50e-04  max_mem: 3748M
[08/23 14:14:56] fastreid INFO: accuracy on test set: 99.967320 %
[08/23 14:14:56] fastreid INFO: img_correct on test set: 0 %
[08/23 14:14:56] fastreid INFO: img_accuracy on test set: 0.000000 %
[08/23 14:15:24] fastreid.utils.events INFO:  eta: 31 days, 20:11:50  epoch/iter: 10/2599  total_loss: 0.9054  loss_bank_verif: 0.9054  lr: 3.50e-04  max_mem: 3748M
[08/23 14:19:57] fastreid.utils.events INFO:  eta: 4:47:16  epoch/iter: 10/2799  total_loss: 0.7276  loss_bank_verif: 0.7276  lr: 3.50e-04  max_mem: 3748M
[08/23 14:20:47] fastreid.utils.events INFO:  eta: 4:39:19  epoch/iter: 10/2837  total_loss: 0.714  loss_bank_verif: 0.714  lr: 3.50e-04  max_mem: 3748M
[08/23 14:24:28] fastreid.utils.events INFO:  eta: 4:41:23  epoch/iter: 11/2999  total_loss: 0.5723  loss_bank_verif: 0.5723  lr: 3.50e-04  max_mem: 3748M
[08/23 14:26:37] fastreid.utils.events INFO:  eta: 4:37:09  epoch/iter: 11/3095  total_loss: 0.5214  loss_bank_verif: 0.5214  lr: 3.50e-04  max_mem: 3748M
[08/23 14:28:59] fastreid.utils.events INFO:  eta: 4:37:18  epoch/iter: 12/3199  total_loss: 0.4781  loss_bank_verif: 0.4781  lr: 3.50e-04  max_mem: 3748M
[08/23 14:32:27] fastreid.utils.events INFO:  eta: 4:31:23  epoch/iter: 12/3353  total_loss: 0.4263  loss_bank_verif: 0.4263  lr: 3.50e-04  max_mem: 3748M
[08/23 14:33:30] fastreid.utils.events INFO:  eta: 4:34:12  epoch/iter: 13/3399  total_loss: 0.3951  loss_bank_verif: 0.3951  lr: 3.50e-04  max_mem: 3748M
[08/23 14:38:01] fastreid.utils.events INFO:  eta: 4:27:15  epoch/iter: 13/3599  total_loss: 0.3302  loss_bank_verif: 0.3302  lr: 3.50e-04  max_mem: 3748M
[08/23 14:38:17] fastreid.utils.events INFO:  eta: 4:18:36  epoch/iter: 13/3611  total_loss: 0.3297  loss_bank_verif: 0.3297  lr: 3.50e-04  max_mem: 3748M
[08/23 14:42:32] fastreid.utils.events INFO:  eta: 4:23:28  epoch/iter: 14/3799  total_loss: 0.2881  loss_bank_verif: 0.2881  lr: 3.50e-04  max_mem: 3748M
[08/23 14:44:07] fastreid.utils.events INFO:  eta: 4:19:43  epoch/iter: 14/3869  total_loss: 0.2778  loss_bank_verif: 0.2778  lr: 3.50e-04  max_mem: 3748M
[08/23 15:58:59] fastreid INFO: accuracy on test set: 99.967320 %
[08/23 15:58:59] fastreid INFO: img_correct on test set: 0 %
[08/23 15:58:59] fastreid INFO: img_accuracy on test set: 0.000000 %
[08/23 16:01:56] fastreid.utils.events INFO:  eta: 4 days, 17:55:20  epoch/iter: 15/3999  total_loss: 0.2555  loss_bank_verif: 0.2555  lr: 3.50e-04  max_mem: 3748M
[08/23 16:04:53] fastreid.utils.events INFO:  eta: 4:21:22  epoch/iter: 15/4127  total_loss: 0.2999  loss_bank_verif: 0.2999  lr: 3.50e-04  max_mem: 3748M
[08/23 16:08:12] fastreid.utils.events INFO:  eta: 8:36:46  epoch/iter: 16/4199  total_loss: 3.549  loss_bank_verif: 3.549  lr: 3.50e-04  max_mem: 3748M
[08/23 16:12:24] fastreid.utils.events INFO:  eta: 4:08:31  epoch/iter: 16/4385  total_loss: 1.091  loss_bank_verif: 1.091  lr: 3.50e-04  max_mem: 3748M
[08/23 16:12:43] fastreid.utils.events INFO:  eta: 4:10:33  epoch/iter: 17/4399  total_loss: 1.041  loss_bank_verif: 1.041  lr: 3.50e-04  max_mem: 3748M
[08/23 16:17:14] fastreid.utils.events INFO:  eta: 4:04:34  epoch/iter: 17/4599  total_loss: 0.3592  loss_bank_verif: 0.3592  lr: 3.50e-04  max_mem: 3748M
[08/23 16:18:13] fastreid.utils.events INFO:  eta: 4:00:36  epoch/iter: 17/4643  total_loss: 0.3022  loss_bank_verif: 0.3022  lr: 3.50e-04  max_mem: 3748M
[08/23 16:21:44] fastreid.utils.events INFO:  eta: 3:59:53  epoch/iter: 18/4799  total_loss: 0.1912  loss_bank_verif: 0.1912  lr: 3.50e-04  max_mem: 3748M
[08/23 16:24:02] fastreid.utils.events INFO:  eta: 3:57:20  epoch/iter: 18/4901  total_loss: 0.1847  loss_bank_verif: 0.1847  lr: 3.50e-04  max_mem: 3748M
[08/23 16:26:15] fastreid.utils.events INFO:  eta: 3:55:39  epoch/iter: 19/4999  total_loss: 0.1622  loss_bank_verif: 0.1622  lr: 3.50e-04  max_mem: 3748M
[08/23 16:29:52] fastreid.utils.events INFO:  eta: 3:51:40  epoch/iter: 19/5159  total_loss: 0.1238  loss_bank_verif: 0.1238  lr: 3.50e-04  max_mem: 3748M
[08/23 17:40:28] fastreid INFO: accuracy on test set: 99.967320 %
[08/23 17:40:28] fastreid INFO: img_correct on test set: 0 %
[08/23 17:40:28] fastreid INFO: img_accuracy on test set: 0.000000 %
[08/23 17:41:22] fastreid.utils.events INFO:  eta: 12 days, 16:29:10  epoch/iter: 20/5199  total_loss: 0.1275  loss_bank_verif: 0.1275  lr: 3.50e-04  max_mem: 3748M
[08/23 17:45:53] fastreid.utils.events INFO:  eta: 3:45:53  epoch/iter: 20/5399  total_loss: 0.1078  loss_bank_verif: 0.1078  lr: 3.50e-04  max_mem: 3748M
[08/23 17:46:16] fastreid.utils.events INFO:  eta: 3:35:45  epoch/iter: 20/5417  total_loss: 0.107  loss_bank_verif: 0.107  lr: 3.50e-04  max_mem: 3748M
[08/23 17:50:23] fastreid.utils.events INFO:  eta: 3:41:47  epoch/iter: 21/5599  total_loss: 0.1027  loss_bank_verif: 0.1027  lr: 3.50e-04  max_mem: 3748M
[08/23 17:52:05] fastreid.utils.events INFO:  eta: 3:37:52  epoch/iter: 21/5675  total_loss: 0.1069  loss_bank_verif: 0.1069  lr: 3.50e-04  max_mem: 3748M
[08/23 17:54:53] fastreid.utils.events INFO:  eta: 3:37:22  epoch/iter: 22/5799  total_loss: 0.1119  loss_bank_verif: 0.1119  lr: 3.50e-04  max_mem: 3748M
[08/23 17:57:53] fastreid.utils.events INFO:  eta: 3:32:22  epoch/iter: 22/5933  total_loss: 0.08738  loss_bank_verif: 0.08738  lr: 3.50e-04  max_mem: 3748M
[08/23 17:59:23] fastreid.utils.events INFO:  eta: 3:33:31  epoch/iter: 23/5999  total_loss: 0.07489  loss_bank_verif: 0.07489  lr: 3.50e-04  max_mem: 3748M
[08/23 18:03:42] fastreid.utils.events INFO:  eta: 3:27:33  epoch/iter: 23/6191  total_loss: 0.06473  loss_bank_verif: 0.06473  lr: 3.50e-04  max_mem: 3748M
[08/23 18:03:53] fastreid.utils.events INFO:  eta: 3:27:58  epoch/iter: 24/6199  total_loss: 0.06462  loss_bank_verif: 0.06462  lr: 3.50e-04  max_mem: 3748M
[08/23 18:08:23] fastreid.utils.events INFO:  eta: 3:23:09  epoch/iter: 24/6399  total_loss: 0.05634  loss_bank_verif: 0.05634  lr: 3.50e-04  max_mem: 3748M
[08/23 18:09:29] fastreid.utils.events INFO:  eta: 3:18:43  epoch/iter: 24/6449  total_loss: 0.05321  loss_bank_verif: 0.05321  lr: 3.50e-04  max_mem: 3748M
[08/23 19:20:22] fastreid INFO: accuracy on test set: 99.967320 %
[08/23 19:20:22] fastreid INFO: img_correct on test set: 0 %
[08/23 19:20:22] fastreid INFO: img_accuracy on test set: 0.000000 %
[08/23 19:23:46] fastreid.utils.events INFO:  eta: 3 days, 0:47:06  epoch/iter: 25/6599  total_loss: 0.04431  loss_bank_verif: 0.04431  lr: 3.50e-04  max_mem: 3748M
[08/23 19:26:11] fastreid.utils.events INFO:  eta: 3:15:46  epoch/iter: 25/6707  total_loss: 0.07499  loss_bank_verif: 0.07499  lr: 3.50e-04  max_mem: 3748M
[08/23 19:28:16] fastreid.utils.events INFO:  eta: 3:15:02  epoch/iter: 26/6799  total_loss: 0.1512  loss_bank_verif: 0.1512  lr: 3.50e-04  max_mem: 3748M
[08/23 19:32:00] fastreid.utils.events INFO:  eta: 3:09:54  epoch/iter: 26/6965  total_loss: 0.08065  loss_bank_verif: 0.08065  lr: 3.50e-04  max_mem: 3748M
[08/23 19:32:46] fastreid.utils.events INFO:  eta: 3:10:40  epoch/iter: 27/6999  total_loss: 0.07515  loss_bank_verif: 0.07515  lr: 3.50e-04  max_mem: 3748M
[08/23 19:37:18] fastreid.utils.events INFO:  eta: 3:05:55  epoch/iter: 27/7199  total_loss: 0.04608  loss_bank_verif: 0.04608  lr: 3.50e-04  max_mem: 3748M
[08/23 19:37:49] fastreid.utils.events INFO:  eta: 2:59:22  epoch/iter: 27/7223  total_loss: 0.04702  loss_bank_verif: 0.04702  lr: 3.50e-04  max_mem: 3748M
[08/23 19:41:48] fastreid.utils.events INFO:  eta: 3:01:33  epoch/iter: 28/7399  total_loss: 0.04306  loss_bank_verif: 0.04306  lr: 3.50e-04  max_mem: 3748M
[08/23 19:43:39] fastreid.utils.events INFO:  eta: 2:58:16  epoch/iter: 28/7481  total_loss: 0.03501  loss_bank_verif: 0.03501  lr: 3.50e-04  max_mem: 3748M
[08/23 19:46:18] fastreid.utils.events INFO:  eta: 2:56:29  epoch/iter: 29/7599  total_loss: 0.0363  loss_bank_verif: 0.0363  lr: 3.50e-04  max_mem: 3748M
[08/23 19:49:27] fastreid.utils.events INFO:  eta: 2:52:34  epoch/iter: 29/7739  total_loss: 0.03055  loss_bank_verif: 0.03055  lr: 3.50e-04  max_mem: 3748M
[08/23 20:48:18] fastreid INFO: Rank of current process: 0. World size: 1
[08/23 20:48:19] fastreid INFO: Environment info:
----------------------  ------------------------------------------------------------------------------------
sys.platform            linux
Python                  3.7.9 (default, Aug 31 2020, 12:42:55) [GCC 7.3.0]
numpy                   1.19.2
fastreid                1.3 @./fastreid
FASTREID_ENV_MODULE     <not set>
PyTorch                 1.6.0 @/home/huangju/anaconda3/envs/fastreid/lib/python3.7/site-packages/torch
PyTorch debug build     False
GPU available           True
GPU 0                   NVIDIA GeForce GTX 1080 Ti
CUDA_HOME               /usr/local/cuda
Pillow                  8.1.0
torchvision             0.7.0 @/home/huangju/anaconda3/envs/fastreid/lib/python3.7/site-packages/torchvision
torchvision arch flags  sm_35, sm_50, sm_60, sm_70, sm_75
cv2                     3.4.2
----------------------  ------------------------------------------------------------------------------------
PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) Math Kernel Library Version 2020.0.2 Product Build 20200624 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v1.5.0 (Git Hash e2ac1fac44c5078ca927cb9b90e1b3066a0b2ed0)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 10.2
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_37,code=compute_37
  - CuDNN 7.6.5
  - Magma 2.5.2
  - Build settings: BLAS=MKL, BUILD_TYPE=Release, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DUSE_VULKAN_WRAPPER -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, USE_CUDA=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_STATIC_DISPATCH=OFF, 

[08/23 20:48:19] fastreid INFO: Command line arguments: Namespace(config_file='./configs/BOT-verif-msmt17.yml', dist_url='tcp://127.0.0.1:50190', eval_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=[], resume=False)
[08/23 20:48:19] fastreid INFO: Contents of args.config_file=./configs/BOT-verif-msmt17.yml:
_BASE_: "./Base-bagtricks.yml"
MODEL:
  META_ARCHITECTURE: "BaselineVerifMemBank"

  BACKBONE:
    NAME: "build_resnet_backbone"
  LOSSES:
    NAME: ("VerificationLoss")

TEST:
  EVAL_PERIOD: 5

DATASETS:
  NAMES: ("Market1501",)
  TESTS: ("Market1501",)

DATALOADER:
  PK_SAMPLER: True
  NAIVE_WAY: True
  PERSON_NUMBER: 1041
  PERSON_NUMBER_TEST: 3060
OUTPUT_DIR: "logs/BoT_verif_msmt17"
[08/23 20:48:19] fastreid INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  NAIVE_WAY: True
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  PERSON_NUMBER: 1041
  PERSON_NUMBER_TEST: 3060
  PK_SAMPLER: True
  SEQ_LEN: 8
  TEST_SEQ_LEN: 0
DATASETS:
  COMBINEALL: False
  NAMES: ('Market1501',)
  TESTS: ('Market1501',)
INPUT:
  AUGMIX_PROB: 0.0
  AUTOAUG_PROB: 0.0
  CJ:
    BRIGHTNESS: 0.15
    CONTRAST: 0.15
    ENABLED: False
    HUE: 0.1
    PROB: 0.5
    SATURATION: 0.1
  DO_AUGMIX: False
  DO_AUTOAUG: False
  DO_FLIP: True
  DO_PAD: True
  DO_RANDAUG: False
  FLIP_PROB: 0.5
  MIX_TRACKLET: False
  PADDING: 10
  PADDING_MODE: constant
  RANDAUG_PROB: 0.5
  RANDAUG_STR: rand-m9-mstd0.5
  REA:
    ENABLED: True
    PROB: 0.5
    VALUE: [151.98, 142.29000000000002, 126.735]
  RPT:
    ENABLED: False
    PROB: 0.5
  SIZE_TEST: [256, 128]
  SIZE_TRAIN: [256, 128]
MODEL:
  BACKBONE:
    DEPTH: 50x
    FEAT_DIM: 2560
    LAST_STRIDE: 1
    NAME: build_resnet_backbone
    NORM: BN
    PRETRAIN: True
    PRETRAIN_PATH: 
    REMOVE: (3, 4)
    WITH_IBN: False
    WITH_NL: False
    WITH_SE: False
  DEVICE: cuda
  FREEZE_LAYERS: ['']
  HEADS:
    CLS_LAYER: linear
    EMBEDDING_DIM: 0
    HASH_LAYER_DIMS: []
    HASH_LAYER_NUM: 1
    MARGIN: 0.15
    NAME: EmbeddingHead
    NECK_FEAT: before
    NORM: BN
    NUM_CLASSES: 0
    POOL_LAYER: avgpool
    SCALE: 128
    TEMP: 1.0
    WITH_BNNECK: True
  LOSSES:
    CE:
      ALPHA: 0.2
      EPSILON: 0.1
      SCALE: 1.0
    CIRCLE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    COSFACE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    FL:
      ALPHA: 0.25
      GAMMA: 2
      SCALE: 1.0
    NAME: VerificationLoss
    TRI:
      HARD_MINING: True
      MARGIN: 0.3
      NORM_FEAT: False
      SCALE: 1.0
  META_ARCHITECTURE: BaselineVerifMemBank
  PIXEL_MEAN: [123.675, 116.28, 103.53]
  PIXEL_STD: [58.395, 57.120000000000005, 57.375]
  TRANSFORMER:
    DEPTH: 12
    EMBED_DIM: 768
    ENABLE_POS: False
    FEATURE_DIM: 2048
    INPUT_SIZE: (512, 64, 32)
    NAME: TransformerHead
    NUM_HEADS: 3
    PART_H: 4
    PART_STR: ('4x1',)
    PART_V: 1
    PATH_DROP: 0.1
    POS_DROP: 0.0
  TRANSFORMER_S:
    ATTN_DROP: 0.0
    CE_SCALE: 1.0
    DEPTH: 12
    EMBED_DIM: 768
    ENABLE_POS: False
    FEATURE_DIM: 2048
    GAP: False
    INPUT_SIZE: (512, 64, 32)
    LOCAL_PART: 4
    NAME: SpatialTransformerHead
    NUM_HEADS: 3
    PART_STR: 8x4
    PATH_DROP: 0.1
    POS_DROP: 0.0
    RET_ALL: False
  TRANSFORMER_T:
    ATTN_DROP: 0.0
    DEPTH: 12
    EMBED_DIM: 768
    ENABLE_POS: False
    GAP: False
    NAME: TemporalTransformerHead
    NUM_HEADS: 3
    PATH_DROP: 0.1
    POS_DROP: 0.0
    RET_ALL: False
    RET_ATTN: False
  WEIGHTS: 
OUTPUT_DIR: logs/BoT_verif_msmt17
SOLVER:
  BASE_LR: 0.00035
  BIAS_LR_FACTOR: 2.0
  CHECKPOINT_PERIOD: 30
  CLIP_GRADIENTS:
    CLIP_TYPE: norm
    CLIP_VALUE: 5.0
    ENABLED: False
    NORM_TYPE: 2.0
  DELAY_EPOCHS: 0
  ETA_MIN_LR: 1e-07
  FP16_ENABLED: True
  FREEZE_FC_ITERS: 0
  FREEZE_ITERS: 0
  GAMMA: 0.1
  HEADS_LR_FACTOR: 1.0
  IMS_PER_BATCH: 32
  MAX_EPOCH: 60
  MOMENTUM: 0.9
  OPT: Adam
  SCHED: MultiStepLR
  STEPS: [40, 90]
  TRANS_LR_FACTOR: 1.0
  WARMUP_FACTOR: 0.1
  WARMUP_ITERS: 2000
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0005
  WEIGHT_DECAY_BIAS: 0.0005
  WEIGHT_DECAY_NORM: 0.0005
  WEIGHT_DECAY_TRANS: 0.0005
TEST:
  AQE:
    ALPHA: 3.0
    ENABLED: False
    QE_K: 5
    QE_TIME: 1
  ERASE_NUM: 64
  EVAL_PERIOD: 5
  FLIP_ENABLED: False
  HASH_RATE: 0.3
  IMS_PER_BATCH: 128
  METRIC: cosine
  NEIGHBOR_RANGE: 100
  PRECISE_BN:
    DATASET: Market1501
    ENABLED: False
    NUM_ITER: 300
  RERANK:
    ENABLED: False
    K1: 20
    K2: 6
    LAMBDA: 0.3
  ROC_ENABLED: False
  SEQ_TEST: False
  TIMES: 1
  VERIF: False
[08/23 20:48:19] fastreid INFO: Full config saved to /home/huangju/codes/fast-reid/logs/BoT_verif_msmt17/config.yaml
[08/23 20:48:19] fastreid.utils.env INFO: Using a generated random seed 21372901
[08/23 20:48:20] fastreid INFO: Model:
BaselineVerifMemBank(
  (heads): EmbeddingHead(
    (pool_layer): AdaptiveAvgPool2d(output_size=1)
    (bottleneck): Sequential(
      (0): BatchNorm(2560, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (classifier): Linear(in_features=2560, out_features=0, bias=False)
  )
  (verif_model): VerifHead(
    (pool_layer): AdaptiveAvgPool2d(output_size=1)
    (bottleneck): Sequential(
      (0): Conv2d(2560, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
    )
    (classifier): Sequential(
      (0): Linear(in_features=1024, out_features=512, bias=True)
      (1): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): Dropout(p=0.2, inplace=False)
      (3): PReLU(num_parameters=1)
      (4): Linear(in_features=512, out_features=256, bias=True)
      (5): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (6): PReLU(num_parameters=1)
      (7): Linear(in_features=256, out_features=128, bias=True)
      (8): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (9): PReLU(num_parameters=1)
      (10): Linear(in_features=128, out_features=64, bias=True)
      (11): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (12): PReLU(num_parameters=1)
      (13): Linear(in_features=64, out_features=32, bias=True)
      (14): BatchNorm1d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (15): PReLU(num_parameters=1)
      (16): Linear(in_features=32, out_features=16, bias=True)
      (17): BatchNorm1d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (18): PReLU(num_parameters=1)
      (19): Linear(in_features=16, out_features=2, bias=False)
    )
    (drop): Dropout(p=0.5, inplace=False)
  )
)
[08/23 20:48:21] fastreid.utils.checkpoint INFO: No checkpoint found. Training model from scratch
[08/23 20:48:21] fastreid INFO: Start training from epoch 0
[08/23 20:50:29] fastreid INFO: Rank of current process: 0. World size: 1
[08/23 20:50:30] fastreid INFO: Environment info:
----------------------  ------------------------------------------------------------------------------------
sys.platform            linux
Python                  3.7.9 (default, Aug 31 2020, 12:42:55) [GCC 7.3.0]
numpy                   1.19.2
fastreid                1.3 @./fastreid
FASTREID_ENV_MODULE     <not set>
PyTorch                 1.6.0 @/home/huangju/anaconda3/envs/fastreid/lib/python3.7/site-packages/torch
PyTorch debug build     False
GPU available           True
GPU 0                   NVIDIA GeForce GTX 1080 Ti
CUDA_HOME               /usr/local/cuda
Pillow                  8.1.0
torchvision             0.7.0 @/home/huangju/anaconda3/envs/fastreid/lib/python3.7/site-packages/torchvision
torchvision arch flags  sm_35, sm_50, sm_60, sm_70, sm_75
cv2                     3.4.2
----------------------  ------------------------------------------------------------------------------------
PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) Math Kernel Library Version 2020.0.2 Product Build 20200624 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v1.5.0 (Git Hash e2ac1fac44c5078ca927cb9b90e1b3066a0b2ed0)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 10.2
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_37,code=compute_37
  - CuDNN 7.6.5
  - Magma 2.5.2
  - Build settings: BLAS=MKL, BUILD_TYPE=Release, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DUSE_VULKAN_WRAPPER -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, USE_CUDA=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_STATIC_DISPATCH=OFF, 

[08/23 20:50:30] fastreid INFO: Command line arguments: Namespace(config_file='./configs/BOT-verif-msmt17.yml', dist_url='tcp://127.0.0.1:50190', eval_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=[], resume=False)
[08/23 20:50:30] fastreid INFO: Contents of args.config_file=./configs/BOT-verif-msmt17.yml:
_BASE_: "./Base-bagtricks.yml"
MODEL:
  META_ARCHITECTURE: "BaselineVerifMemBank"

  BACKBONE:
    NAME: "build_resnet_backbone"
  LOSSES:
    NAME: ("VerificationLoss")

TEST:
  EVAL_PERIOD: 5

DATASETS:
  NAMES: ("Market1501",)
  TESTS: ("Market1501",)

DATALOADER:
  PK_SAMPLER: True
  NAIVE_WAY: True
  PERSON_NUMBER: 1041
  PERSON_NUMBER_TEST: 3060
OUTPUT_DIR: "logs/BoT_verif_msmt17"
[08/23 20:50:30] fastreid INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  NAIVE_WAY: True
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  PERSON_NUMBER: 1041
  PERSON_NUMBER_TEST: 3060
  PK_SAMPLER: True
  SEQ_LEN: 8
  TEST_SEQ_LEN: 0
DATASETS:
  COMBINEALL: False
  NAMES: ('Market1501',)
  TESTS: ('Market1501',)
INPUT:
  AUGMIX_PROB: 0.0
  AUTOAUG_PROB: 0.0
  CJ:
    BRIGHTNESS: 0.15
    CONTRAST: 0.15
    ENABLED: False
    HUE: 0.1
    PROB: 0.5
    SATURATION: 0.1
  DO_AUGMIX: False
  DO_AUTOAUG: False
  DO_FLIP: True
  DO_PAD: True
  DO_RANDAUG: False
  FLIP_PROB: 0.5
  MIX_TRACKLET: False
  PADDING: 10
  PADDING_MODE: constant
  RANDAUG_PROB: 0.5
  RANDAUG_STR: rand-m9-mstd0.5
  REA:
    ENABLED: True
    PROB: 0.5
    VALUE: [151.98, 142.29000000000002, 126.735]
  RPT:
    ENABLED: False
    PROB: 0.5
  SIZE_TEST: [256, 128]
  SIZE_TRAIN: [256, 128]
MODEL:
  BACKBONE:
    DEPTH: 50x
    FEAT_DIM: 2560
    LAST_STRIDE: 1
    NAME: build_resnet_backbone
    NORM: BN
    PRETRAIN: True
    PRETRAIN_PATH: 
    REMOVE: (3, 4)
    WITH_IBN: False
    WITH_NL: False
    WITH_SE: False
  DEVICE: cuda
  FREEZE_LAYERS: ['']
  HEADS:
    CLS_LAYER: linear
    EMBEDDING_DIM: 0
    HASH_LAYER_DIMS: []
    HASH_LAYER_NUM: 1
    MARGIN: 0.15
    NAME: EmbeddingHead
    NECK_FEAT: before
    NORM: BN
    NUM_CLASSES: 0
    POOL_LAYER: avgpool
    SCALE: 128
    TEMP: 1.0
    WITH_BNNECK: True
  LOSSES:
    CE:
      ALPHA: 0.2
      EPSILON: 0.1
      SCALE: 1.0
    CIRCLE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    COSFACE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    FL:
      ALPHA: 0.25
      GAMMA: 2
      SCALE: 1.0
    NAME: VerificationLoss
    TRI:
      HARD_MINING: True
      MARGIN: 0.3
      NORM_FEAT: False
      SCALE: 1.0
  META_ARCHITECTURE: BaselineVerifMemBank
  PIXEL_MEAN: [123.675, 116.28, 103.53]
  PIXEL_STD: [58.395, 57.120000000000005, 57.375]
  TRANSFORMER:
    DEPTH: 12
    EMBED_DIM: 768
    ENABLE_POS: False
    FEATURE_DIM: 2048
    INPUT_SIZE: (512, 64, 32)
    NAME: TransformerHead
    NUM_HEADS: 3
    PART_H: 4
    PART_STR: ('4x1',)
    PART_V: 1
    PATH_DROP: 0.1
    POS_DROP: 0.0
  TRANSFORMER_S:
    ATTN_DROP: 0.0
    CE_SCALE: 1.0
    DEPTH: 12
    EMBED_DIM: 768
    ENABLE_POS: False
    FEATURE_DIM: 2048
    GAP: False
    INPUT_SIZE: (512, 64, 32)
    LOCAL_PART: 4
    NAME: SpatialTransformerHead
    NUM_HEADS: 3
    PART_STR: 8x4
    PATH_DROP: 0.1
    POS_DROP: 0.0
    RET_ALL: False
  TRANSFORMER_T:
    ATTN_DROP: 0.0
    DEPTH: 12
    EMBED_DIM: 768
    ENABLE_POS: False
    GAP: False
    NAME: TemporalTransformerHead
    NUM_HEADS: 3
    PATH_DROP: 0.1
    POS_DROP: 0.0
    RET_ALL: False
    RET_ATTN: False
  WEIGHTS: 
OUTPUT_DIR: logs/BoT_verif_msmt17
SOLVER:
  BASE_LR: 0.00035
  BIAS_LR_FACTOR: 2.0
  CHECKPOINT_PERIOD: 30
  CLIP_GRADIENTS:
    CLIP_TYPE: norm
    CLIP_VALUE: 5.0
    ENABLED: False
    NORM_TYPE: 2.0
  DELAY_EPOCHS: 0
  ETA_MIN_LR: 1e-07
  FP16_ENABLED: True
  FREEZE_FC_ITERS: 0
  FREEZE_ITERS: 0
  GAMMA: 0.1
  HEADS_LR_FACTOR: 1.0
  IMS_PER_BATCH: 32
  MAX_EPOCH: 60
  MOMENTUM: 0.9
  OPT: Adam
  SCHED: MultiStepLR
  STEPS: [40, 90]
  TRANS_LR_FACTOR: 1.0
  WARMUP_FACTOR: 0.1
  WARMUP_ITERS: 2000
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0005
  WEIGHT_DECAY_BIAS: 0.0005
  WEIGHT_DECAY_NORM: 0.0005
  WEIGHT_DECAY_TRANS: 0.0005
TEST:
  AQE:
    ALPHA: 3.0
    ENABLED: False
    QE_K: 5
    QE_TIME: 1
  ERASE_NUM: 64
  EVAL_PERIOD: 5
  FLIP_ENABLED: False
  HASH_RATE: 0.3
  IMS_PER_BATCH: 128
  METRIC: cosine
  NEIGHBOR_RANGE: 100
  PRECISE_BN:
    DATASET: Market1501
    ENABLED: False
    NUM_ITER: 300
  RERANK:
    ENABLED: False
    K1: 20
    K2: 6
    LAMBDA: 0.3
  ROC_ENABLED: False
  SEQ_TEST: False
  TIMES: 1
  VERIF: False
[08/23 20:50:30] fastreid INFO: Full config saved to /home/huangju/codes/fast-reid/logs/BoT_verif_msmt17/config.yaml
[08/23 20:50:30] fastreid.utils.env INFO: Using a generated random seed 32822690
[08/23 20:50:32] fastreid INFO: Model:
BaselineVerifMemBank(
  (heads): EmbeddingHead(
    (pool_layer): AdaptiveAvgPool2d(output_size=1)
    (bottleneck): Sequential(
      (0): BatchNorm(2560, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (classifier): Linear(in_features=2560, out_features=0, bias=False)
  )
  (verif_model): VerifHead(
    (pool_layer): AdaptiveAvgPool2d(output_size=1)
    (bottleneck): Sequential(
      (0): Conv2d(2560, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
    )
    (classifier): Sequential(
      (0): Linear(in_features=1024, out_features=512, bias=True)
      (1): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): Dropout(p=0.2, inplace=False)
      (3): PReLU(num_parameters=1)
      (4): Linear(in_features=512, out_features=256, bias=True)
      (5): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (6): PReLU(num_parameters=1)
      (7): Linear(in_features=256, out_features=128, bias=True)
      (8): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (9): PReLU(num_parameters=1)
      (10): Linear(in_features=128, out_features=64, bias=True)
      (11): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (12): PReLU(num_parameters=1)
      (13): Linear(in_features=64, out_features=32, bias=True)
      (14): BatchNorm1d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (15): PReLU(num_parameters=1)
      (16): Linear(in_features=32, out_features=16, bias=True)
      (17): BatchNorm1d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (18): PReLU(num_parameters=1)
      (19): Linear(in_features=16, out_features=2, bias=False)
    )
    (drop): Dropout(p=0.5, inplace=False)
  )
)
[08/23 20:50:32] fastreid.utils.checkpoint INFO: No checkpoint found. Training model from scratch
[08/23 20:50:32] fastreid INFO: Start training from epoch 0
[08/23 21:00:57] fastreid INFO: Rank of current process: 0. World size: 1
[08/23 21:00:58] fastreid INFO: Environment info:
----------------------  ------------------------------------------------------------------------------------
sys.platform            linux
Python                  3.7.9 (default, Aug 31 2020, 12:42:55) [GCC 7.3.0]
numpy                   1.19.2
fastreid                1.3 @./fastreid
FASTREID_ENV_MODULE     <not set>
PyTorch                 1.6.0 @/home/huangju/anaconda3/envs/fastreid/lib/python3.7/site-packages/torch
PyTorch debug build     False
GPU available           True
GPU 0                   NVIDIA GeForce GTX 1080 Ti
CUDA_HOME               /usr/local/cuda
Pillow                  8.1.0
torchvision             0.7.0 @/home/huangju/anaconda3/envs/fastreid/lib/python3.7/site-packages/torchvision
torchvision arch flags  sm_35, sm_50, sm_60, sm_70, sm_75
cv2                     3.4.2
----------------------  ------------------------------------------------------------------------------------
PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) Math Kernel Library Version 2020.0.2 Product Build 20200624 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v1.5.0 (Git Hash e2ac1fac44c5078ca927cb9b90e1b3066a0b2ed0)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 10.2
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_37,code=compute_37
  - CuDNN 7.6.5
  - Magma 2.5.2
  - Build settings: BLAS=MKL, BUILD_TYPE=Release, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DUSE_VULKAN_WRAPPER -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, USE_CUDA=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_STATIC_DISPATCH=OFF, 

[08/23 21:00:58] fastreid INFO: Command line arguments: Namespace(config_file='./configs/BOT-verif-msmt17.yml', dist_url='tcp://127.0.0.1:50190', eval_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=[], resume=False)
[08/23 21:00:58] fastreid INFO: Contents of args.config_file=./configs/BOT-verif-msmt17.yml:
_BASE_: "./Base-bagtricks.yml"
MODEL:
  META_ARCHITECTURE: "BaselineVerifMemBank"

  BACKBONE:
    NAME: "build_resnet_backbone"
  LOSSES:
    NAME: ("VerificationLoss")

TEST:
  EVAL_PERIOD: 5

DATASETS:
  NAMES: ("Market1501",)
  TESTS: ("Market1501",)

DATALOADER:
  PK_SAMPLER: True
  NAIVE_WAY: True
  PERSON_NUMBER: 1041
  PERSON_NUMBER_TEST: 3060
OUTPUT_DIR: "logs/BoT_verif_msmt17"
[08/23 21:00:58] fastreid INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  NAIVE_WAY: True
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  PERSON_NUMBER: 1041
  PERSON_NUMBER_TEST: 3060
  PK_SAMPLER: True
  SEQ_LEN: 8
  TEST_SEQ_LEN: 0
DATASETS:
  COMBINEALL: False
  NAMES: ('Market1501',)
  TESTS: ('Market1501',)
INPUT:
  AUGMIX_PROB: 0.0
  AUTOAUG_PROB: 0.0
  CJ:
    BRIGHTNESS: 0.15
    CONTRAST: 0.15
    ENABLED: False
    HUE: 0.1
    PROB: 0.5
    SATURATION: 0.1
  DO_AUGMIX: False
  DO_AUTOAUG: False
  DO_FLIP: True
  DO_PAD: True
  DO_RANDAUG: False
  FLIP_PROB: 0.5
  MIX_TRACKLET: False
  PADDING: 10
  PADDING_MODE: constant
  RANDAUG_PROB: 0.5
  RANDAUG_STR: rand-m9-mstd0.5
  REA:
    ENABLED: True
    PROB: 0.5
    VALUE: [151.98, 142.29000000000002, 126.735]
  RPT:
    ENABLED: False
    PROB: 0.5
  SIZE_TEST: [256, 128]
  SIZE_TRAIN: [256, 128]
MODEL:
  BACKBONE:
    DEPTH: 50x
    FEAT_DIM: 2560
    LAST_STRIDE: 1
    NAME: build_resnet_backbone
    NORM: BN
    PRETRAIN: True
    PRETRAIN_PATH: 
    REMOVE: (3, 4)
    WITH_IBN: False
    WITH_NL: False
    WITH_SE: False
  DEVICE: cuda
  FREEZE_LAYERS: ['']
  HEADS:
    CLS_LAYER: linear
    EMBEDDING_DIM: 0
    HASH_LAYER_DIMS: []
    HASH_LAYER_NUM: 1
    MARGIN: 0.15
    NAME: EmbeddingHead
    NECK_FEAT: before
    NORM: BN
    NUM_CLASSES: 0
    POOL_LAYER: avgpool
    SCALE: 128
    TEMP: 1.0
    WITH_BNNECK: True
  LOSSES:
    CE:
      ALPHA: 0.2
      EPSILON: 0.1
      SCALE: 1.0
    CIRCLE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    COSFACE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    FL:
      ALPHA: 0.25
      GAMMA: 2
      SCALE: 1.0
    NAME: VerificationLoss
    TRI:
      HARD_MINING: True
      MARGIN: 0.3
      NORM_FEAT: False
      SCALE: 1.0
  META_ARCHITECTURE: BaselineVerifMemBank
  PIXEL_MEAN: [123.675, 116.28, 103.53]
  PIXEL_STD: [58.395, 57.120000000000005, 57.375]
  TRANSFORMER:
    DEPTH: 12
    EMBED_DIM: 768
    ENABLE_POS: False
    FEATURE_DIM: 2048
    INPUT_SIZE: (512, 64, 32)
    NAME: TransformerHead
    NUM_HEADS: 3
    PART_H: 4
    PART_STR: ('4x1',)
    PART_V: 1
    PATH_DROP: 0.1
    POS_DROP: 0.0
  TRANSFORMER_S:
    ATTN_DROP: 0.0
    CE_SCALE: 1.0
    DEPTH: 12
    EMBED_DIM: 768
    ENABLE_POS: False
    FEATURE_DIM: 2048
    GAP: False
    INPUT_SIZE: (512, 64, 32)
    LOCAL_PART: 4
    NAME: SpatialTransformerHead
    NUM_HEADS: 3
    PART_STR: 8x4
    PATH_DROP: 0.1
    POS_DROP: 0.0
    RET_ALL: False
  TRANSFORMER_T:
    ATTN_DROP: 0.0
    DEPTH: 12
    EMBED_DIM: 768
    ENABLE_POS: False
    GAP: False
    NAME: TemporalTransformerHead
    NUM_HEADS: 3
    PATH_DROP: 0.1
    POS_DROP: 0.0
    RET_ALL: False
    RET_ATTN: False
  WEIGHTS: 
OUTPUT_DIR: logs/BoT_verif_msmt17
SOLVER:
  BASE_LR: 0.00035
  BIAS_LR_FACTOR: 2.0
  CHECKPOINT_PERIOD: 30
  CLIP_GRADIENTS:
    CLIP_TYPE: norm
    CLIP_VALUE: 5.0
    ENABLED: False
    NORM_TYPE: 2.0
  DELAY_EPOCHS: 0
  ETA_MIN_LR: 1e-07
  FP16_ENABLED: True
  FREEZE_FC_ITERS: 0
  FREEZE_ITERS: 0
  GAMMA: 0.1
  HEADS_LR_FACTOR: 1.0
  IMS_PER_BATCH: 32
  MAX_EPOCH: 60
  MOMENTUM: 0.9
  OPT: Adam
  SCHED: MultiStepLR
  STEPS: [40, 90]
  TRANS_LR_FACTOR: 1.0
  WARMUP_FACTOR: 0.1
  WARMUP_ITERS: 2000
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0005
  WEIGHT_DECAY_BIAS: 0.0005
  WEIGHT_DECAY_NORM: 0.0005
  WEIGHT_DECAY_TRANS: 0.0005
TEST:
  AQE:
    ALPHA: 3.0
    ENABLED: False
    QE_K: 5
    QE_TIME: 1
  ERASE_NUM: 64
  EVAL_PERIOD: 5
  FLIP_ENABLED: False
  HASH_RATE: 0.3
  IMS_PER_BATCH: 128
  METRIC: cosine
  NEIGHBOR_RANGE: 100
  PRECISE_BN:
    DATASET: Market1501
    ENABLED: False
    NUM_ITER: 300
  RERANK:
    ENABLED: False
    K1: 20
    K2: 6
    LAMBDA: 0.3
  ROC_ENABLED: False
  SEQ_TEST: False
  TIMES: 1
  VERIF: False
[08/23 21:00:58] fastreid INFO: Full config saved to /home/huangju/codes/fast-reid/logs/BoT_verif_msmt17/config.yaml
[08/23 21:00:58] fastreid.utils.env INFO: Using a generated random seed 60534001
[08/23 21:01:00] fastreid INFO: Model:
BaselineVerifMemBank(
  (heads): EmbeddingHead(
    (pool_layer): AdaptiveAvgPool2d(output_size=1)
    (bottleneck): Sequential(
      (0): BatchNorm(2560, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (classifier): Linear(in_features=2560, out_features=0, bias=False)
  )
  (verif_model): VerifHead(
    (pool_layer): AdaptiveAvgPool2d(output_size=1)
    (bottleneck): Sequential(
      (0): Conv2d(2560, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
    )
    (classifier): Sequential(
      (0): Linear(in_features=1024, out_features=512, bias=True)
      (1): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): Dropout(p=0.2, inplace=False)
      (3): PReLU(num_parameters=1)
      (4): Linear(in_features=512, out_features=256, bias=True)
      (5): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (6): PReLU(num_parameters=1)
      (7): Linear(in_features=256, out_features=128, bias=True)
      (8): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (9): PReLU(num_parameters=1)
      (10): Linear(in_features=128, out_features=64, bias=True)
      (11): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (12): PReLU(num_parameters=1)
      (13): Linear(in_features=64, out_features=32, bias=True)
      (14): BatchNorm1d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (15): PReLU(num_parameters=1)
      (16): Linear(in_features=32, out_features=16, bias=True)
      (17): BatchNorm1d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (18): PReLU(num_parameters=1)
      (19): Linear(in_features=16, out_features=2, bias=False)
    )
    (drop): Dropout(p=0.5, inplace=False)
  )
)
[08/23 21:01:00] fastreid.utils.checkpoint INFO: No checkpoint found. Training model from scratch
[08/23 21:01:00] fastreid INFO: Start training from epoch 0
[08/23 21:06:40] fastreid INFO: Rank of current process: 0. World size: 1
[08/23 21:06:41] fastreid INFO: Environment info:
----------------------  ------------------------------------------------------------------------------------
sys.platform            linux
Python                  3.7.9 (default, Aug 31 2020, 12:42:55) [GCC 7.3.0]
numpy                   1.19.2
fastreid                1.3 @./fastreid
FASTREID_ENV_MODULE     <not set>
PyTorch                 1.6.0 @/home/huangju/anaconda3/envs/fastreid/lib/python3.7/site-packages/torch
PyTorch debug build     False
GPU available           True
GPU 0                   NVIDIA GeForce GTX 1080 Ti
CUDA_HOME               /usr/local/cuda
Pillow                  8.1.0
torchvision             0.7.0 @/home/huangju/anaconda3/envs/fastreid/lib/python3.7/site-packages/torchvision
torchvision arch flags  sm_35, sm_50, sm_60, sm_70, sm_75
cv2                     3.4.2
----------------------  ------------------------------------------------------------------------------------
PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) Math Kernel Library Version 2020.0.2 Product Build 20200624 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v1.5.0 (Git Hash e2ac1fac44c5078ca927cb9b90e1b3066a0b2ed0)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 10.2
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_37,code=compute_37
  - CuDNN 7.6.5
  - Magma 2.5.2
  - Build settings: BLAS=MKL, BUILD_TYPE=Release, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DUSE_VULKAN_WRAPPER -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, USE_CUDA=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_STATIC_DISPATCH=OFF, 

[08/23 21:06:41] fastreid INFO: Command line arguments: Namespace(config_file='./configs/BOT-verif-msmt17.yml', dist_url='tcp://127.0.0.1:50190', eval_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=[], resume=False)
[08/23 21:06:41] fastreid INFO: Contents of args.config_file=./configs/BOT-verif-msmt17.yml:
_BASE_: "./Base-bagtricks.yml"
MODEL:
  META_ARCHITECTURE: "BaselineVerifMemBank"

  BACKBONE:
    NAME: "build_resnet_backbone"
  LOSSES:
    NAME: ("VerificationLoss")

TEST:
  EVAL_PERIOD: 5

DATASETS:
  NAMES: ("Market1501",)
  TESTS: ("Market1501",)

DATALOADER:
  PK_SAMPLER: True
  NAIVE_WAY: True
  PERSON_NUMBER: 1041
  PERSON_NUMBER_TEST: 3060
OUTPUT_DIR: "logs/BoT_verif_msmt17"
[08/23 21:06:41] fastreid INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  NAIVE_WAY: True
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  PERSON_NUMBER: 1041
  PERSON_NUMBER_TEST: 3060
  PK_SAMPLER: True
  SEQ_LEN: 8
  TEST_SEQ_LEN: 0
DATASETS:
  COMBINEALL: False
  NAMES: ('Market1501',)
  TESTS: ('Market1501',)
INPUT:
  AUGMIX_PROB: 0.0
  AUTOAUG_PROB: 0.0
  CJ:
    BRIGHTNESS: 0.15
    CONTRAST: 0.15
    ENABLED: False
    HUE: 0.1
    PROB: 0.5
    SATURATION: 0.1
  DO_AUGMIX: False
  DO_AUTOAUG: False
  DO_FLIP: True
  DO_PAD: True
  DO_RANDAUG: False
  FLIP_PROB: 0.5
  MIX_TRACKLET: False
  PADDING: 10
  PADDING_MODE: constant
  RANDAUG_PROB: 0.5
  RANDAUG_STR: rand-m9-mstd0.5
  REA:
    ENABLED: True
    PROB: 0.5
    VALUE: [151.98, 142.29000000000002, 126.735]
  RPT:
    ENABLED: False
    PROB: 0.5
  SIZE_TEST: [256, 128]
  SIZE_TRAIN: [256, 128]
MODEL:
  BACKBONE:
    DEPTH: 50x
    FEAT_DIM: 2560
    LAST_STRIDE: 1
    NAME: build_resnet_backbone
    NORM: BN
    PRETRAIN: True
    PRETRAIN_PATH: 
    REMOVE: (3, 4)
    WITH_IBN: False
    WITH_NL: False
    WITH_SE: False
  DEVICE: cuda
  FREEZE_LAYERS: ['']
  HEADS:
    CLS_LAYER: linear
    EMBEDDING_DIM: 0
    HASH_LAYER_DIMS: []
    HASH_LAYER_NUM: 1
    MARGIN: 0.15
    NAME: EmbeddingHead
    NECK_FEAT: before
    NORM: BN
    NUM_CLASSES: 0
    POOL_LAYER: avgpool
    SCALE: 128
    TEMP: 1.0
    WITH_BNNECK: True
  LOSSES:
    CE:
      ALPHA: 0.2
      EPSILON: 0.1
      SCALE: 1.0
    CIRCLE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    COSFACE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    FL:
      ALPHA: 0.25
      GAMMA: 2
      SCALE: 1.0
    NAME: VerificationLoss
    TRI:
      HARD_MINING: True
      MARGIN: 0.3
      NORM_FEAT: False
      SCALE: 1.0
  META_ARCHITECTURE: BaselineVerifMemBank
  PIXEL_MEAN: [123.675, 116.28, 103.53]
  PIXEL_STD: [58.395, 57.120000000000005, 57.375]
  TRANSFORMER:
    DEPTH: 12
    EMBED_DIM: 768
    ENABLE_POS: False
    FEATURE_DIM: 2048
    INPUT_SIZE: (512, 64, 32)
    NAME: TransformerHead
    NUM_HEADS: 3
    PART_H: 4
    PART_STR: ('4x1',)
    PART_V: 1
    PATH_DROP: 0.1
    POS_DROP: 0.0
  TRANSFORMER_S:
    ATTN_DROP: 0.0
    CE_SCALE: 1.0
    DEPTH: 12
    EMBED_DIM: 768
    ENABLE_POS: False
    FEATURE_DIM: 2048
    GAP: False
    INPUT_SIZE: (512, 64, 32)
    LOCAL_PART: 4
    NAME: SpatialTransformerHead
    NUM_HEADS: 3
    PART_STR: 8x4
    PATH_DROP: 0.1
    POS_DROP: 0.0
    RET_ALL: False
  TRANSFORMER_T:
    ATTN_DROP: 0.0
    DEPTH: 12
    EMBED_DIM: 768
    ENABLE_POS: False
    GAP: False
    NAME: TemporalTransformerHead
    NUM_HEADS: 3
    PATH_DROP: 0.1
    POS_DROP: 0.0
    RET_ALL: False
    RET_ATTN: False
  WEIGHTS: 
OUTPUT_DIR: logs/BoT_verif_msmt17
SOLVER:
  BASE_LR: 0.00035
  BIAS_LR_FACTOR: 2.0
  CHECKPOINT_PERIOD: 30
  CLIP_GRADIENTS:
    CLIP_TYPE: norm
    CLIP_VALUE: 5.0
    ENABLED: False
    NORM_TYPE: 2.0
  DELAY_EPOCHS: 0
  ETA_MIN_LR: 1e-07
  FP16_ENABLED: True
  FREEZE_FC_ITERS: 0
  FREEZE_ITERS: 0
  GAMMA: 0.1
  HEADS_LR_FACTOR: 1.0
  IMS_PER_BATCH: 32
  MAX_EPOCH: 60
  MOMENTUM: 0.9
  OPT: Adam
  SCHED: MultiStepLR
  STEPS: [40, 90]
  TRANS_LR_FACTOR: 1.0
  WARMUP_FACTOR: 0.1
  WARMUP_ITERS: 2000
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0005
  WEIGHT_DECAY_BIAS: 0.0005
  WEIGHT_DECAY_NORM: 0.0005
  WEIGHT_DECAY_TRANS: 0.0005
TEST:
  AQE:
    ALPHA: 3.0
    ENABLED: False
    QE_K: 5
    QE_TIME: 1
  ERASE_NUM: 64
  EVAL_PERIOD: 5
  FLIP_ENABLED: False
  HASH_RATE: 0.3
  IMS_PER_BATCH: 128
  METRIC: cosine
  NEIGHBOR_RANGE: 100
  PRECISE_BN:
    DATASET: Market1501
    ENABLED: False
    NUM_ITER: 300
  RERANK:
    ENABLED: False
    K1: 20
    K2: 6
    LAMBDA: 0.3
  ROC_ENABLED: False
  SEQ_TEST: False
  TIMES: 1
  VERIF: False
[08/23 21:06:41] fastreid INFO: Full config saved to /home/huangju/codes/fast-reid/logs/BoT_verif_msmt17/config.yaml
[08/23 21:06:41] fastreid.utils.env INFO: Using a generated random seed 43453126
[08/23 21:06:42] fastreid INFO: Model:
BaselineVerifMemBank(
  (heads): EmbeddingHead(
    (pool_layer): AdaptiveAvgPool2d(output_size=1)
    (bottleneck): Sequential(
      (0): BatchNorm(2560, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (classifier): Linear(in_features=2560, out_features=0, bias=False)
  )
  (verif_model): VerifHead(
    (pool_layer): AdaptiveAvgPool2d(output_size=1)
    (bottleneck): Sequential(
      (0): Conv2d(2560, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
    )
    (classifier): Sequential(
      (0): Linear(in_features=1024, out_features=512, bias=True)
      (1): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): Dropout(p=0.2, inplace=False)
      (3): PReLU(num_parameters=1)
      (4): Linear(in_features=512, out_features=256, bias=True)
      (5): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (6): PReLU(num_parameters=1)
      (7): Linear(in_features=256, out_features=128, bias=True)
      (8): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (9): PReLU(num_parameters=1)
      (10): Linear(in_features=128, out_features=64, bias=True)
      (11): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (12): PReLU(num_parameters=1)
      (13): Linear(in_features=64, out_features=32, bias=True)
      (14): BatchNorm1d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (15): PReLU(num_parameters=1)
      (16): Linear(in_features=32, out_features=16, bias=True)
      (17): BatchNorm1d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (18): PReLU(num_parameters=1)
      (19): Linear(in_features=16, out_features=2, bias=False)
    )
    (drop): Dropout(p=0.5, inplace=False)
  )
)
[08/23 21:06:43] fastreid.utils.checkpoint INFO: No checkpoint found. Training model from scratch
[08/23 21:06:43] fastreid INFO: Start training from epoch 0
[08/23 21:06:45] fastreid INFO: training accuracy_positive is tensor([0.3438], device='cuda:0')
[08/23 21:08:02] fastreid INFO: Rank of current process: 0. World size: 1
[08/23 21:08:03] fastreid INFO: Environment info:
----------------------  ------------------------------------------------------------------------------------
sys.platform            linux
Python                  3.7.9 (default, Aug 31 2020, 12:42:55) [GCC 7.3.0]
numpy                   1.19.2
fastreid                1.3 @./fastreid
FASTREID_ENV_MODULE     <not set>
PyTorch                 1.6.0 @/home/huangju/anaconda3/envs/fastreid/lib/python3.7/site-packages/torch
PyTorch debug build     False
GPU available           True
GPU 0                   NVIDIA GeForce GTX 1080 Ti
CUDA_HOME               /usr/local/cuda
Pillow                  8.1.0
torchvision             0.7.0 @/home/huangju/anaconda3/envs/fastreid/lib/python3.7/site-packages/torchvision
torchvision arch flags  sm_35, sm_50, sm_60, sm_70, sm_75
cv2                     3.4.2
----------------------  ------------------------------------------------------------------------------------
PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) Math Kernel Library Version 2020.0.2 Product Build 20200624 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v1.5.0 (Git Hash e2ac1fac44c5078ca927cb9b90e1b3066a0b2ed0)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 10.2
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_37,code=compute_37
  - CuDNN 7.6.5
  - Magma 2.5.2
  - Build settings: BLAS=MKL, BUILD_TYPE=Release, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DUSE_VULKAN_WRAPPER -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, USE_CUDA=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_STATIC_DISPATCH=OFF, 

[08/23 21:08:03] fastreid INFO: Command line arguments: Namespace(config_file='./configs/BOT-verif-msmt17.yml', dist_url='tcp://127.0.0.1:50190', eval_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=[], resume=False)
[08/23 21:08:03] fastreid INFO: Contents of args.config_file=./configs/BOT-verif-msmt17.yml:
_BASE_: "./Base-bagtricks.yml"
MODEL:
  META_ARCHITECTURE: "BaselineVerifMemBank"

  BACKBONE:
    NAME: "build_resnet_backbone"
  LOSSES:
    NAME: ("VerificationLoss")

TEST:
  EVAL_PERIOD: 5

DATASETS:
  NAMES: ("Market1501",)
  TESTS: ("Market1501",)

DATALOADER:
  PK_SAMPLER: True
  NAIVE_WAY: True
  PERSON_NUMBER: 1041
  PERSON_NUMBER_TEST: 3060
OUTPUT_DIR: "logs/BoT_verif_msmt17"
[08/23 21:08:03] fastreid INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  NAIVE_WAY: True
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  PERSON_NUMBER: 1041
  PERSON_NUMBER_TEST: 3060
  PK_SAMPLER: True
  SEQ_LEN: 8
  TEST_SEQ_LEN: 0
DATASETS:
  COMBINEALL: False
  NAMES: ('Market1501',)
  TESTS: ('Market1501',)
INPUT:
  AUGMIX_PROB: 0.0
  AUTOAUG_PROB: 0.0
  CJ:
    BRIGHTNESS: 0.15
    CONTRAST: 0.15
    ENABLED: False
    HUE: 0.1
    PROB: 0.5
    SATURATION: 0.1
  DO_AUGMIX: False
  DO_AUTOAUG: False
  DO_FLIP: True
  DO_PAD: True
  DO_RANDAUG: False
  FLIP_PROB: 0.5
  MIX_TRACKLET: False
  PADDING: 10
  PADDING_MODE: constant
  RANDAUG_PROB: 0.5
  RANDAUG_STR: rand-m9-mstd0.5
  REA:
    ENABLED: True
    PROB: 0.5
    VALUE: [151.98, 142.29000000000002, 126.735]
  RPT:
    ENABLED: False
    PROB: 0.5
  SIZE_TEST: [256, 128]
  SIZE_TRAIN: [256, 128]
MODEL:
  BACKBONE:
    DEPTH: 50x
    FEAT_DIM: 2560
    LAST_STRIDE: 1
    NAME: build_resnet_backbone
    NORM: BN
    PRETRAIN: True
    PRETRAIN_PATH: 
    REMOVE: (3, 4)
    WITH_IBN: False
    WITH_NL: False
    WITH_SE: False
  DEVICE: cuda
  FREEZE_LAYERS: ['']
  HEADS:
    CLS_LAYER: linear
    EMBEDDING_DIM: 0
    HASH_LAYER_DIMS: []
    HASH_LAYER_NUM: 1
    MARGIN: 0.15
    NAME: EmbeddingHead
    NECK_FEAT: before
    NORM: BN
    NUM_CLASSES: 0
    POOL_LAYER: avgpool
    SCALE: 128
    TEMP: 1.0
    WITH_BNNECK: True
  LOSSES:
    CE:
      ALPHA: 0.2
      EPSILON: 0.1
      SCALE: 1.0
    CIRCLE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    COSFACE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    FL:
      ALPHA: 0.25
      GAMMA: 2
      SCALE: 1.0
    NAME: VerificationLoss
    TRI:
      HARD_MINING: True
      MARGIN: 0.3
      NORM_FEAT: False
      SCALE: 1.0
  META_ARCHITECTURE: BaselineVerifMemBank
  PIXEL_MEAN: [123.675, 116.28, 103.53]
  PIXEL_STD: [58.395, 57.120000000000005, 57.375]
  TRANSFORMER:
    DEPTH: 12
    EMBED_DIM: 768
    ENABLE_POS: False
    FEATURE_DIM: 2048
    INPUT_SIZE: (512, 64, 32)
    NAME: TransformerHead
    NUM_HEADS: 3
    PART_H: 4
    PART_STR: ('4x1',)
    PART_V: 1
    PATH_DROP: 0.1
    POS_DROP: 0.0
  TRANSFORMER_S:
    ATTN_DROP: 0.0
    CE_SCALE: 1.0
    DEPTH: 12
    EMBED_DIM: 768
    ENABLE_POS: False
    FEATURE_DIM: 2048
    GAP: False
    INPUT_SIZE: (512, 64, 32)
    LOCAL_PART: 4
    NAME: SpatialTransformerHead
    NUM_HEADS: 3
    PART_STR: 8x4
    PATH_DROP: 0.1
    POS_DROP: 0.0
    RET_ALL: False
  TRANSFORMER_T:
    ATTN_DROP: 0.0
    DEPTH: 12
    EMBED_DIM: 768
    ENABLE_POS: False
    GAP: False
    NAME: TemporalTransformerHead
    NUM_HEADS: 3
    PATH_DROP: 0.1
    POS_DROP: 0.0
    RET_ALL: False
    RET_ATTN: False
  WEIGHTS: 
OUTPUT_DIR: logs/BoT_verif_msmt17
SOLVER:
  BASE_LR: 0.00035
  BIAS_LR_FACTOR: 2.0
  CHECKPOINT_PERIOD: 30
  CLIP_GRADIENTS:
    CLIP_TYPE: norm
    CLIP_VALUE: 5.0
    ENABLED: False
    NORM_TYPE: 2.0
  DELAY_EPOCHS: 0
  ETA_MIN_LR: 1e-07
  FP16_ENABLED: True
  FREEZE_FC_ITERS: 0
  FREEZE_ITERS: 0
  GAMMA: 0.1
  HEADS_LR_FACTOR: 1.0
  IMS_PER_BATCH: 32
  MAX_EPOCH: 60
  MOMENTUM: 0.9
  OPT: Adam
  SCHED: MultiStepLR
  STEPS: [40, 90]
  TRANS_LR_FACTOR: 1.0
  WARMUP_FACTOR: 0.1
  WARMUP_ITERS: 2000
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0005
  WEIGHT_DECAY_BIAS: 0.0005
  WEIGHT_DECAY_NORM: 0.0005
  WEIGHT_DECAY_TRANS: 0.0005
TEST:
  AQE:
    ALPHA: 3.0
    ENABLED: False
    QE_K: 5
    QE_TIME: 1
  ERASE_NUM: 64
  EVAL_PERIOD: 5
  FLIP_ENABLED: False
  HASH_RATE: 0.3
  IMS_PER_BATCH: 128
  METRIC: cosine
  NEIGHBOR_RANGE: 100
  PRECISE_BN:
    DATASET: Market1501
    ENABLED: False
    NUM_ITER: 300
  RERANK:
    ENABLED: False
    K1: 20
    K2: 6
    LAMBDA: 0.3
  ROC_ENABLED: False
  SEQ_TEST: False
  TIMES: 1
  VERIF: False
[08/23 21:08:03] fastreid INFO: Full config saved to /home/huangju/codes/fast-reid/logs/BoT_verif_msmt17/config.yaml
[08/23 21:08:03] fastreid.utils.env INFO: Using a generated random seed 5854963
[08/23 21:08:05] fastreid INFO: Model:
BaselineVerifMemBank(
  (heads): EmbeddingHead(
    (pool_layer): AdaptiveAvgPool2d(output_size=1)
    (bottleneck): Sequential(
      (0): BatchNorm(2560, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (classifier): Linear(in_features=2560, out_features=0, bias=False)
  )
  (verif_model): VerifHead(
    (pool_layer): AdaptiveAvgPool2d(output_size=1)
    (bottleneck): Sequential(
      (0): Conv2d(2560, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
    )
    (classifier): Sequential(
      (0): Linear(in_features=1024, out_features=512, bias=True)
      (1): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): Dropout(p=0.2, inplace=False)
      (3): PReLU(num_parameters=1)
      (4): Linear(in_features=512, out_features=256, bias=True)
      (5): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (6): PReLU(num_parameters=1)
      (7): Linear(in_features=256, out_features=128, bias=True)
      (8): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (9): PReLU(num_parameters=1)
      (10): Linear(in_features=128, out_features=64, bias=True)
      (11): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (12): PReLU(num_parameters=1)
      (13): Linear(in_features=64, out_features=32, bias=True)
      (14): BatchNorm1d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (15): PReLU(num_parameters=1)
      (16): Linear(in_features=32, out_features=16, bias=True)
      (17): BatchNorm1d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (18): PReLU(num_parameters=1)
      (19): Linear(in_features=16, out_features=2, bias=False)
    )
    (drop): Dropout(p=0.5, inplace=False)
  )
)
[08/23 21:08:05] fastreid.utils.checkpoint INFO: No checkpoint found. Training model from scratch
[08/23 21:08:05] fastreid INFO: Start training from epoch 0
[08/23 21:08:08] fastreid INFO: training accuracy_positive is tensor([0.4062], device='cuda:0')
[08/23 21:08:18] fastreid INFO: training accuracy_positive is tensor([0.7812], device='cuda:0')
[08/23 21:08:20] fastreid INFO: training accuracy_positive is tensor([0.1562], device='cuda:0')
[08/23 21:08:22] fastreid INFO: training accuracy_positive is tensor([0.0938], device='cuda:0')
[08/23 21:08:24] fastreid INFO: training accuracy_positive is tensor([0.], device='cuda:0')
[08/23 21:08:26] fastreid INFO: training accuracy_positive is tensor([0.], device='cuda:0')
[08/23 21:08:28] fastreid INFO: training accuracy_positive is tensor([0.], device='cuda:0')
[08/23 21:08:30] fastreid INFO: training accuracy_positive is tensor([0.], device='cuda:0')
[08/23 21:08:31] fastreid INFO: training accuracy_positive is tensor([0.], device='cuda:0')
[08/23 21:08:33] fastreid INFO: training accuracy_positive is tensor([0.], device='cuda:0')
[08/23 21:08:35] fastreid INFO: training accuracy_positive is tensor([0.], device='cuda:0')
[08/23 21:08:37] fastreid INFO: training accuracy_positive is tensor([0.], device='cuda:0')
[08/23 21:08:39] fastreid INFO: training accuracy_positive is tensor([0.], device='cuda:0')
[08/23 21:08:41] fastreid INFO: training accuracy_positive is tensor([0.], device='cuda:0')
[08/23 21:08:43] fastreid INFO: training accuracy_positive is tensor([0.], device='cuda:0')
[08/23 21:08:45] fastreid INFO: training accuracy_positive is tensor([0.], device='cuda:0')
[08/23 21:08:46] fastreid INFO: training accuracy_positive is tensor([0.], device='cuda:0')
[08/23 21:08:48] fastreid INFO: training accuracy_positive is tensor([0.], device='cuda:0')
[08/23 21:08:50] fastreid INFO: training accuracy_positive is tensor([0.], device='cuda:0')
[08/23 21:08:52] fastreid INFO: training accuracy_positive is tensor([0.], device='cuda:0')
[08/23 21:08:54] fastreid INFO: training accuracy_positive is tensor([0.], device='cuda:0')
[08/23 21:08:56] fastreid INFO: training accuracy_positive is tensor([0.], device='cuda:0')
[08/23 21:08:58] fastreid INFO: training accuracy_positive is tensor([0.], device='cuda:0')
[08/23 21:09:00] fastreid INFO: training accuracy_positive is tensor([0.], device='cuda:0')
[08/23 21:09:01] fastreid INFO: training accuracy_positive is tensor([0.], device='cuda:0')
[08/23 21:09:03] fastreid INFO: training accuracy_positive is tensor([0.], device='cuda:0')
[08/23 21:09:05] fastreid INFO: training accuracy_positive is tensor([0.], device='cuda:0')
[08/23 21:09:07] fastreid INFO: training accuracy_positive is tensor([0.], device='cuda:0')
[08/23 21:09:09] fastreid INFO: training accuracy_positive is tensor([0.], device='cuda:0')
[08/23 21:16:16] fastreid INFO: Rank of current process: 0. World size: 1
[08/23 21:16:17] fastreid INFO: Environment info:
----------------------  ------------------------------------------------------------------------------------
sys.platform            linux
Python                  3.7.9 (default, Aug 31 2020, 12:42:55) [GCC 7.3.0]
numpy                   1.19.2
fastreid                1.3 @./fastreid
FASTREID_ENV_MODULE     <not set>
PyTorch                 1.6.0 @/home/huangju/anaconda3/envs/fastreid/lib/python3.7/site-packages/torch
PyTorch debug build     False
GPU available           True
GPU 0                   NVIDIA GeForce GTX 1080 Ti
CUDA_HOME               /usr/local/cuda
Pillow                  8.1.0
torchvision             0.7.0 @/home/huangju/anaconda3/envs/fastreid/lib/python3.7/site-packages/torchvision
torchvision arch flags  sm_35, sm_50, sm_60, sm_70, sm_75
cv2                     3.4.2
----------------------  ------------------------------------------------------------------------------------
PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) Math Kernel Library Version 2020.0.2 Product Build 20200624 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v1.5.0 (Git Hash e2ac1fac44c5078ca927cb9b90e1b3066a0b2ed0)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 10.2
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_37,code=compute_37
  - CuDNN 7.6.5
  - Magma 2.5.2
  - Build settings: BLAS=MKL, BUILD_TYPE=Release, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DUSE_VULKAN_WRAPPER -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, USE_CUDA=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_STATIC_DISPATCH=OFF, 

[08/23 21:16:17] fastreid INFO: Command line arguments: Namespace(config_file='./configs/BOT-verif-msmt17.yml', dist_url='tcp://127.0.0.1:50190', eval_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=[], resume=False)
[08/23 21:16:17] fastreid INFO: Contents of args.config_file=./configs/BOT-verif-msmt17.yml:
_BASE_: "./Base-bagtricks.yml"
MODEL:
  META_ARCHITECTURE: "BaselineVerifMemBank"

  BACKBONE:
    NAME: "build_resnet_backbone"
  LOSSES:
    NAME: ("VerificationLoss")

TEST:
  EVAL_PERIOD: 5

DATASETS:
  NAMES: ("Market1501",)
  TESTS: ("Market1501",)

DATALOADER:
  PK_SAMPLER: True
  NAIVE_WAY: True
  PERSON_NUMBER: 1041
  PERSON_NUMBER_TEST: 3060
OUTPUT_DIR: "logs/BoT_verif_msmt17"
[08/23 21:16:17] fastreid INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  NAIVE_WAY: True
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  PERSON_NUMBER: 1041
  PERSON_NUMBER_TEST: 3060
  PK_SAMPLER: True
  SEQ_LEN: 8
  TEST_SEQ_LEN: 0
DATASETS:
  COMBINEALL: False
  NAMES: ('Market1501',)
  TESTS: ('Market1501',)
INPUT:
  AUGMIX_PROB: 0.0
  AUTOAUG_PROB: 0.0
  CJ:
    BRIGHTNESS: 0.15
    CONTRAST: 0.15
    ENABLED: False
    HUE: 0.1
    PROB: 0.5
    SATURATION: 0.1
  DO_AUGMIX: False
  DO_AUTOAUG: False
  DO_FLIP: True
  DO_PAD: True
  DO_RANDAUG: False
  FLIP_PROB: 0.5
  MIX_TRACKLET: False
  PADDING: 10
  PADDING_MODE: constant
  RANDAUG_PROB: 0.5
  RANDAUG_STR: rand-m9-mstd0.5
  REA:
    ENABLED: True
    PROB: 0.5
    VALUE: [151.98, 142.29000000000002, 126.735]
  RPT:
    ENABLED: False
    PROB: 0.5
  SIZE_TEST: [256, 128]
  SIZE_TRAIN: [256, 128]
MODEL:
  BACKBONE:
    DEPTH: 50x
    FEAT_DIM: 2560
    LAST_STRIDE: 1
    NAME: build_resnet_backbone
    NORM: BN
    PRETRAIN: True
    PRETRAIN_PATH: 
    REMOVE: (3, 4)
    WITH_IBN: False
    WITH_NL: False
    WITH_SE: False
  DEVICE: cuda
  FREEZE_LAYERS: ['']
  HEADS:
    CLS_LAYER: linear
    EMBEDDING_DIM: 0
    HASH_LAYER_DIMS: []
    HASH_LAYER_NUM: 1
    MARGIN: 0.15
    NAME: EmbeddingHead
    NECK_FEAT: before
    NORM: BN
    NUM_CLASSES: 0
    POOL_LAYER: avgpool
    SCALE: 128
    TEMP: 1.0
    WITH_BNNECK: True
  LOSSES:
    CE:
      ALPHA: 0.2
      EPSILON: 0.1
      SCALE: 1.0
    CIRCLE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    COSFACE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    FL:
      ALPHA: 0.25
      GAMMA: 2
      SCALE: 1.0
    NAME: VerificationLoss
    TRI:
      HARD_MINING: True
      MARGIN: 0.3
      NORM_FEAT: False
      SCALE: 1.0
  META_ARCHITECTURE: BaselineVerifMemBank
  PIXEL_MEAN: [123.675, 116.28, 103.53]
  PIXEL_STD: [58.395, 57.120000000000005, 57.375]
  TRANSFORMER:
    DEPTH: 12
    EMBED_DIM: 768
    ENABLE_POS: False
    FEATURE_DIM: 2048
    INPUT_SIZE: (512, 64, 32)
    NAME: TransformerHead
    NUM_HEADS: 3
    PART_H: 4
    PART_STR: ('4x1',)
    PART_V: 1
    PATH_DROP: 0.1
    POS_DROP: 0.0
  TRANSFORMER_S:
    ATTN_DROP: 0.0
    CE_SCALE: 1.0
    DEPTH: 12
    EMBED_DIM: 768
    ENABLE_POS: False
    FEATURE_DIM: 2048
    GAP: False
    INPUT_SIZE: (512, 64, 32)
    LOCAL_PART: 4
    NAME: SpatialTransformerHead
    NUM_HEADS: 3
    PART_STR: 8x4
    PATH_DROP: 0.1
    POS_DROP: 0.0
    RET_ALL: False
  TRANSFORMER_T:
    ATTN_DROP: 0.0
    DEPTH: 12
    EMBED_DIM: 768
    ENABLE_POS: False
    GAP: False
    NAME: TemporalTransformerHead
    NUM_HEADS: 3
    PATH_DROP: 0.1
    POS_DROP: 0.0
    RET_ALL: False
    RET_ATTN: False
  WEIGHTS: 
OUTPUT_DIR: logs/BoT_verif_msmt17
SOLVER:
  BASE_LR: 0.00035
  BIAS_LR_FACTOR: 2.0
  CHECKPOINT_PERIOD: 30
  CLIP_GRADIENTS:
    CLIP_TYPE: norm
    CLIP_VALUE: 5.0
    ENABLED: False
    NORM_TYPE: 2.0
  DELAY_EPOCHS: 0
  ETA_MIN_LR: 1e-07
  FP16_ENABLED: True
  FREEZE_FC_ITERS: 0
  FREEZE_ITERS: 0
  GAMMA: 0.1
  HEADS_LR_FACTOR: 1.0
  IMS_PER_BATCH: 32
  MAX_EPOCH: 60
  MOMENTUM: 0.9
  OPT: Adam
  SCHED: MultiStepLR
  STEPS: [40, 90]
  TRANS_LR_FACTOR: 1.0
  WARMUP_FACTOR: 0.1
  WARMUP_ITERS: 2000
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0005
  WEIGHT_DECAY_BIAS: 0.0005
  WEIGHT_DECAY_NORM: 0.0005
  WEIGHT_DECAY_TRANS: 0.0005
TEST:
  AQE:
    ALPHA: 3.0
    ENABLED: False
    QE_K: 5
    QE_TIME: 1
  ERASE_NUM: 64
  EVAL_PERIOD: 5
  FLIP_ENABLED: False
  HASH_RATE: 0.3
  IMS_PER_BATCH: 128
  METRIC: cosine
  NEIGHBOR_RANGE: 100
  PRECISE_BN:
    DATASET: Market1501
    ENABLED: False
    NUM_ITER: 300
  RERANK:
    ENABLED: False
    K1: 20
    K2: 6
    LAMBDA: 0.3
  ROC_ENABLED: False
  SEQ_TEST: False
  TIMES: 1
  VERIF: False
[08/23 21:16:17] fastreid INFO: Full config saved to /home/huangju/codes/fast-reid/logs/BoT_verif_msmt17/config.yaml
[08/23 21:16:17] fastreid.utils.env INFO: Using a generated random seed 19358287
[08/23 21:16:18] fastreid INFO: Model:
BaselineVerifMemBank(
  (heads): EmbeddingHead(
    (pool_layer): AdaptiveAvgPool2d(output_size=1)
    (bottleneck): Sequential(
      (0): BatchNorm(2560, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (classifier): Linear(in_features=2560, out_features=0, bias=False)
  )
  (verif_model): VerifHead(
    (pool_layer): AdaptiveAvgPool2d(output_size=1)
    (bottleneck): Sequential(
      (0): Conv2d(2560, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
    )
    (classifier): Sequential(
      (0): Linear(in_features=1024, out_features=512, bias=True)
      (1): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): Dropout(p=0.2, inplace=False)
      (3): PReLU(num_parameters=1)
      (4): Linear(in_features=512, out_features=256, bias=True)
      (5): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (6): PReLU(num_parameters=1)
      (7): Linear(in_features=256, out_features=128, bias=True)
      (8): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (9): PReLU(num_parameters=1)
      (10): Linear(in_features=128, out_features=64, bias=True)
      (11): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (12): PReLU(num_parameters=1)
      (13): Linear(in_features=64, out_features=32, bias=True)
      (14): BatchNorm1d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (15): PReLU(num_parameters=1)
      (16): Linear(in_features=32, out_features=16, bias=True)
      (17): BatchNorm1d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (18): PReLU(num_parameters=1)
      (19): Linear(in_features=16, out_features=2, bias=False)
    )
    (drop): Dropout(p=0.5, inplace=False)
  )
)
[08/23 21:16:19] fastreid.utils.checkpoint INFO: No checkpoint found. Training model from scratch
[08/23 21:16:19] fastreid INFO: Start training from epoch 0
[08/23 21:16:58] fastreid INFO: Rank of current process: 0. World size: 1
[08/23 21:16:59] fastreid INFO: Environment info:
----------------------  ------------------------------------------------------------------------------------
sys.platform            linux
Python                  3.7.9 (default, Aug 31 2020, 12:42:55) [GCC 7.3.0]
numpy                   1.19.2
fastreid                1.3 @./fastreid
FASTREID_ENV_MODULE     <not set>
PyTorch                 1.6.0 @/home/huangju/anaconda3/envs/fastreid/lib/python3.7/site-packages/torch
PyTorch debug build     False
GPU available           True
GPU 0                   NVIDIA GeForce GTX 1080 Ti
CUDA_HOME               /usr/local/cuda
Pillow                  8.1.0
torchvision             0.7.0 @/home/huangju/anaconda3/envs/fastreid/lib/python3.7/site-packages/torchvision
torchvision arch flags  sm_35, sm_50, sm_60, sm_70, sm_75
cv2                     3.4.2
----------------------  ------------------------------------------------------------------------------------
PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) Math Kernel Library Version 2020.0.2 Product Build 20200624 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v1.5.0 (Git Hash e2ac1fac44c5078ca927cb9b90e1b3066a0b2ed0)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 10.2
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_37,code=compute_37
  - CuDNN 7.6.5
  - Magma 2.5.2
  - Build settings: BLAS=MKL, BUILD_TYPE=Release, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DUSE_VULKAN_WRAPPER -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, USE_CUDA=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_STATIC_DISPATCH=OFF, 

[08/23 21:16:59] fastreid INFO: Command line arguments: Namespace(config_file='./configs/BOT-verif-msmt17.yml', dist_url='tcp://127.0.0.1:50190', eval_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=[], resume=False)
[08/23 21:16:59] fastreid INFO: Contents of args.config_file=./configs/BOT-verif-msmt17.yml:
_BASE_: "./Base-bagtricks.yml"
MODEL:
  META_ARCHITECTURE: "BaselineVerifMemBank"

  BACKBONE:
    NAME: "build_resnet_backbone"
  LOSSES:
    NAME: ("VerificationLoss")

TEST:
  EVAL_PERIOD: 5

DATASETS:
  NAMES: ("Market1501",)
  TESTS: ("Market1501",)

DATALOADER:
  PK_SAMPLER: True
  NAIVE_WAY: True
  PERSON_NUMBER: 1041
  PERSON_NUMBER_TEST: 3060
OUTPUT_DIR: "logs/BoT_verif_msmt17"
[08/23 21:16:59] fastreid INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  NAIVE_WAY: True
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  PERSON_NUMBER: 1041
  PERSON_NUMBER_TEST: 3060
  PK_SAMPLER: True
  SEQ_LEN: 8
  TEST_SEQ_LEN: 0
DATASETS:
  COMBINEALL: False
  NAMES: ('Market1501',)
  TESTS: ('Market1501',)
INPUT:
  AUGMIX_PROB: 0.0
  AUTOAUG_PROB: 0.0
  CJ:
    BRIGHTNESS: 0.15
    CONTRAST: 0.15
    ENABLED: False
    HUE: 0.1
    PROB: 0.5
    SATURATION: 0.1
  DO_AUGMIX: False
  DO_AUTOAUG: False
  DO_FLIP: True
  DO_PAD: True
  DO_RANDAUG: False
  FLIP_PROB: 0.5
  MIX_TRACKLET: False
  PADDING: 10
  PADDING_MODE: constant
  RANDAUG_PROB: 0.5
  RANDAUG_STR: rand-m9-mstd0.5
  REA:
    ENABLED: True
    PROB: 0.5
    VALUE: [151.98, 142.29000000000002, 126.735]
  RPT:
    ENABLED: False
    PROB: 0.5
  SIZE_TEST: [256, 128]
  SIZE_TRAIN: [256, 128]
MODEL:
  BACKBONE:
    DEPTH: 50x
    FEAT_DIM: 2560
    LAST_STRIDE: 1
    NAME: build_resnet_backbone
    NORM: BN
    PRETRAIN: True
    PRETRAIN_PATH: 
    REMOVE: (3, 4)
    WITH_IBN: False
    WITH_NL: False
    WITH_SE: False
  DEVICE: cuda
  FREEZE_LAYERS: ['']
  HEADS:
    CLS_LAYER: linear
    EMBEDDING_DIM: 0
    HASH_LAYER_DIMS: []
    HASH_LAYER_NUM: 1
    MARGIN: 0.15
    NAME: EmbeddingHead
    NECK_FEAT: before
    NORM: BN
    NUM_CLASSES: 0
    POOL_LAYER: avgpool
    SCALE: 128
    TEMP: 1.0
    WITH_BNNECK: True
  LOSSES:
    CE:
      ALPHA: 0.2
      EPSILON: 0.1
      SCALE: 1.0
    CIRCLE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    COSFACE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    FL:
      ALPHA: 0.25
      GAMMA: 2
      SCALE: 1.0
    NAME: VerificationLoss
    TRI:
      HARD_MINING: True
      MARGIN: 0.3
      NORM_FEAT: False
      SCALE: 1.0
  META_ARCHITECTURE: BaselineVerifMemBank
  PIXEL_MEAN: [123.675, 116.28, 103.53]
  PIXEL_STD: [58.395, 57.120000000000005, 57.375]
  TRANSFORMER:
    DEPTH: 12
    EMBED_DIM: 768
    ENABLE_POS: False
    FEATURE_DIM: 2048
    INPUT_SIZE: (512, 64, 32)
    NAME: TransformerHead
    NUM_HEADS: 3
    PART_H: 4
    PART_STR: ('4x1',)
    PART_V: 1
    PATH_DROP: 0.1
    POS_DROP: 0.0
  TRANSFORMER_S:
    ATTN_DROP: 0.0
    CE_SCALE: 1.0
    DEPTH: 12
    EMBED_DIM: 768
    ENABLE_POS: False
    FEATURE_DIM: 2048
    GAP: False
    INPUT_SIZE: (512, 64, 32)
    LOCAL_PART: 4
    NAME: SpatialTransformerHead
    NUM_HEADS: 3
    PART_STR: 8x4
    PATH_DROP: 0.1
    POS_DROP: 0.0
    RET_ALL: False
  TRANSFORMER_T:
    ATTN_DROP: 0.0
    DEPTH: 12
    EMBED_DIM: 768
    ENABLE_POS: False
    GAP: False
    NAME: TemporalTransformerHead
    NUM_HEADS: 3
    PATH_DROP: 0.1
    POS_DROP: 0.0
    RET_ALL: False
    RET_ATTN: False
  WEIGHTS: 
OUTPUT_DIR: logs/BoT_verif_msmt17
SOLVER:
  BASE_LR: 0.00035
  BIAS_LR_FACTOR: 2.0
  CHECKPOINT_PERIOD: 30
  CLIP_GRADIENTS:
    CLIP_TYPE: norm
    CLIP_VALUE: 5.0
    ENABLED: False
    NORM_TYPE: 2.0
  DELAY_EPOCHS: 0
  ETA_MIN_LR: 1e-07
  FP16_ENABLED: True
  FREEZE_FC_ITERS: 0
  FREEZE_ITERS: 0
  GAMMA: 0.1
  HEADS_LR_FACTOR: 1.0
  IMS_PER_BATCH: 32
  MAX_EPOCH: 60
  MOMENTUM: 0.9
  OPT: Adam
  SCHED: MultiStepLR
  STEPS: [40, 90]
  TRANS_LR_FACTOR: 1.0
  WARMUP_FACTOR: 0.1
  WARMUP_ITERS: 2000
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0005
  WEIGHT_DECAY_BIAS: 0.0005
  WEIGHT_DECAY_NORM: 0.0005
  WEIGHT_DECAY_TRANS: 0.0005
TEST:
  AQE:
    ALPHA: 3.0
    ENABLED: False
    QE_K: 5
    QE_TIME: 1
  ERASE_NUM: 64
  EVAL_PERIOD: 5
  FLIP_ENABLED: False
  HASH_RATE: 0.3
  IMS_PER_BATCH: 128
  METRIC: cosine
  NEIGHBOR_RANGE: 100
  PRECISE_BN:
    DATASET: Market1501
    ENABLED: False
    NUM_ITER: 300
  RERANK:
    ENABLED: False
    K1: 20
    K2: 6
    LAMBDA: 0.3
  ROC_ENABLED: False
  SEQ_TEST: False
  TIMES: 1
  VERIF: False
[08/23 21:16:59] fastreid INFO: Full config saved to /home/huangju/codes/fast-reid/logs/BoT_verif_msmt17/config.yaml
[08/23 21:16:59] fastreid.utils.env INFO: Using a generated random seed 61623382
[08/23 21:17:01] fastreid INFO: Model:
BaselineVerifMemBank(
  (heads): EmbeddingHead(
    (pool_layer): AdaptiveAvgPool2d(output_size=1)
    (bottleneck): Sequential(
      (0): BatchNorm(2560, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (classifier): Linear(in_features=2560, out_features=0, bias=False)
  )
  (verif_model): VerifHead(
    (pool_layer): AdaptiveAvgPool2d(output_size=1)
    (bottleneck): Sequential(
      (0): Conv2d(2560, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
    )
    (classifier): Sequential(
      (0): Linear(in_features=1024, out_features=512, bias=True)
      (1): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): Dropout(p=0.2, inplace=False)
      (3): PReLU(num_parameters=1)
      (4): Linear(in_features=512, out_features=256, bias=True)
      (5): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (6): PReLU(num_parameters=1)
      (7): Linear(in_features=256, out_features=128, bias=True)
      (8): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (9): PReLU(num_parameters=1)
      (10): Linear(in_features=128, out_features=64, bias=True)
      (11): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (12): PReLU(num_parameters=1)
      (13): Linear(in_features=64, out_features=32, bias=True)
      (14): BatchNorm1d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (15): PReLU(num_parameters=1)
      (16): Linear(in_features=32, out_features=16, bias=True)
      (17): BatchNorm1d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (18): PReLU(num_parameters=1)
      (19): Linear(in_features=16, out_features=2, bias=False)
    )
    (drop): Dropout(p=0.5, inplace=False)
  )
)
[08/23 21:17:01] fastreid.utils.checkpoint INFO: No checkpoint found. Training model from scratch
[08/23 21:17:01] fastreid INFO: Start training from epoch 0
[08/23 21:24:08] fastreid INFO: Rank of current process: 0. World size: 1
[08/23 21:24:09] fastreid INFO: Environment info:
----------------------  ------------------------------------------------------------------------------------
sys.platform            linux
Python                  3.7.9 (default, Aug 31 2020, 12:42:55) [GCC 7.3.0]
numpy                   1.19.2
fastreid                1.3 @./fastreid
FASTREID_ENV_MODULE     <not set>
PyTorch                 1.6.0 @/home/huangju/anaconda3/envs/fastreid/lib/python3.7/site-packages/torch
PyTorch debug build     False
GPU available           True
GPU 0                   NVIDIA GeForce GTX 1080 Ti
CUDA_HOME               /usr/local/cuda
Pillow                  8.1.0
torchvision             0.7.0 @/home/huangju/anaconda3/envs/fastreid/lib/python3.7/site-packages/torchvision
torchvision arch flags  sm_35, sm_50, sm_60, sm_70, sm_75
cv2                     3.4.2
----------------------  ------------------------------------------------------------------------------------
PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) Math Kernel Library Version 2020.0.2 Product Build 20200624 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v1.5.0 (Git Hash e2ac1fac44c5078ca927cb9b90e1b3066a0b2ed0)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 10.2
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_37,code=compute_37
  - CuDNN 7.6.5
  - Magma 2.5.2
  - Build settings: BLAS=MKL, BUILD_TYPE=Release, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DUSE_VULKAN_WRAPPER -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, USE_CUDA=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_STATIC_DISPATCH=OFF, 

[08/23 21:24:09] fastreid INFO: Command line arguments: Namespace(config_file='./configs/BOT-verif-msmt17.yml', dist_url='tcp://127.0.0.1:50190', eval_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=[], resume=False)
[08/23 21:24:09] fastreid INFO: Contents of args.config_file=./configs/BOT-verif-msmt17.yml:
_BASE_: "./Base-bagtricks.yml"
MODEL:
  META_ARCHITECTURE: "BaselineVerifMemBank"

  BACKBONE:
    NAME: "build_resnet_backbone"
  LOSSES:
    NAME: ("VerificationLoss")

TEST:
  EVAL_PERIOD: 5

DATASETS:
  NAMES: ("Market1501",)
  TESTS: ("Market1501",)

DATALOADER:
  PK_SAMPLER: True
  NAIVE_WAY: True
  PERSON_NUMBER: 1041
  PERSON_NUMBER_TEST: 3060
OUTPUT_DIR: "logs/BoT_verif_msmt17"
[08/23 21:24:09] fastreid INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  NAIVE_WAY: True
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  PERSON_NUMBER: 1041
  PERSON_NUMBER_TEST: 3060
  PK_SAMPLER: True
  SEQ_LEN: 8
  TEST_SEQ_LEN: 0
DATASETS:
  COMBINEALL: False
  NAMES: ('Market1501',)
  TESTS: ('Market1501',)
INPUT:
  AUGMIX_PROB: 0.0
  AUTOAUG_PROB: 0.0
  CJ:
    BRIGHTNESS: 0.15
    CONTRAST: 0.15
    ENABLED: False
    HUE: 0.1
    PROB: 0.5
    SATURATION: 0.1
  DO_AUGMIX: False
  DO_AUTOAUG: False
  DO_FLIP: True
  DO_PAD: True
  DO_RANDAUG: False
  FLIP_PROB: 0.5
  MIX_TRACKLET: False
  PADDING: 10
  PADDING_MODE: constant
  RANDAUG_PROB: 0.5
  RANDAUG_STR: rand-m9-mstd0.5
  REA:
    ENABLED: True
    PROB: 0.5
    VALUE: [151.98, 142.29000000000002, 126.735]
  RPT:
    ENABLED: False
    PROB: 0.5
  SIZE_TEST: [256, 128]
  SIZE_TRAIN: [256, 128]
MODEL:
  BACKBONE:
    DEPTH: 50x
    FEAT_DIM: 2560
    LAST_STRIDE: 1
    NAME: build_resnet_backbone
    NORM: BN
    PRETRAIN: True
    PRETRAIN_PATH: 
    REMOVE: (3, 4)
    WITH_IBN: False
    WITH_NL: False
    WITH_SE: False
  DEVICE: cuda
  FREEZE_LAYERS: ['']
  HEADS:
    CLS_LAYER: linear
    EMBEDDING_DIM: 0
    HASH_LAYER_DIMS: []
    HASH_LAYER_NUM: 1
    MARGIN: 0.15
    NAME: EmbeddingHead
    NECK_FEAT: before
    NORM: BN
    NUM_CLASSES: 0
    POOL_LAYER: avgpool
    SCALE: 128
    TEMP: 1.0
    WITH_BNNECK: True
  LOSSES:
    CE:
      ALPHA: 0.2
      EPSILON: 0.1
      SCALE: 1.0
    CIRCLE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    COSFACE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    FL:
      ALPHA: 0.25
      GAMMA: 2
      SCALE: 1.0
    NAME: VerificationLoss
    TRI:
      HARD_MINING: True
      MARGIN: 0.3
      NORM_FEAT: False
      SCALE: 1.0
  META_ARCHITECTURE: BaselineVerifMemBank
  PIXEL_MEAN: [123.675, 116.28, 103.53]
  PIXEL_STD: [58.395, 57.120000000000005, 57.375]
  TRANSFORMER:
    DEPTH: 12
    EMBED_DIM: 768
    ENABLE_POS: False
    FEATURE_DIM: 2048
    INPUT_SIZE: (512, 64, 32)
    NAME: TransformerHead
    NUM_HEADS: 3
    PART_H: 4
    PART_STR: ('4x1',)
    PART_V: 1
    PATH_DROP: 0.1
    POS_DROP: 0.0
  TRANSFORMER_S:
    ATTN_DROP: 0.0
    CE_SCALE: 1.0
    DEPTH: 12
    EMBED_DIM: 768
    ENABLE_POS: False
    FEATURE_DIM: 2048
    GAP: False
    INPUT_SIZE: (512, 64, 32)
    LOCAL_PART: 4
    NAME: SpatialTransformerHead
    NUM_HEADS: 3
    PART_STR: 8x4
    PATH_DROP: 0.1
    POS_DROP: 0.0
    RET_ALL: False
  TRANSFORMER_T:
    ATTN_DROP: 0.0
    DEPTH: 12
    EMBED_DIM: 768
    ENABLE_POS: False
    GAP: False
    NAME: TemporalTransformerHead
    NUM_HEADS: 3
    PATH_DROP: 0.1
    POS_DROP: 0.0
    RET_ALL: False
    RET_ATTN: False
  WEIGHTS: 
OUTPUT_DIR: logs/BoT_verif_msmt17
SOLVER:
  BASE_LR: 0.00035
  BIAS_LR_FACTOR: 2.0
  CHECKPOINT_PERIOD: 30
  CLIP_GRADIENTS:
    CLIP_TYPE: norm
    CLIP_VALUE: 5.0
    ENABLED: False
    NORM_TYPE: 2.0
  DELAY_EPOCHS: 0
  ETA_MIN_LR: 1e-07
  FP16_ENABLED: True
  FREEZE_FC_ITERS: 0
  FREEZE_ITERS: 0
  GAMMA: 0.1
  HEADS_LR_FACTOR: 1.0
  IMS_PER_BATCH: 32
  MAX_EPOCH: 60
  MOMENTUM: 0.9
  OPT: Adam
  SCHED: MultiStepLR
  STEPS: [40, 90]
  TRANS_LR_FACTOR: 1.0
  WARMUP_FACTOR: 0.1
  WARMUP_ITERS: 2000
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0005
  WEIGHT_DECAY_BIAS: 0.0005
  WEIGHT_DECAY_NORM: 0.0005
  WEIGHT_DECAY_TRANS: 0.0005
TEST:
  AQE:
    ALPHA: 3.0
    ENABLED: False
    QE_K: 5
    QE_TIME: 1
  ERASE_NUM: 64
  EVAL_PERIOD: 5
  FLIP_ENABLED: False
  HASH_RATE: 0.3
  IMS_PER_BATCH: 128
  METRIC: cosine
  NEIGHBOR_RANGE: 100
  PRECISE_BN:
    DATASET: Market1501
    ENABLED: False
    NUM_ITER: 300
  RERANK:
    ENABLED: False
    K1: 20
    K2: 6
    LAMBDA: 0.3
  ROC_ENABLED: False
  SEQ_TEST: False
  TIMES: 1
  VERIF: False
[08/23 21:24:09] fastreid INFO: Full config saved to /home/huangju/codes/fast-reid/logs/BoT_verif_msmt17/config.yaml
[08/23 21:24:09] fastreid.utils.env INFO: Using a generated random seed 11493759
[08/23 21:24:11] fastreid INFO: Model:
BaselineVerifMemBank(
  (heads): EmbeddingHead(
    (pool_layer): AdaptiveAvgPool2d(output_size=1)
    (bottleneck): Sequential(
      (0): BatchNorm(2560, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (classifier): Linear(in_features=2560, out_features=0, bias=False)
  )
  (verif_model): VerifHead(
    (pool_layer): AdaptiveAvgPool2d(output_size=1)
    (bottleneck): Sequential(
      (0): Conv2d(2560, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
    )
    (classifier): Sequential(
      (0): Linear(in_features=1024, out_features=512, bias=True)
      (1): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): Dropout(p=0.2, inplace=False)
      (3): PReLU(num_parameters=1)
      (4): Linear(in_features=512, out_features=256, bias=True)
      (5): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (6): PReLU(num_parameters=1)
      (7): Linear(in_features=256, out_features=128, bias=True)
      (8): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (9): PReLU(num_parameters=1)
      (10): Linear(in_features=128, out_features=64, bias=True)
      (11): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (12): PReLU(num_parameters=1)
      (13): Linear(in_features=64, out_features=32, bias=True)
      (14): BatchNorm1d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (15): PReLU(num_parameters=1)
      (16): Linear(in_features=32, out_features=16, bias=True)
      (17): BatchNorm1d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (18): PReLU(num_parameters=1)
      (19): Linear(in_features=16, out_features=2, bias=False)
    )
    (drop): Dropout(p=0.5, inplace=False)
  )
)
[08/23 21:24:11] fastreid.utils.checkpoint INFO: No checkpoint found. Training model from scratch
[08/23 21:24:11] fastreid INFO: Start training from epoch 0
[08/23 21:30:34] fastreid.utils.events INFO:  epoch/iter: 0/199  total_loss: 658.4  loss_bank_verif: 658.4  lr: 6.63e-05  max_mem: 1278M
[08/23 21:32:23] fastreid INFO: training accuracy_positive is tensor([0.0260], device='cuda:0')
[08/23 21:32:23] fastreid.utils.events INFO:  eta: 7:53:42  epoch/iter: 0/257  total_loss: 620.4  loss_bank_verif: 620.4  lr: 7.55e-05  max_mem: 3748M
[08/23 21:36:47] fastreid.utils.events INFO:  eta: 7:46:38  epoch/iter: 1/399  total_loss: 431.6  loss_bank_verif: 431.6  lr: 9.78e-05  max_mem: 3748M
[08/23 21:40:22] fastreid INFO: training accuracy_positive is tensor([0.], device='cuda:0')
[08/23 21:40:22] fastreid.utils.events INFO:  eta: 7:40:03  epoch/iter: 1/515  total_loss: 250.6  loss_bank_verif: 250.6  lr: 1.16e-04  max_mem: 3748M
[08/23 21:42:59] fastreid.utils.events INFO:  eta: 7:41:47  epoch/iter: 2/599  total_loss: 190.3  loss_bank_verif: 190.3  lr: 1.29e-04  max_mem: 3748M
[08/23 21:48:23] fastreid INFO: training accuracy_positive is tensor([0.], device='cuda:0')
[08/23 21:48:23] fastreid.utils.events INFO:  eta: 7:34:32  epoch/iter: 2/773  total_loss: 74.83  loss_bank_verif: 74.83  lr: 1.57e-04  max_mem: 3748M
[08/23 21:49:12] fastreid.utils.events INFO:  eta: 7:34:49  epoch/iter: 3/799  total_loss: 64.74  loss_bank_verif: 64.74  lr: 1.61e-04  max_mem: 3748M
[08/23 21:55:25] fastreid.utils.events INFO:  eta: 7:29:00  epoch/iter: 3/999  total_loss: 27.14  loss_bank_verif: 27.14  lr: 1.92e-04  max_mem: 3748M
[08/23 21:56:24] fastreid INFO: training accuracy_positive is tensor([0.4609], device='cuda:0')
[08/23 21:56:24] fastreid.utils.events INFO:  eta: 7:17:34  epoch/iter: 3/1031  total_loss: 22.17  loss_bank_verif: 22.17  lr: 1.97e-04  max_mem: 3748M
[08/23 22:01:37] fastreid.utils.events INFO:  eta: 7:21:27  epoch/iter: 4/1199  total_loss: 11.73  loss_bank_verif: 11.73  lr: 2.24e-04  max_mem: 3748M
[08/23 22:04:23] fastreid INFO: training accuracy_positive is tensor([0.9642], device='cuda:0')
[08/23 22:04:23] fastreid.utils.events INFO:  eta: 7:14:51  epoch/iter: 4/1289  total_loss: 8.772  loss_bank_verif: 8.772  lr: 2.38e-04  max_mem: 3748M
[08/23 23:13:19] fastreid INFO: accuracy on test set: 99.967313 %
[08/23 23:13:19] fastreid INFO: img_correct on test set: 0 %
[08/23 23:13:19] fastreid INFO: img_accuracy on test set: 0.000000 %
[08/23 23:16:43] fastreid.utils.events INFO:  eta: 6 days, 9:39:55  epoch/iter: 5/1399  total_loss: 6.38  loss_bank_verif: 6.38  lr: 2.55e-04  max_mem: 3748M
[08/23 23:21:18] fastreid INFO: training accuracy_positive is tensor([0.6674], device='cuda:0')
[08/23 23:21:18] fastreid.utils.events INFO:  eta: 7:09:07  epoch/iter: 5/1547  total_loss: 5.791  loss_bank_verif: 5.791  lr: 2.79e-04  max_mem: 3748M
[08/23 23:22:55] fastreid.utils.events INFO:  eta: 7:10:43  epoch/iter: 6/1599  total_loss: 7.264  loss_bank_verif: 7.264  lr: 2.87e-04  max_mem: 3748M
[08/23 23:29:10] fastreid.utils.events INFO:  eta: 7:05:08  epoch/iter: 6/1799  total_loss: 4.175  loss_bank_verif: 4.175  lr: 3.18e-04  max_mem: 3748M
[08/23 23:29:19] fastreid INFO: training accuracy_positive is tensor([0.6363], device='cuda:0')
[08/23 23:29:19] fastreid.utils.events INFO:  eta: 6:09:24  epoch/iter: 6/1805  total_loss: 4.122  loss_bank_verif: 4.122  lr: 3.19e-04  max_mem: 3748M
[08/23 23:35:23] fastreid.utils.events INFO:  eta: 6:59:12  epoch/iter: 7/1999  total_loss: 2.723  loss_bank_verif: 2.723  lr: 3.50e-04  max_mem: 3748M
[08/23 23:37:22] fastreid INFO: training accuracy_positive is tensor([0.8445], device='cuda:0')
[08/23 23:37:22] fastreid.utils.events INFO:  eta: 6:52:44  epoch/iter: 7/2063  total_loss: 1.9  loss_bank_verif: 1.9  lr: 3.50e-04  max_mem: 3748M
[08/23 23:41:36] fastreid.utils.events INFO:  eta: 6:52:02  epoch/iter: 8/2199  total_loss: 1.085  loss_bank_verif: 1.085  lr: 3.50e-04  max_mem: 3748M
[08/23 23:45:22] fastreid INFO: training accuracy_positive is tensor([0.9661], device='cuda:0')
[08/23 23:45:22] fastreid.utils.events INFO:  eta: 6:44:06  epoch/iter: 8/2321  total_loss: 0.8427  loss_bank_verif: 0.8427  lr: 3.50e-04  max_mem: 3748M
[08/23 23:47:47] fastreid.utils.events INFO:  eta: 6:44:38  epoch/iter: 9/2399  total_loss: 0.7433  loss_bank_verif: 0.7433  lr: 3.50e-04  max_mem: 3748M
[08/23 23:53:24] fastreid INFO: training accuracy_positive is tensor([0.9818], device='cuda:0')
[08/23 23:53:24] fastreid.utils.events INFO:  eta: 6:40:17  epoch/iter: 9/2579  total_loss: 0.5777  loss_bank_verif: 0.5777  lr: 3.50e-04  max_mem: 3748M
[08/24 01:02:04] fastreid INFO: accuracy on test set: 99.967322 %
[08/24 01:02:04] fastreid INFO: img_correct on test set: 2 %
[08/24 01:02:04] fastreid INFO: img_accuracy on test set: 0.008506 %
[08/24 01:02:41] fastreid.utils.events INFO:  eta: 30 days, 20:14:14  epoch/iter: 10/2599  total_loss: 0.5638  loss_bank_verif: 0.5638  lr: 3.50e-04  max_mem: 3748M
[08/24 01:09:00] fastreid.utils.events INFO:  eta: 6:37:48  epoch/iter: 10/2799  total_loss: 0.4463  loss_bank_verif: 0.4463  lr: 3.50e-04  max_mem: 3748M
[08/24 01:10:10] fastreid INFO: training accuracy_positive is tensor([0.9869], device='cuda:0')
[08/24 01:10:10] fastreid.utils.events INFO:  eta: 6:28:13  epoch/iter: 10/2837  total_loss: 0.4351  loss_bank_verif: 0.4351  lr: 3.50e-04  max_mem: 3748M
[08/24 01:15:16] fastreid.utils.events INFO:  eta: 6:31:32  epoch/iter: 11/2999  total_loss: 0.3437  loss_bank_verif: 0.3437  lr: 3.50e-04  max_mem: 3748M
[08/24 01:18:17] fastreid INFO: training accuracy_positive is tensor([0.9900], device='cuda:0')
[08/24 01:18:17] fastreid.utils.events INFO:  eta: 6:26:03  epoch/iter: 11/3095  total_loss: 0.31  loss_bank_verif: 0.31  lr: 3.50e-04  max_mem: 3748M
[08/24 01:21:33] fastreid.utils.events INFO:  eta: 6:23:21  epoch/iter: 12/3199  total_loss: 0.2773  loss_bank_verif: 0.2773  lr: 3.50e-04  max_mem: 3748M
[08/24 01:26:21] fastreid INFO: training accuracy_positive is tensor([0.9920], device='cuda:0')
[08/24 01:26:21] fastreid.utils.events INFO:  eta: 6:16:59  epoch/iter: 12/3353  total_loss: 0.2519  loss_bank_verif: 0.2519  lr: 3.50e-04  max_mem: 3748M
[08/24 01:27:48] fastreid.utils.events INFO:  eta: 6:17:46  epoch/iter: 13/3399  total_loss: 0.2401  loss_bank_verif: 0.2401  lr: 3.50e-04  max_mem: 3748M
[08/24 01:34:06] fastreid.utils.events INFO:  eta: 6:11:52  epoch/iter: 13/3599  total_loss: 0.2169  loss_bank_verif: 0.2169  lr: 3.50e-04  max_mem: 3748M
[08/24 01:34:27] fastreid INFO: training accuracy_positive is tensor([0.9916], device='cuda:0')
[08/24 01:34:27] fastreid.utils.events INFO:  eta: 5:45:34  epoch/iter: 13/3611  total_loss: 0.2169  loss_bank_verif: 0.2169  lr: 3.50e-04  max_mem: 3748M
[08/24 01:40:20] fastreid.utils.events INFO:  eta: 6:04:26  epoch/iter: 14/3799  total_loss: 0.1758  loss_bank_verif: 0.1758  lr: 3.50e-04  max_mem: 3748M
[08/24 01:42:30] fastreid INFO: training accuracy_positive is tensor([0.9934], device='cuda:0')
[08/24 01:42:30] fastreid.utils.events INFO:  eta: 5:56:47  epoch/iter: 14/3869  total_loss: 0.1582  loss_bank_verif: 0.1582  lr: 3.50e-04  max_mem: 3748M
[08/24 02:51:12] fastreid INFO: accuracy on test set: 99.967311 %
[08/24 02:51:12] fastreid INFO: img_correct on test set: 0 %
[08/24 02:51:12] fastreid INFO: img_accuracy on test set: 0.000000 %
[08/24 02:55:17] fastreid.utils.events INFO:  eta: 4 days, 10:33:05  epoch/iter: 15/3999  total_loss: 0.1391  loss_bank_verif: 0.1391  lr: 3.50e-04  max_mem: 3748M
[08/24 02:59:17] fastreid INFO: training accuracy_positive is tensor([0.9955], device='cuda:0')
[08/24 02:59:17] fastreid.utils.events INFO:  eta: 5:53:15  epoch/iter: 15/4127  total_loss: 0.1269  loss_bank_verif: 0.1269  lr: 3.50e-04  max_mem: 3748M
[08/24 03:01:33] fastreid.utils.events INFO:  eta: 5:52:39  epoch/iter: 16/4199  total_loss: 0.1152  loss_bank_verif: 0.1152  lr: 3.50e-04  max_mem: 3748M
[08/24 03:07:22] fastreid INFO: training accuracy_positive is tensor([0.9957], device='cuda:0')
[08/24 03:07:22] fastreid.utils.events INFO:  eta: 5:45:34  epoch/iter: 16/4385  total_loss: 0.114  loss_bank_verif: 0.114  lr: 3.50e-04  max_mem: 3748M
[08/24 03:07:49] fastreid.utils.events INFO:  eta: 5:45:15  epoch/iter: 17/4399  total_loss: 0.1123  loss_bank_verif: 0.1123  lr: 3.50e-04  max_mem: 3748M
[08/24 03:14:05] fastreid.utils.events INFO:  eta: 5:39:40  epoch/iter: 17/4599  total_loss: 0.09799  loss_bank_verif: 0.09799  lr: 3.50e-04  max_mem: 3748M
[08/24 03:15:26] fastreid INFO: training accuracy_positive is tensor([0.9956], device='cuda:0')
[08/24 03:15:26] fastreid.utils.events INFO:  eta: 5:31:12  epoch/iter: 17/4643  total_loss: 0.09236  loss_bank_verif: 0.09236  lr: 3.50e-04  max_mem: 3748M
[08/24 03:20:21] fastreid.utils.events INFO:  eta: 5:33:53  epoch/iter: 18/4799  total_loss: 0.0824  loss_bank_verif: 0.0824  lr: 3.50e-04  max_mem: 3748M
[08/24 03:23:32] fastreid INFO: training accuracy_positive is tensor([0.9905], device='cuda:0')
[08/24 03:23:32] fastreid.utils.events INFO:  eta: 5:28:16  epoch/iter: 18/4901  total_loss: 0.09811  loss_bank_verif: 0.09811  lr: 3.50e-04  max_mem: 3748M
[08/24 03:26:37] fastreid.utils.events INFO:  eta: 5:27:49  epoch/iter: 19/4999  total_loss: 0.1029  loss_bank_verif: 0.1029  lr: 3.50e-04  max_mem: 3748M
[08/24 03:31:37] fastreid INFO: training accuracy_positive is tensor([0.9945], device='cuda:0')
[08/24 03:31:37] fastreid.utils.events INFO:  eta: 5:20:30  epoch/iter: 19/5159  total_loss: 0.06899  loss_bank_verif: 0.06899  lr: 3.50e-04  max_mem: 3748M
[08/24 05:01:14] fastreid INFO: accuracy on test set: 0.178617 %
[08/24 05:01:14] fastreid INFO: img_correct on test set: 11130 %
[08/24 05:01:14] fastreid INFO: img_accuracy on test set: 47.337530 %
[08/24 05:02:29] fastreid.utils.events INFO:  eta: 16 days, 2:56:04  epoch/iter: 20/5199  total_loss: 0.06518  loss_bank_verif: 0.06518  lr: 3.50e-04  max_mem: 3748M
[08/24 05:08:46] fastreid.utils.events INFO:  eta: 5:15:13  epoch/iter: 20/5399  total_loss: 0.06271  loss_bank_verif: 0.06271  lr: 3.50e-04  max_mem: 3748M
[08/24 05:09:19] fastreid INFO: training accuracy_positive is tensor([0.9961], device='cuda:0')
[08/24 05:09:19] fastreid.utils.events INFO:  eta: 5:00:30  epoch/iter: 20/5417  total_loss: 0.06465  loss_bank_verif: 0.06465  lr: 3.50e-04  max_mem: 3748M
[08/24 05:15:01] fastreid.utils.events INFO:  eta: 5:07:51  epoch/iter: 21/5599  total_loss: 0.05558  loss_bank_verif: 0.05558  lr: 3.50e-04  max_mem: 3748M
[08/24 05:17:22] fastreid INFO: training accuracy_positive is tensor([0.9962], device='cuda:0')
[08/24 05:17:22] fastreid.utils.events INFO:  eta: 5:01:33  epoch/iter: 21/5675  total_loss: 0.05798  loss_bank_verif: 0.05798  lr: 3.50e-04  max_mem: 3748M
[08/24 05:21:15] fastreid.utils.events INFO:  eta: 5:01:41  epoch/iter: 22/5799  total_loss: 0.04523  loss_bank_verif: 0.04523  lr: 3.50e-04  max_mem: 3748M
[08/24 05:25:26] fastreid INFO: training accuracy_positive is tensor([0.9955], device='cuda:0')
[08/24 05:25:26] fastreid.utils.events INFO:  eta: 4:55:41  epoch/iter: 22/5933  total_loss: 0.05482  loss_bank_verif: 0.05482  lr: 3.50e-04  max_mem: 3748M
[08/24 05:27:30] fastreid.utils.events INFO:  eta: 4:56:02  epoch/iter: 23/5999  total_loss: 0.1014  loss_bank_verif: 0.1014  lr: 3.50e-04  max_mem: 3748M
[08/24 05:33:31] fastreid INFO: training accuracy_positive is tensor([0.7366], device='cuda:0')
[08/24 05:33:31] fastreid.utils.events INFO:  eta: 4:48:49  epoch/iter: 23/6191  total_loss: 0.4643  loss_bank_verif: 0.4643  lr: 3.50e-04  max_mem: 3748M
[08/24 05:33:46] fastreid.utils.events INFO:  eta: 4:49:33  epoch/iter: 24/6199  total_loss: 0.4517  loss_bank_verif: 0.4517  lr: 3.50e-04  max_mem: 3748M
[08/24 05:40:02] fastreid.utils.events INFO:  eta: 4:42:36  epoch/iter: 24/6399  total_loss: 0.1819  loss_bank_verif: 0.1819  lr: 3.50e-04  max_mem: 3748M
[08/24 05:41:34] fastreid INFO: training accuracy_positive is tensor([0.9812], device='cuda:0')
[08/24 05:41:34] fastreid.utils.events INFO:  eta: 4:35:49  epoch/iter: 24/6449  total_loss: 0.1541  loss_bank_verif: 0.1541  lr: 3.50e-04  max_mem: 3748M
[08/24 06:50:29] fastreid INFO: accuracy on test set: 99.967254 %
[08/24 06:50:29] fastreid INFO: img_correct on test set: 1 %
[08/24 06:50:29] fastreid INFO: img_accuracy on test set: 0.004253 %
[08/24 06:55:12] fastreid.utils.events INFO:  eta: 3 days, 0:09:30  epoch/iter: 25/6599  total_loss: 0.1057  loss_bank_verif: 0.1057  lr: 3.50e-04  max_mem: 3748M
[08/24 06:58:34] fastreid INFO: training accuracy_positive is tensor([0.9943], device='cuda:0')
[08/24 06:58:34] fastreid.utils.events INFO:  eta: 4:31:59  epoch/iter: 25/6707  total_loss: 0.08559  loss_bank_verif: 0.08559  lr: 3.50e-04  max_mem: 3748M
[08/24 07:01:28] fastreid.utils.events INFO:  eta: 4:30:17  epoch/iter: 26/6799  total_loss: 0.0593  loss_bank_verif: 0.0593  lr: 3.50e-04  max_mem: 3748M
[08/24 07:06:39] fastreid INFO: training accuracy_positive is tensor([0.9948], device='cuda:0')
[08/24 07:06:39] fastreid.utils.events INFO:  eta: 4:24:18  epoch/iter: 26/6965  total_loss: 0.05413  loss_bank_verif: 0.05413  lr: 3.50e-04  max_mem: 3748M
[08/24 07:07:43] fastreid.utils.events INFO:  eta: 4:24:53  epoch/iter: 27/6999  total_loss: 0.05029  loss_bank_verif: 0.05029  lr: 3.50e-04  max_mem: 3748M
[08/24 07:14:00] fastreid.utils.events INFO:  eta: 4:18:05  epoch/iter: 27/7199  total_loss: 0.04155  loss_bank_verif: 0.04155  lr: 3.50e-04  max_mem: 3748M
[08/24 07:14:44] fastreid INFO: training accuracy_positive is tensor([0.9968], device='cuda:0')
[08/24 07:14:44] fastreid.utils.events INFO:  eta: 4:08:27  epoch/iter: 27/7223  total_loss: 0.04279  loss_bank_verif: 0.04279  lr: 3.50e-04  max_mem: 3748M
[08/24 07:20:16] fastreid.utils.events INFO:  eta: 4:12:27  epoch/iter: 28/7399  total_loss: 0.03666  loss_bank_verif: 0.03666  lr: 3.50e-04  max_mem: 3748M
[08/24 07:22:49] fastreid INFO: training accuracy_positive is tensor([0.9957], device='cuda:0')
[08/24 07:22:49] fastreid.utils.events INFO:  eta: 4:07:02  epoch/iter: 28/7481  total_loss: 0.03266  loss_bank_verif: 0.03266  lr: 3.50e-04  max_mem: 3748M
[08/24 07:26:32] fastreid.utils.events INFO:  eta: 4:06:26  epoch/iter: 29/7599  total_loss: 0.02728  loss_bank_verif: 0.02728  lr: 3.50e-04  max_mem: 3748M
[08/24 07:30:55] fastreid INFO: training accuracy_positive is tensor([0.9953], device='cuda:0')
[08/24 07:30:55] fastreid.utils.events INFO:  eta: 4:00:32  epoch/iter: 29/7739  total_loss: 0.03128  loss_bank_verif: 0.03128  lr: 3.50e-04  max_mem: 3748M
[08/24 08:40:21] fastreid INFO: accuracy on test set: 99.967319 %
[08/24 08:40:21] fastreid INFO: img_correct on test set: 0 %
[08/24 08:40:21] fastreid INFO: img_accuracy on test set: 0.000000 %
[08/24 08:40:21] fastreid.utils.checkpoint INFO: Saving checkpoint to logs/BoT_verif_msmt17/model_0029.pth
[08/24 08:42:14] fastreid.utils.events INFO:  eta: 6 days, 6:57:20  epoch/iter: 30/7799  total_loss: 0.02978  loss_bank_verif: 0.02978  lr: 3.50e-04  max_mem: 3748M
[08/24 08:48:27] fastreid INFO: training accuracy_positive is tensor([0.9953], device='cuda:0')
[08/24 08:48:27] fastreid.utils.events INFO:  eta: 3:52:44  epoch/iter: 30/7997  total_loss: 0.03023  loss_bank_verif: 0.03023  lr: 3.50e-04  max_mem: 3748M
[08/24 08:48:31] fastreid.utils.events INFO:  eta: 3:57:30  epoch/iter: 31/7999  total_loss: 0.03023  loss_bank_verif: 0.03023  lr: 3.50e-04  max_mem: 3748M
[08/24 08:54:47] fastreid.utils.events INFO:  eta: 3:46:29  epoch/iter: 31/8199  total_loss: 0.01943  loss_bank_verif: 0.01943  lr: 3.50e-04  max_mem: 3748M
[08/24 08:56:31] fastreid INFO: training accuracy_positive is tensor([0.9966], device='cuda:0')
[08/24 08:56:31] fastreid.utils.events INFO:  eta: 3:40:38  epoch/iter: 31/8255  total_loss: 0.02084  loss_bank_verif: 0.02084  lr: 3.50e-04  max_mem: 3748M
[08/24 09:01:02] fastreid.utils.events INFO:  eta: 3:40:18  epoch/iter: 32/8399  total_loss: 0.01716  loss_bank_verif: 0.01716  lr: 3.50e-04  max_mem: 3748M
[08/24 09:04:35] fastreid INFO: training accuracy_positive is tensor([0.9978], device='cuda:0')
[08/24 09:04:35] fastreid.utils.events INFO:  eta: 3:35:07  epoch/iter: 32/8513  total_loss: 0.01358  loss_bank_verif: 0.01358  lr: 3.50e-04  max_mem: 3748M
[08/24 09:07:16] fastreid.utils.events INFO:  eta: 3:33:25  epoch/iter: 33/8599  total_loss: 0.01411  loss_bank_verif: 0.01411  lr: 3.50e-04  max_mem: 3748M
[08/24 09:12:40] fastreid INFO: training accuracy_positive is tensor([0.9973], device='cuda:0')
[08/24 09:12:40] fastreid.utils.events INFO:  eta: 3:28:22  epoch/iter: 33/8771  total_loss: 0.01763  loss_bank_verif: 0.01763  lr: 3.50e-04  max_mem: 3748M
[08/24 09:13:33] fastreid.utils.events INFO:  eta: 3:28:50  epoch/iter: 34/8799  total_loss: 0.01928  loss_bank_verif: 0.01928  lr: 3.50e-04  max_mem: 3748M
[08/24 09:19:48] fastreid.utils.events INFO:  eta: 3:20:42  epoch/iter: 34/8999  total_loss: 0.02599  loss_bank_verif: 0.02599  lr: 3.50e-04  max_mem: 3748M
[08/24 09:20:43] fastreid INFO: training accuracy_positive is tensor([0.9942], device='cuda:0')
[08/24 09:20:43] fastreid.utils.events INFO:  eta: 3:14:37  epoch/iter: 34/9029  total_loss: 0.02003  loss_bank_verif: 0.02003  lr: 3.50e-04  max_mem: 3748M
[08/24 10:30:10] fastreid INFO: accuracy on test set: 99.967294 %
[08/24 10:30:10] fastreid INFO: img_correct on test set: 1 %
[08/24 10:30:10] fastreid INFO: img_accuracy on test set: 0.004253 %
[08/24 10:35:31] fastreid.utils.events INFO:  eta: 1 day, 21:36:41  epoch/iter: 35/9199  total_loss: 0.01931  loss_bank_verif: 0.01931  lr: 3.50e-04  max_mem: 3748M
[08/24 10:38:14] fastreid INFO: training accuracy_positive is tensor([0.9973], device='cuda:0')
[08/24 10:38:14] fastreid.utils.events INFO:  eta: 3:10:09  epoch/iter: 35/9287  total_loss: 0.02024  loss_bank_verif: 0.02024  lr: 3.50e-04  max_mem: 3748M
[08/24 10:41:44] fastreid.utils.events INFO:  eta: 3:07:48  epoch/iter: 36/9399  total_loss: 0.01609  loss_bank_verif: 0.01609  lr: 3.50e-04  max_mem: 3748M
[08/24 10:46:16] fastreid INFO: training accuracy_positive is tensor([0.9006], device='cuda:0')
[08/24 10:46:16] fastreid.utils.events INFO:  eta: 3:02:37  epoch/iter: 36/9545  total_loss: 0.02461  loss_bank_verif: 0.02461  lr: 3.50e-04  max_mem: 3748M
[08/24 10:47:58] fastreid.utils.events INFO:  eta: 3:02:06  epoch/iter: 37/9599  total_loss: 0.1278  loss_bank_verif: 0.1278  lr: 3.50e-04  max_mem: 3748M
[08/24 10:54:14] fastreid.utils.events INFO:  eta: 2:56:09  epoch/iter: 37/9799  total_loss: 0.08935  loss_bank_verif: 0.08935  lr: 3.50e-04  max_mem: 3748M
[08/24 10:54:20] fastreid INFO: training accuracy_positive is tensor([0.9840], device='cuda:0')
[08/24 10:54:20] fastreid.utils.events INFO:  eta: 2:24:45  epoch/iter: 37/9803  total_loss: 0.08791  loss_bank_verif: 0.08791  lr: 3.50e-04  max_mem: 3748M
[08/24 11:56:01] fastreid INFO: Rank of current process: 0. World size: 1
[08/24 11:56:02] fastreid INFO: Environment info:
----------------------  ------------------------------------------------------------------------------------
sys.platform            linux
Python                  3.7.9 (default, Aug 31 2020, 12:42:55) [GCC 7.3.0]
numpy                   1.19.2
fastreid                1.3 @./fastreid
FASTREID_ENV_MODULE     <not set>
PyTorch                 1.6.0 @/home/huangju/anaconda3/envs/fastreid/lib/python3.7/site-packages/torch
PyTorch debug build     False
GPU available           True
GPU 0                   NVIDIA GeForce GTX 1080 Ti
CUDA_HOME               /usr/local/cuda
Pillow                  8.1.0
torchvision             0.7.0 @/home/huangju/anaconda3/envs/fastreid/lib/python3.7/site-packages/torchvision
torchvision arch flags  sm_35, sm_50, sm_60, sm_70, sm_75
cv2                     3.4.2
----------------------  ------------------------------------------------------------------------------------
PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) Math Kernel Library Version 2020.0.2 Product Build 20200624 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v1.5.0 (Git Hash e2ac1fac44c5078ca927cb9b90e1b3066a0b2ed0)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 10.2
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_37,code=compute_37
  - CuDNN 7.6.5
  - Magma 2.5.2
  - Build settings: BLAS=MKL, BUILD_TYPE=Release, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DUSE_VULKAN_WRAPPER -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, USE_CUDA=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_STATIC_DISPATCH=OFF, 

[08/24 11:56:02] fastreid INFO: Command line arguments: Namespace(config_file='./configs/BOT-verif-msmt17.yml', dist_url='tcp://127.0.0.1:50190', eval_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=[], resume=False)
[08/24 11:56:02] fastreid INFO: Contents of args.config_file=./configs/BOT-verif-msmt17.yml:
_BASE_: "./Base-bagtricks.yml"
MODEL:
  META_ARCHITECTURE: "BaselineVerifMemBank"

  BACKBONE:
    NAME: "build_resnet_backbone"
  LOSSES:
    NAME: ("VerificationLoss")

TEST:
  EVAL_PERIOD: 3

DATASETS:
  NAMES: ("Market1501",)
  TESTS: ("Market1501",)

DATALOADER:
  PK_SAMPLER: True
  NAIVE_WAY: True
  PERSON_NUMBER: 1041
  PERSON_NUMBER_TEST: 3060
OUTPUT_DIR: "logs/BoT_verif_msmt17"
[08/24 11:56:02] fastreid INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  NAIVE_WAY: True
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  PERSON_NUMBER: 1041
  PERSON_NUMBER_TEST: 3060
  PK_SAMPLER: True
  SEQ_LEN: 8
  TEST_SEQ_LEN: 0
DATASETS:
  COMBINEALL: False
  NAMES: ('Market1501',)
  TESTS: ('Market1501',)
INPUT:
  AUGMIX_PROB: 0.0
  AUTOAUG_PROB: 0.0
  CJ:
    BRIGHTNESS: 0.15
    CONTRAST: 0.15
    ENABLED: False
    HUE: 0.1
    PROB: 0.5
    SATURATION: 0.1
  DO_AUGMIX: False
  DO_AUTOAUG: False
  DO_FLIP: True
  DO_PAD: True
  DO_RANDAUG: False
  FLIP_PROB: 0.5
  MIX_TRACKLET: False
  PADDING: 10
  PADDING_MODE: constant
  RANDAUG_PROB: 0.5
  RANDAUG_STR: rand-m9-mstd0.5
  REA:
    ENABLED: True
    PROB: 0.5
    VALUE: [151.98, 142.29000000000002, 126.735]
  RPT:
    ENABLED: False
    PROB: 0.5
  SIZE_TEST: [256, 128]
  SIZE_TRAIN: [256, 128]
MODEL:
  BACKBONE:
    DEPTH: 50x
    FEAT_DIM: 2560
    LAST_STRIDE: 1
    NAME: build_resnet_backbone
    NORM: BN
    PRETRAIN: True
    PRETRAIN_PATH: 
    REMOVE: (3, 4)
    WITH_IBN: False
    WITH_NL: False
    WITH_SE: False
  DEVICE: cuda
  FREEZE_LAYERS: ['']
  HEADS:
    CLS_LAYER: linear
    EMBEDDING_DIM: 0
    HASH_LAYER_DIMS: []
    HASH_LAYER_NUM: 1
    MARGIN: 0.15
    NAME: EmbeddingHead
    NECK_FEAT: before
    NORM: BN
    NUM_CLASSES: 0
    POOL_LAYER: avgpool
    SCALE: 128
    TEMP: 1.0
    WITH_BNNECK: True
  LOSSES:
    CE:
      ALPHA: 0.2
      EPSILON: 0.1
      SCALE: 1.0
    CIRCLE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    COSFACE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    FL:
      ALPHA: 0.25
      GAMMA: 2
      SCALE: 1.0
    NAME: VerificationLoss
    TRI:
      HARD_MINING: True
      MARGIN: 0.3
      NORM_FEAT: False
      SCALE: 1.0
  META_ARCHITECTURE: BaselineVerifMemBank
  PIXEL_MEAN: [123.675, 116.28, 103.53]
  PIXEL_STD: [58.395, 57.120000000000005, 57.375]
  TRANSFORMER:
    DEPTH: 12
    EMBED_DIM: 768
    ENABLE_POS: False
    FEATURE_DIM: 2048
    INPUT_SIZE: (512, 64, 32)
    NAME: TransformerHead
    NUM_HEADS: 3
    PART_H: 4
    PART_STR: ('4x1',)
    PART_V: 1
    PATH_DROP: 0.1
    POS_DROP: 0.0
  TRANSFORMER_S:
    ATTN_DROP: 0.0
    CE_SCALE: 1.0
    DEPTH: 12
    EMBED_DIM: 768
    ENABLE_POS: False
    FEATURE_DIM: 2048
    GAP: False
    INPUT_SIZE: (512, 64, 32)
    LOCAL_PART: 4
    NAME: SpatialTransformerHead
    NUM_HEADS: 3
    PART_STR: 8x4
    PATH_DROP: 0.1
    POS_DROP: 0.0
    RET_ALL: False
  TRANSFORMER_T:
    ATTN_DROP: 0.0
    DEPTH: 12
    EMBED_DIM: 768
    ENABLE_POS: False
    GAP: False
    NAME: TemporalTransformerHead
    NUM_HEADS: 3
    PATH_DROP: 0.1
    POS_DROP: 0.0
    RET_ALL: False
    RET_ATTN: False
  WEIGHTS: 
OUTPUT_DIR: logs/BoT_verif_msmt17
SOLVER:
  BASE_LR: 0.00035
  BIAS_LR_FACTOR: 2.0
  CHECKPOINT_PERIOD: 30
  CLIP_GRADIENTS:
    CLIP_TYPE: norm
    CLIP_VALUE: 5.0
    ENABLED: False
    NORM_TYPE: 2.0
  DELAY_EPOCHS: 0
  ETA_MIN_LR: 1e-07
  FP16_ENABLED: True
  FREEZE_FC_ITERS: 0
  FREEZE_ITERS: 0
  GAMMA: 0.1
  HEADS_LR_FACTOR: 1.0
  IMS_PER_BATCH: 32
  MAX_EPOCH: 60
  MOMENTUM: 0.9
  OPT: Adam
  SCHED: MultiStepLR
  STEPS: [40, 90]
  TRANS_LR_FACTOR: 1.0
  WARMUP_FACTOR: 0.1
  WARMUP_ITERS: 2000
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0005
  WEIGHT_DECAY_BIAS: 0.0005
  WEIGHT_DECAY_NORM: 0.0005
  WEIGHT_DECAY_TRANS: 0.0005
TEST:
  AQE:
    ALPHA: 3.0
    ENABLED: False
    QE_K: 5
    QE_TIME: 1
  ERASE_NUM: 64
  EVAL_PERIOD: 3
  FLIP_ENABLED: False
  HASH_RATE: 0.3
  IMS_PER_BATCH: 128
  METRIC: cosine
  NEIGHBOR_RANGE: 100
  PRECISE_BN:
    DATASET: Market1501
    ENABLED: False
    NUM_ITER: 300
  RERANK:
    ENABLED: False
    K1: 20
    K2: 6
    LAMBDA: 0.3
  ROC_ENABLED: False
  SEQ_TEST: False
  TIMES: 1
  VERIF: False
[08/24 11:56:02] fastreid INFO: Full config saved to /home/huangju/codes/fast-reid/logs/BoT_verif_msmt17/config.yaml
[08/24 11:56:02] fastreid.utils.env INFO: Using a generated random seed 4504399
[08/24 11:56:04] fastreid INFO: Model:
BaselineVerifMemBank(
  (heads): EmbeddingHead(
    (pool_layer): AdaptiveAvgPool2d(output_size=1)
    (bottleneck): Sequential(
      (0): BatchNorm(2560, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (classifier): Linear(in_features=2560, out_features=0, bias=False)
  )
  (verif_model): VerifHead(
    (pool_layer): AdaptiveAvgPool2d(output_size=1)
    (bottleneck): Sequential(
      (0): Conv2d(2560, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
    )
    (classifier): Sequential(
      (0): Linear(in_features=1024, out_features=512, bias=True)
      (1): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): Dropout(p=0.2, inplace=False)
      (3): PReLU(num_parameters=1)
      (4): Linear(in_features=512, out_features=256, bias=True)
      (5): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (6): PReLU(num_parameters=1)
      (7): Linear(in_features=256, out_features=128, bias=True)
      (8): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (9): PReLU(num_parameters=1)
      (10): Linear(in_features=128, out_features=64, bias=True)
      (11): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (12): PReLU(num_parameters=1)
      (13): Linear(in_features=64, out_features=32, bias=True)
      (14): BatchNorm1d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (15): PReLU(num_parameters=1)
      (16): Linear(in_features=32, out_features=16, bias=True)
      (17): BatchNorm1d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (18): PReLU(num_parameters=1)
      (19): Linear(in_features=16, out_features=2, bias=False)
    )
    (drop): Dropout(p=0.5, inplace=False)
  )
)
[08/24 11:56:04] fastreid.utils.checkpoint INFO: No checkpoint found. Training model from scratch
[08/24 11:56:04] fastreid INFO: Start training from epoch 0
[08/24 12:02:35] fastreid.utils.events INFO:  epoch/iter: 0/199  total_loss: 611.5  loss_bank_verif: 611.5  lr: 6.63e-05  max_mem: 1278M
[08/24 12:04:26] fastreid INFO: training accuracy_positive is tensor([0.0363], device='cuda:0')
[08/24 12:04:26] fastreid.utils.events INFO:  eta: 8:06:00  epoch/iter: 0/257  total_loss: 532.1  loss_bank_verif: 532.1  lr: 7.55e-05  max_mem: 3748M
[08/24 12:08:58] fastreid.utils.events INFO:  eta: 7:58:33  epoch/iter: 1/399  total_loss: 359.1  loss_bank_verif: 359.1  lr: 9.78e-05  max_mem: 3748M
[08/24 12:12:38] fastreid INFO: training accuracy_positive is tensor([0.], device='cuda:0')
[08/24 12:12:38] fastreid.utils.events INFO:  eta: 7:51:31  epoch/iter: 1/515  total_loss: 237  loss_bank_verif: 237  lr: 1.16e-04  max_mem: 3748M
[08/24 12:15:20] fastreid.utils.events INFO:  eta: 7:54:58  epoch/iter: 2/599  total_loss: 189.6  loss_bank_verif: 189.6  lr: 1.29e-04  max_mem: 3748M
[08/24 12:20:52] fastreid INFO: training accuracy_positive is tensor([0.], device='cuda:0')
[08/24 12:20:52] fastreid.utils.events INFO:  eta: 7:46:28  epoch/iter: 2/773  total_loss: 105.6  loss_bank_verif: 105.6  lr: 1.57e-04  max_mem: 3748M
[08/24 13:52:19] fastreid INFO: testing accuracy_positive is tensor([0.], device='cuda:0')
[08/24 13:52:19] fastreid INFO: accuracy on test set: 99.967320 %
[08/24 13:52:19] fastreid INFO: img_correct on test set: 0 
[08/24 13:52:19] fastreid INFO: img_accuracy on test set: 0.000000 %
[08/24 13:53:09] fastreid.utils.events INFO:  eta: 36 days, 0:50:25  epoch/iter: 3/799  total_loss: 99.47  loss_bank_verif: 99.47  lr: 1.61e-04  max_mem: 3748M
[08/24 13:59:33] fastreid.utils.events INFO:  eta: 7:41:44  epoch/iter: 3/999  total_loss: 33.72  loss_bank_verif: 33.72  lr: 1.92e-04  max_mem: 3748M
[08/24 14:00:33] fastreid INFO: training accuracy_positive is tensor([0.3923], device='cuda:0')
[08/24 14:00:33] fastreid.utils.events INFO:  eta: 7:28:54  epoch/iter: 3/1031  total_loss: 27.39  loss_bank_verif: 27.39  lr: 1.97e-04  max_mem: 3748M
[08/24 14:05:56] fastreid.utils.events INFO:  eta: 7:34:39  epoch/iter: 4/1199  total_loss: 16.29  loss_bank_verif: 16.29  lr: 2.24e-04  max_mem: 3748M
[08/24 14:08:47] fastreid INFO: training accuracy_positive is tensor([0.5714], device='cuda:0')
[08/24 14:08:47] fastreid.utils.events INFO:  eta: 7:28:50  epoch/iter: 4/1289  total_loss: 13.8  loss_bank_verif: 13.8  lr: 2.38e-04  max_mem: 3748M
[08/24 14:12:17] fastreid.utils.events INFO:  eta: 7:26:47  epoch/iter: 5/1399  total_loss: 9.215  loss_bank_verif: 9.215  lr: 2.55e-04  max_mem: 3748M
[08/24 14:16:59] fastreid INFO: training accuracy_positive is tensor([0.9286], device='cuda:0')
[08/24 14:16:59] fastreid.utils.events INFO:  eta: 7:19:12  epoch/iter: 5/1547  total_loss: 5.662  loss_bank_verif: 5.662  lr: 2.79e-04  max_mem: 3748M
[08/24 15:48:15] fastreid INFO: testing accuracy_positive is tensor([0.], device='cuda:0')
[08/24 15:48:15] fastreid INFO: accuracy on test set: 99.967320 %
[08/24 15:48:15] fastreid INFO: img_correct on test set: 0 
[08/24 15:48:15] fastreid INFO: img_accuracy on test set: 0.000000 %
[08/24 15:49:55] fastreid.utils.events INFO:  eta: 17 days, 3:40:52  epoch/iter: 6/1599  total_loss: 4.941  loss_bank_verif: 4.941  lr: 2.87e-04  max_mem: 3748M
[08/24 15:56:20] fastreid.utils.events INFO:  eta: 7:17:22  epoch/iter: 6/1799  total_loss: 3.087  loss_bank_verif: 3.087  lr: 3.18e-04  max_mem: 3748M
[08/24 15:56:30] fastreid INFO: training accuracy_positive is tensor([0.9795], device='cuda:0')
[08/24 15:56:30] fastreid.utils.events INFO:  eta: 6:20:54  epoch/iter: 6/1805  total_loss: 3.058  loss_bank_verif: 3.058  lr: 3.19e-04  max_mem: 3748M
[08/24 16:02:44] fastreid.utils.events INFO:  eta: 7:11:09  epoch/iter: 7/1999  total_loss: 2.062  loss_bank_verif: 2.062  lr: 3.50e-04  max_mem: 3748M
[08/24 16:04:46] fastreid INFO: training accuracy_positive is tensor([0.9841], device='cuda:0')
[08/24 16:04:46] fastreid.utils.events INFO:  eta: 7:04:09  epoch/iter: 7/2063  total_loss: 1.855  loss_bank_verif: 1.855  lr: 3.50e-04  max_mem: 3748M
[08/24 16:09:09] fastreid.utils.events INFO:  eta: 7:05:36  epoch/iter: 8/2199  total_loss: 1.412  loss_bank_verif: 1.412  lr: 3.50e-04  max_mem: 3748M
[08/24 16:13:02] fastreid INFO: training accuracy_positive is tensor([0.9882], device='cuda:0')
[08/24 16:13:02] fastreid.utils.events INFO:  eta: 6:57:38  epoch/iter: 8/2321  total_loss: 1.235  loss_bank_verif: 1.235  lr: 3.50e-04  max_mem: 3748M
[08/24 17:44:42] fastreid INFO: testing accuracy_positive is tensor([0.], device='cuda:0')
[08/24 17:44:42] fastreid INFO: accuracy on test set: 99.967320 %
[08/24 17:44:42] fastreid INFO: img_correct on test set: 0 
[08/24 17:44:42] fastreid INFO: img_accuracy on test set: 0.000000 %
[08/24 17:47:13] fastreid.utils.events INFO:  eta: 10 days, 22:01:07  epoch/iter: 9/2399  total_loss: 1.074  loss_bank_verif: 1.074  lr: 3.50e-04  max_mem: 3748M
[08/24 17:53:01] fastreid INFO: training accuracy_positive is tensor([0.9926], device='cuda:0')
[08/24 17:53:01] fastreid.utils.events INFO:  eta: 6:53:02  epoch/iter: 9/2579  total_loss: 0.8423  loss_bank_verif: 0.8423  lr: 3.50e-04  max_mem: 3748M
[08/24 17:53:40] fastreid.utils.events INFO:  eta: 6:58:28  epoch/iter: 10/2599  total_loss: 0.8233  loss_bank_verif: 0.8233  lr: 3.50e-04  max_mem: 3748M
[08/24 18:00:05] fastreid.utils.events INFO:  eta: 6:45:11  epoch/iter: 10/2799  total_loss: 0.6547  loss_bank_verif: 0.6547  lr: 3.50e-04  max_mem: 3748M
[08/24 18:01:17] fastreid INFO: training accuracy_positive is tensor([0.9926], device='cuda:0')
[08/24 18:01:17] fastreid.utils.events INFO:  eta: 6:34:30  epoch/iter: 10/2837  total_loss: 0.6274  loss_bank_verif: 0.6274  lr: 3.50e-04  max_mem: 3748M
[08/24 18:06:29] fastreid.utils.events INFO:  eta: 6:38:52  epoch/iter: 11/2999  total_loss: 0.5029  loss_bank_verif: 0.5029  lr: 3.50e-04  max_mem: 3748M
[08/24 18:09:33] fastreid INFO: training accuracy_positive is tensor([0.9944], device='cuda:0')
[08/24 18:09:33] fastreid.utils.events INFO:  eta: 6:33:33  epoch/iter: 11/3095  total_loss: 0.4661  loss_bank_verif: 0.4661  lr: 3.50e-04  max_mem: 3748M
[08/24 20:02:50] fastreid INFO: testing accuracy_positive is tensor([0.0213], device='cuda:0')
[08/24 20:02:50] fastreid INFO: accuracy on test set: 0.017502 %
[08/24 20:02:50] fastreid INFO: img_correct on test set: 500 
[08/24 20:02:50] fastreid INFO: img_accuracy on test set: 2.126574 %
[08/24 20:06:11] fastreid.utils.events INFO:  eta: 9 days, 12:24:55  epoch/iter: 12/3199  total_loss: 0.4312  loss_bank_verif: 0.4312  lr: 3.50e-04  max_mem: 3748M
[08/24 20:11:08] fastreid INFO: training accuracy_positive is tensor([0.7793], device='cuda:0')
[08/24 20:11:08] fastreid.utils.events INFO:  eta: 6:27:11  epoch/iter: 12/3353  total_loss: 0.4029  loss_bank_verif: 0.4029  lr: 3.50e-04  max_mem: 3748M
[08/24 20:12:36] fastreid.utils.events INFO:  eta: 6:27:09  epoch/iter: 13/3399  total_loss: 0.7401  loss_bank_verif: 0.7401  lr: 3.50e-04  max_mem: 3748M
[08/24 20:19:04] fastreid.utils.events INFO:  eta: 6:21:16  epoch/iter: 13/3599  total_loss: 0.6278  loss_bank_verif: 0.6278  lr: 3.50e-04  max_mem: 3748M
[08/24 20:19:25] fastreid INFO: training accuracy_positive is tensor([0.9378], device='cuda:0')
[08/24 20:19:25] fastreid.utils.events INFO:  eta: 5:53:47  epoch/iter: 13/3611  total_loss: 0.5932  loss_bank_verif: 0.5932  lr: 3.50e-04  max_mem: 3748M
[08/24 20:25:29] fastreid.utils.events INFO:  eta: 6:14:29  epoch/iter: 14/3799  total_loss: 0.3394  loss_bank_verif: 0.3394  lr: 3.50e-04  max_mem: 3748M
[08/24 20:27:42] fastreid INFO: training accuracy_positive is tensor([0.9859], device='cuda:0')
[08/24 20:27:42] fastreid.utils.events INFO:  eta: 6:07:24  epoch/iter: 14/3869  total_loss: 0.3058  loss_bank_verif: 0.3058  lr: 3.50e-04  max_mem: 3748M
[08/24 21:59:15] fastreid INFO: testing accuracy_positive is tensor([0.], device='cuda:0')
[08/24 21:59:15] fastreid INFO: accuracy on test set: 99.953012 %
[08/24 21:59:15] fastreid INFO: img_correct on test set: 0 
[08/24 21:59:15] fastreid INFO: img_accuracy on test set: 0.000000 %
[08/24 22:03:25] fastreid.utils.events INFO:  eta: 5 days, 20:08:24  epoch/iter: 15/3999  total_loss: 0.2513  loss_bank_verif: 0.2513  lr: 3.50e-04  max_mem: 3748M
[08/24 22:07:30] fastreid INFO: training accuracy_positive is tensor([0.9848], device='cuda:0')
[08/24 22:07:30] fastreid.utils.events INFO:  eta: 6:00:00  epoch/iter: 15/4127  total_loss: 0.2811  loss_bank_verif: 0.2811  lr: 3.50e-04  max_mem: 3748M
[08/24 22:09:50] fastreid.utils.events INFO:  eta: 6:02:16  epoch/iter: 16/4199  total_loss: 0.281  loss_bank_verif: 0.281  lr: 3.50e-04  max_mem: 3748M
[08/24 22:15:47] fastreid INFO: training accuracy_positive is tensor([0.9909], device='cuda:0')
[08/24 22:15:47] fastreid.utils.events INFO:  eta: 5:53:26  epoch/iter: 16/4385  total_loss: 0.1906  loss_bank_verif: 0.1906  lr: 3.50e-04  max_mem: 3748M
[08/24 22:16:14] fastreid.utils.events INFO:  eta: 5:55:46  epoch/iter: 17/4399  total_loss: 0.1908  loss_bank_verif: 0.1908  lr: 3.50e-04  max_mem: 3748M
[08/24 22:22:40] fastreid.utils.events INFO:  eta: 5:47:53  epoch/iter: 17/4599  total_loss: 0.1696  loss_bank_verif: 0.1696  lr: 3.50e-04  max_mem: 3748M
[08/24 22:24:04] fastreid INFO: training accuracy_positive is tensor([0.9916], device='cuda:0')
[08/24 22:24:04] fastreid.utils.events INFO:  eta: 5:42:07  epoch/iter: 17/4643  total_loss: 0.1515  loss_bank_verif: 0.1515  lr: 3.50e-04  max_mem: 3748M
[08/24 23:55:02] fastreid INFO: testing accuracy_positive is tensor([0.], device='cuda:0')
[08/24 23:55:02] fastreid INFO: accuracy on test set: 99.954500 %
[08/24 23:55:02] fastreid INFO: img_correct on test set: 0 
[08/24 23:55:02] fastreid INFO: img_accuracy on test set: 0.000000 %
[08/25 00:00:02] fastreid.utils.events INFO:  eta: 4 days, 12:53:07  epoch/iter: 18/4799  total_loss: 0.1361  loss_bank_verif: 0.1361  lr: 3.50e-04  max_mem: 3748M
[08/25 00:03:17] fastreid INFO: training accuracy_positive is tensor([0.9942], device='cuda:0')
[08/25 00:03:17] fastreid.utils.events INFO:  eta: 5:35:15  epoch/iter: 18/4901  total_loss: 0.1298  loss_bank_verif: 0.1298  lr: 3.50e-04  max_mem: 3748M
[08/25 00:06:26] fastreid.utils.events INFO:  eta: 5:35:14  epoch/iter: 19/4999  total_loss: 0.1197  loss_bank_verif: 0.1197  lr: 3.50e-04  max_mem: 3748M
[08/25 00:11:34] fastreid INFO: training accuracy_positive is tensor([0.9926], device='cuda:0')
[08/25 00:11:34] fastreid.utils.events INFO:  eta: 5:29:22  epoch/iter: 19/5159  total_loss: 0.1221  loss_bank_verif: 0.1221  lr: 3.50e-04  max_mem: 3748M
[08/25 00:12:52] fastreid.utils.events INFO:  eta: 5:28:55  epoch/iter: 20/5199  total_loss: 0.1123  loss_bank_verif: 0.1123  lr: 3.50e-04  max_mem: 3748M
[08/25 00:19:20] fastreid.utils.events INFO:  eta: 5:24:05  epoch/iter: 20/5399  total_loss: 0.09769  loss_bank_verif: 0.09769  lr: 3.50e-04  max_mem: 3748M
[08/25 00:19:53] fastreid INFO: training accuracy_positive is tensor([0.9937], device='cuda:0')
[08/25 00:19:53] fastreid.utils.events INFO:  eta: 5:08:23  epoch/iter: 20/5417  total_loss: 0.09838  loss_bank_verif: 0.09838  lr: 3.50e-04  max_mem: 3748M
[08/25 01:51:31] fastreid INFO: testing accuracy_positive is tensor([0.], device='cuda:0')
[08/25 01:51:31] fastreid INFO: accuracy on test set: 99.967309 %
[08/25 01:51:31] fastreid INFO: img_correct on test set: 0 
[08/25 01:51:31] fastreid INFO: img_accuracy on test set: 0.000000 %
[08/25 01:57:23] fastreid.utils.events INFO:  eta: 3 days, 15:41:04  epoch/iter: 21/5599  total_loss: 0.0864  loss_bank_verif: 0.0864  lr: 3.50e-04  max_mem: 3748M
[08/25 01:59:50] fastreid INFO: training accuracy_positive is tensor([0.9950], device='cuda:0')
[08/25 01:59:50] fastreid.utils.events INFO:  eta: 5:12:33  epoch/iter: 21/5675  total_loss: 0.07601  loss_bank_verif: 0.07601  lr: 3.50e-04  max_mem: 3748M
[08/25 02:03:50] fastreid.utils.events INFO:  eta: 5:10:46  epoch/iter: 22/5799  total_loss: 0.07777  loss_bank_verif: 0.07777  lr: 3.50e-04  max_mem: 3748M
[08/25 02:08:08] fastreid INFO: training accuracy_positive is tensor([0.9648], device='cuda:0')
[08/25 02:08:08] fastreid.utils.events INFO:  eta: 5:04:27  epoch/iter: 22/5933  total_loss: 0.1526  loss_bank_verif: 0.1526  lr: 3.50e-04  max_mem: 3748M
[08/25 02:10:16] fastreid.utils.events INFO:  eta: 5:04:40  epoch/iter: 23/5999  total_loss: 0.1838  loss_bank_verif: 0.1838  lr: 3.50e-04  max_mem: 3748M
[08/25 02:16:26] fastreid INFO: training accuracy_positive is tensor([0.9877], device='cuda:0')
[08/25 02:16:26] fastreid.utils.events INFO:  eta: 4:56:21  epoch/iter: 23/6191  total_loss: 0.1187  loss_bank_verif: 0.1187  lr: 3.50e-04  max_mem: 3748M
[08/25 03:48:23] fastreid INFO: testing accuracy_positive is tensor([0.], device='cuda:0')
[08/25 03:48:23] fastreid INFO: accuracy on test set: 99.967320 %
[08/25 03:48:23] fastreid INFO: img_correct on test set: 0 
[08/25 03:48:23] fastreid INFO: img_accuracy on test set: 0.000000 %
[08/25 03:48:39] fastreid.utils.events INFO:  eta: 73 days, 19:12:36  epoch/iter: 24/6199  total_loss: 0.1188  loss_bank_verif: 0.1188  lr: 3.50e-04  max_mem: 3748M
[08/25 03:55:04] fastreid.utils.events INFO:  eta: 4:49:52  epoch/iter: 24/6399  total_loss: 0.0808  loss_bank_verif: 0.0808  lr: 3.50e-04  max_mem: 3748M
[08/25 03:56:39] fastreid INFO: training accuracy_positive is tensor([0.9934], device='cuda:0')
[08/25 03:56:39] fastreid.utils.events INFO:  eta: 4:44:02  epoch/iter: 24/6449  total_loss: 0.07935  loss_bank_verif: 0.07935  lr: 3.50e-04  max_mem: 3748M
[08/25 04:01:29] fastreid.utils.events INFO:  eta: 4:44:16  epoch/iter: 25/6599  total_loss: 0.06498  loss_bank_verif: 0.06498  lr: 3.50e-04  max_mem: 3748M
[08/25 04:04:57] fastreid INFO: training accuracy_positive is tensor([0.9936], device='cuda:0')
[08/25 04:04:57] fastreid.utils.events INFO:  eta: 4:38:31  epoch/iter: 25/6707  total_loss: 0.06463  loss_bank_verif: 0.06463  lr: 3.50e-04  max_mem: 3748M
[08/25 04:07:54] fastreid.utils.events INFO:  eta: 4:36:53  epoch/iter: 26/6799  total_loss: 0.05277  loss_bank_verif: 0.05277  lr: 3.50e-04  max_mem: 3748M
[08/25 04:13:13] fastreid INFO: training accuracy_positive is tensor([0.9954], device='cuda:0')
[08/25 04:13:13] fastreid.utils.events INFO:  eta: 4:30:50  epoch/iter: 26/6965  total_loss: 0.04267  loss_bank_verif: 0.04267  lr: 3.50e-04  max_mem: 3748M
[08/25 05:44:19] fastreid INFO: testing accuracy_positive is tensor([0.], device='cuda:0')
[08/25 05:44:19] fastreid INFO: accuracy on test set: 99.967320 %
[08/25 05:44:19] fastreid INFO: img_correct on test set: 0 
[08/25 05:44:19] fastreid INFO: img_accuracy on test set: 0.000000 %
[08/25 05:45:25] fastreid.utils.events INFO:  eta: 15 days, 20:32:19  epoch/iter: 27/6999  total_loss: 0.03906  loss_bank_verif: 0.03906  lr: 3.50e-04  max_mem: 3748M
[08/25 05:51:52] fastreid.utils.events INFO:  eta: 4:24:56  epoch/iter: 27/7199  total_loss: 0.05042  loss_bank_verif: 0.05042  lr: 3.50e-04  max_mem: 3748M
[08/25 05:52:36] fastreid INFO: training accuracy_positive is tensor([0.9926], device='cuda:0')
[08/25 05:52:36] fastreid.utils.events INFO:  eta: 4:14:50  epoch/iter: 27/7223  total_loss: 0.05157  loss_bank_verif: 0.05157  lr: 3.50e-04  max_mem: 3748M
[08/25 05:58:16] fastreid.utils.events INFO:  eta: 4:17:52  epoch/iter: 28/7399  total_loss: 0.03702  loss_bank_verif: 0.03702  lr: 3.50e-04  max_mem: 3748M
[08/25 06:00:52] fastreid INFO: training accuracy_positive is tensor([0.9955], device='cuda:0')
[08/25 06:00:52] fastreid.utils.events INFO:  eta: 4:12:18  epoch/iter: 28/7481  total_loss: 0.03822  loss_bank_verif: 0.03822  lr: 3.50e-04  max_mem: 3748M
[08/25 06:04:40] fastreid.utils.events INFO:  eta: 4:11:02  epoch/iter: 29/7599  total_loss: 0.03102  loss_bank_verif: 0.03102  lr: 3.50e-04  max_mem: 3748M
[08/25 06:09:08] fastreid INFO: training accuracy_positive is tensor([0.9972], device='cuda:0')
[08/25 06:09:08] fastreid.utils.events INFO:  eta: 4:05:33  epoch/iter: 29/7739  total_loss: 0.02796  loss_bank_verif: 0.02796  lr: 3.50e-04  max_mem: 3748M
[08/25 07:40:17] fastreid INFO: testing accuracy_positive is tensor([0.], device='cuda:0')
[08/25 07:40:17] fastreid INFO: accuracy on test set: 99.967320 %
[08/25 07:40:17] fastreid INFO: img_correct on test set: 0 
[08/25 07:40:17] fastreid INFO: img_accuracy on test set: 0.000000 %
[08/25 07:40:17] fastreid.utils.checkpoint INFO: Saving checkpoint to logs/BoT_verif_msmt17/model_0029.pth
[08/25 07:42:13] fastreid.utils.events INFO:  eta: 8 days, 5:01:22  epoch/iter: 30/7799  total_loss: 0.02321  loss_bank_verif: 0.02321  lr: 3.50e-04  max_mem: 3748M
[08/25 07:48:34] fastreid INFO: training accuracy_positive is tensor([0.9978], device='cuda:0')
[08/25 07:48:34] fastreid.utils.events INFO:  eta: 3:57:49  epoch/iter: 30/7997  total_loss: 0.02115  loss_bank_verif: 0.02115  lr: 3.50e-04  max_mem: 3748M
[08/25 07:48:38] fastreid.utils.events INFO:  eta: 4:00:58  epoch/iter: 31/7999  total_loss: 0.02121  loss_bank_verif: 0.02121  lr: 3.50e-04  max_mem: 3748M
[08/25 07:55:03] fastreid.utils.events INFO:  eta: 3:51:44  epoch/iter: 31/8199  total_loss: 0.01928  loss_bank_verif: 0.01928  lr: 3.50e-04  max_mem: 3748M
[08/25 07:56:49] fastreid INFO: training accuracy_positive is tensor([0.9964], device='cuda:0')
[08/25 07:56:49] fastreid.utils.events INFO:  eta: 3:46:30  epoch/iter: 31/8255  total_loss: 0.02252  loss_bank_verif: 0.02252  lr: 3.50e-04  max_mem: 3748M
[08/25 08:01:28] fastreid.utils.events INFO:  eta: 3:46:32  epoch/iter: 32/8399  total_loss: 0.02169  loss_bank_verif: 0.02169  lr: 3.50e-04  max_mem: 3748M
[08/25 08:05:07] fastreid INFO: training accuracy_positive is tensor([0.9974], device='cuda:0')
[08/25 08:05:07] fastreid.utils.events INFO:  eta: 3:41:06  epoch/iter: 32/8513  total_loss: 0.01913  loss_bank_verif: 0.01913  lr: 3.50e-04  max_mem: 3748M
[08/25 09:36:33] fastreid INFO: testing accuracy_positive is tensor([0.], device='cuda:0')
[08/25 09:36:33] fastreid INFO: accuracy on test set: 99.967320 %
[08/25 09:36:33] fastreid INFO: img_correct on test set: 0 
[08/25 09:36:33] fastreid INFO: img_accuracy on test set: 0.000000 %
[08/25 09:39:19] fastreid.utils.events INFO:  eta: 5 days, 4:30:37  epoch/iter: 33/8599  total_loss: 0.01513  loss_bank_verif: 0.01513  lr: 3.50e-04  max_mem: 3748M
[08/25 09:44:51] fastreid INFO: training accuracy_positive is tensor([0.9966], device='cuda:0')
[08/25 09:44:51] fastreid.utils.events INFO:  eta: 3:33:29  epoch/iter: 33/8771  total_loss: 0.02083  loss_bank_verif: 0.02083  lr: 3.50e-04  max_mem: 3748M
[08/25 09:45:45] fastreid.utils.events INFO:  eta: 3:34:00  epoch/iter: 34/8799  total_loss: 0.02274  loss_bank_verif: 0.02274  lr: 3.50e-04  max_mem: 3748M
[08/25 09:52:13] fastreid.utils.events INFO:  eta: 3:27:34  epoch/iter: 34/8999  total_loss: 0.02454  loss_bank_verif: 0.02454  lr: 3.50e-04  max_mem: 3748M
[08/25 09:53:10] fastreid INFO: training accuracy_positive is tensor([0.9947], device='cuda:0')
[08/25 09:53:10] fastreid.utils.events INFO:  eta: 3:21:52  epoch/iter: 34/9029  total_loss: 0.02521  loss_bank_verif: 0.02521  lr: 3.50e-04  max_mem: 3748M
[08/25 09:58:39] fastreid.utils.events INFO:  eta: 3:20:41  epoch/iter: 35/9199  total_loss: 0.01578  loss_bank_verif: 0.01578  lr: 3.50e-04  max_mem: 3748M
[08/25 10:01:27] fastreid INFO: training accuracy_positive is tensor([0.9977], device='cuda:0')
[08/25 10:01:27] fastreid.utils.events INFO:  eta: 3:15:31  epoch/iter: 35/9287  total_loss: 0.01465  loss_bank_verif: 0.01465  lr: 3.50e-04  max_mem: 3748M
[08/25 11:32:28] fastreid INFO: testing accuracy_positive is tensor([0.], device='cuda:0')
[08/25 11:32:28] fastreid INFO: accuracy on test set: 99.967319 %
[08/25 11:32:28] fastreid INFO: img_correct on test set: 0 
[08/25 11:32:28] fastreid INFO: img_accuracy on test set: 0.000000 %
[08/25 11:36:05] fastreid.utils.events INFO:  eta: 3 days, 12:46:33  epoch/iter: 36/9399  total_loss: 0.01266  loss_bank_verif: 0.01266  lr: 3.50e-04  max_mem: 3748M
[08/25 11:40:46] fastreid INFO: training accuracy_positive is tensor([0.9050], device='cuda:0')
[08/25 11:40:46] fastreid.utils.events INFO:  eta: 3:08:14  epoch/iter: 36/9545  total_loss: 0.3979  loss_bank_verif: 0.3979  lr: 3.50e-04  max_mem: 3748M
[08/25 11:42:30] fastreid.utils.events INFO:  eta: 3:07:24  epoch/iter: 37/9599  total_loss: 0.4485  loss_bank_verif: 0.4485  lr: 3.50e-04  max_mem: 3748M
[08/25 11:48:57] fastreid.utils.events INFO:  eta: 3:01:12  epoch/iter: 37/9799  total_loss: 0.1048  loss_bank_verif: 0.1048  lr: 3.50e-04  max_mem: 3748M
[08/25 11:49:03] fastreid INFO: training accuracy_positive is tensor([0.9860], device='cuda:0')
[08/25 11:49:03] fastreid.utils.events INFO:  eta: 2:25:23  epoch/iter: 37/9803  total_loss: 0.1029  loss_bank_verif: 0.1029  lr: 3.50e-04  max_mem: 3748M
[08/25 11:55:21] fastreid.utils.events INFO:  eta: 2:54:09  epoch/iter: 38/9999  total_loss: 0.07732  loss_bank_verif: 0.07732  lr: 3.50e-04  max_mem: 3748M
[08/25 11:57:20] fastreid INFO: training accuracy_positive is tensor([0.9892], device='cuda:0')
[08/25 11:57:20] fastreid.utils.events INFO:  eta: 2:50:16  epoch/iter: 38/10061  total_loss: 0.07411  loss_bank_verif: 0.07411  lr: 3.50e-04  max_mem: 3748M
[08/25 13:28:06] fastreid INFO: testing accuracy_positive is tensor([0.], device='cuda:0')
[08/25 13:28:06] fastreid INFO: accuracy on test set: 99.967320 %
[08/25 13:28:06] fastreid INFO: img_correct on test set: 0 
[08/25 13:28:06] fastreid INFO: img_accuracy on test set: 0.000000 %
[08/25 13:32:32] fastreid.utils.events INFO:  eta: 2 days, 12:01:13  epoch/iter: 39/10199  total_loss: 0.05069  loss_bank_verif: 0.05069  lr: 3.50e-04  max_mem: 3748M
[08/25 13:36:22] fastreid INFO: training accuracy_positive is tensor([0.9905], device='cuda:0')
[08/25 13:36:22] fastreid.utils.events INFO:  eta: 2:42:49  epoch/iter: 39/10319  total_loss: 0.05059  loss_bank_verif: 0.05059  lr: 3.50e-04  max_mem: 3748M
[08/25 13:38:56] fastreid.utils.events INFO:  eta: 2:41:34  epoch/iter: 40/10399  total_loss: 0.03945  loss_bank_verif: 0.03945  lr: 3.50e-04  max_mem: 3748M
[08/25 13:44:41] fastreid INFO: training accuracy_positive is tensor([0.9940], device='cuda:0')
[08/25 13:44:41] fastreid.utils.events INFO:  eta: 2:36:13  epoch/iter: 40/10577  total_loss: 0.02608  loss_bank_verif: 0.02608  lr: 3.50e-04  max_mem: 3748M
[08/25 13:45:27] fastreid.utils.events INFO:  eta: 2:47:40  epoch/iter: 41/10599  total_loss: 0.0256  loss_bank_verif: 0.0256  lr: 3.50e-04  max_mem: 3748M
[08/25 13:52:33] fastreid.utils.events INFO:  eta: 2:44:04  epoch/iter: 41/10799  total_loss: 0.04396  loss_bank_verif: 0.04396  lr: 3.50e-04  max_mem: 3748M
[08/25 13:53:48] fastreid INFO: training accuracy_positive is tensor([0.9791], device='cuda:0')
[08/25 13:53:48] fastreid.utils.events INFO:  eta: 2:39:20  epoch/iter: 41/10835  total_loss: 0.06453  loss_bank_verif: 0.06453  lr: 3.50e-04  max_mem: 3748M
[08/25 15:33:25] fastreid INFO: testing accuracy_positive is tensor([0.], device='cuda:0')
[08/25 15:33:25] fastreid INFO: accuracy on test set: 99.967320 %
[08/25 15:33:25] fastreid INFO: img_correct on test set: 0 
[08/25 15:33:25] fastreid INFO: img_accuracy on test set: 0.000000 %
[08/25 15:38:51] fastreid.utils.events INFO:  eta: 1 day, 23:11:27  epoch/iter: 42/10999  total_loss: 0.07477  loss_bank_verif: 0.07477  lr: 3.50e-04  max_mem: 3748M
[08/25 15:41:54] fastreid INFO: training accuracy_positive is tensor([0.9897], device='cuda:0')
[08/25 15:41:54] fastreid.utils.events INFO:  eta: 2:19:57  epoch/iter: 42/11093  total_loss: 0.05169  loss_bank_verif: 0.05169  lr: 3.50e-04  max_mem: 3748M
[08/25 15:45:22] fastreid.utils.events INFO:  eta: 2:18:15  epoch/iter: 43/11199  total_loss: 0.03753  loss_bank_verif: 0.03753  lr: 3.50e-04  max_mem: 3748M
[08/25 15:50:27] fastreid INFO: training accuracy_positive is tensor([0.9926], device='cuda:0')
[08/25 15:50:27] fastreid.utils.events INFO:  eta: 2:15:44  epoch/iter: 43/11351  total_loss: 0.03299  loss_bank_verif: 0.03299  lr: 3.50e-04  max_mem: 3748M
[08/25 15:52:03] fastreid.utils.events INFO:  eta: 2:14:09  epoch/iter: 44/11399  total_loss: 0.02801  loss_bank_verif: 0.02801  lr: 3.50e-04  max_mem: 3748M
[08/25 15:58:39] fastreid.utils.events INFO:  eta: 2:06:17  epoch/iter: 44/11599  total_loss: 0.02594  loss_bank_verif: 0.02594  lr: 3.50e-04  max_mem: 3748M
[08/25 15:58:59] fastreid INFO: training accuracy_positive is tensor([0.9950], device='cuda:0')
[08/25 15:58:59] fastreid.utils.events INFO:  eta: 2:01:37  epoch/iter: 44/11609  total_loss: 0.02614  loss_bank_verif: 0.02614  lr: 3.50e-04  max_mem: 3748M
[08/25 17:31:25] fastreid INFO: testing accuracy_positive is tensor([0.], device='cuda:0')
[08/25 17:31:25] fastreid INFO: accuracy on test set: 99.967320 %
[08/25 17:31:25] fastreid INFO: img_correct on test set: 0 
[08/25 17:31:25] fastreid INFO: img_accuracy on test set: 0.000000 %
[08/25 17:37:34] fastreid.utils.events INFO:  eta: 1 day, 7:18:33  epoch/iter: 45/11799  total_loss: 0.0256  loss_bank_verif: 0.0256  lr: 3.50e-04  max_mem: 3748M
[08/25 17:39:46] fastreid INFO: training accuracy_positive is tensor([0.9934], device='cuda:0')
[08/25 17:39:46] fastreid.utils.events INFO:  eta: 1:54:25  epoch/iter: 45/11867  total_loss: 0.01762  loss_bank_verif: 0.01762  lr: 3.50e-04  max_mem: 3748M
[08/25 17:44:02] fastreid.utils.events INFO:  eta: 1:50:29  epoch/iter: 46/11999  total_loss: 0.01228  loss_bank_verif: 0.01228  lr: 3.50e-04  max_mem: 3748M
[08/25 17:48:05] fastreid INFO: training accuracy_positive is tensor([0.9972], device='cuda:0')
[08/25 17:48:05] fastreid.utils.events INFO:  eta: 1:45:45  epoch/iter: 46/12125  total_loss: 0.01016  loss_bank_verif: 0.01016  lr: 3.50e-04  max_mem: 3748M
[08/25 17:50:28] fastreid.utils.events INFO:  eta: 1:44:16  epoch/iter: 47/12199  total_loss: 0.007695  loss_bank_verif: 0.007695  lr: 3.50e-05  max_mem: 3748M
[08/25 17:56:24] fastreid INFO: training accuracy_positive is tensor([0.9985], device='cuda:0')
[08/25 17:56:24] fastreid.utils.events INFO:  eta: 1:37:47  epoch/iter: 47/12383  total_loss: 0.006568  loss_bank_verif: 0.006568  lr: 3.50e-05  max_mem: 3748M
[08/25 19:29:36] fastreid INFO: testing accuracy_positive is tensor([0.], device='cuda:0')
[08/25 19:29:36] fastreid INFO: accuracy on test set: 99.967320 %
[08/25 19:29:36] fastreid INFO: img_correct on test set: 0 
[08/25 19:29:36] fastreid INFO: img_accuracy on test set: 0.000000 %
[08/25 19:30:07] fastreid.utils.events INFO:  eta: 12 days, 6:48:43  epoch/iter: 48/12399  total_loss: 0.006778  loss_bank_verif: 0.006778  lr: 3.50e-05  max_mem: 3748M
[08/25 19:36:34] fastreid.utils.events INFO:  eta: 1:31:03  epoch/iter: 48/12599  total_loss: 0.006897  loss_bank_verif: 0.006897  lr: 3.50e-05  max_mem: 3748M
[08/25 19:37:54] fastreid INFO: training accuracy_positive is tensor([0.9983], device='cuda:0')
[08/25 19:37:54] fastreid.utils.events INFO:  eta: 1:28:05  epoch/iter: 48/12641  total_loss: 0.006689  loss_bank_verif: 0.006689  lr: 3.50e-05  max_mem: 3748M
[08/25 19:42:59] fastreid.utils.events INFO:  eta: 1:24:19  epoch/iter: 49/12799  total_loss: 0.00504  loss_bank_verif: 0.00504  lr: 3.50e-05  max_mem: 3748M
[08/25 19:46:11] fastreid INFO: training accuracy_positive is tensor([0.9979], device='cuda:0')
[08/25 19:46:11] fastreid.utils.events INFO:  eta: 1:20:31  epoch/iter: 49/12899  total_loss: 0.005847  loss_bank_verif: 0.005847  lr: 3.50e-05  max_mem: 3748M
[08/25 19:49:25] fastreid.utils.events INFO:  eta: 1:18:14  epoch/iter: 50/12999  total_loss: 0.007056  loss_bank_verif: 0.007056  lr: 3.50e-05  max_mem: 3748M
[08/25 19:54:30] fastreid INFO: training accuracy_positive is tensor([0.9987], device='cuda:0')
[08/25 19:54:30] fastreid.utils.events INFO:  eta: 1:12:39  epoch/iter: 50/13157  total_loss: 0.006747  loss_bank_verif: 0.006747  lr: 3.50e-05  max_mem: 3748M
[08/25 21:26:36] fastreid INFO: testing accuracy_positive is tensor([0.], device='cuda:0')
[08/25 21:26:36] fastreid INFO: accuracy on test set: 99.967320 %
[08/25 21:26:36] fastreid INFO: img_correct on test set: 0 
[08/25 21:26:36] fastreid INFO: img_accuracy on test set: 0.000000 %
[08/25 21:27:57] fastreid.utils.events INFO:  eta: 3 days, 10:20:13  epoch/iter: 51/13199  total_loss: 0.006778  loss_bank_verif: 0.006778  lr: 3.50e-05  max_mem: 3748M
[08/25 21:34:25] fastreid.utils.events INFO:  eta: 1:05:09  epoch/iter: 51/13399  total_loss: 0.007694  loss_bank_verif: 0.007694  lr: 3.50e-05  max_mem: 3748M
[08/25 21:34:54] fastreid INFO: training accuracy_positive is tensor([0.9985], device='cuda:0')
[08/25 21:34:54] fastreid.utils.events INFO:  eta: 1:01:29  epoch/iter: 51/13415  total_loss: 0.007653  loss_bank_verif: 0.007653  lr: 3.50e-05  max_mem: 3748M
[08/25 21:40:59] fastreid.utils.events INFO:  eta: 1:00:06  epoch/iter: 52/13599  total_loss: 0.006014  loss_bank_verif: 0.006014  lr: 3.50e-05  max_mem: 3748M
[08/25 21:43:23] fastreid INFO: training accuracy_positive is tensor([0.9988], device='cuda:0')
[08/25 21:43:23] fastreid.utils.events INFO:  eta: 0:56:46  epoch/iter: 52/13673  total_loss: 0.006705  loss_bank_verif: 0.006705  lr: 3.50e-05  max_mem: 3748M
[08/25 21:47:36] fastreid.utils.events INFO:  eta: 0:54:10  epoch/iter: 53/13799  total_loss: 0.006281  loss_bank_verif: 0.006281  lr: 3.50e-05  max_mem: 3748M
[08/25 21:51:57] fastreid INFO: training accuracy_positive is tensor([0.9990], device='cuda:0')
[08/25 21:51:57] fastreid.utils.events INFO:  eta: 0:49:01  epoch/iter: 53/13931  total_loss: 0.005698  loss_bank_verif: 0.005698  lr: 3.50e-05  max_mem: 3748M
[08/25 23:28:13] fastreid INFO: testing accuracy_positive is tensor([0.], device='cuda:0')
[08/25 23:28:13] fastreid INFO: accuracy on test set: 99.967320 %
[08/25 23:28:13] fastreid INFO: img_correct on test set: 0 
[08/25 23:28:13] fastreid INFO: img_accuracy on test set: 0.000000 %
[08/25 23:30:26] fastreid.utils.events INFO:  eta: 1 day, 10:16:30  epoch/iter: 54/13999  total_loss: 0.004405  loss_bank_verif: 0.004405  lr: 3.50e-05  max_mem: 3748M
[08/25 23:37:59] fastreid INFO: training accuracy_positive is tensor([0.9989], device='cuda:0')
[08/25 23:37:59] fastreid.utils.events INFO:  eta: 0:48:54  epoch/iter: 54/14189  total_loss: 0.006923  loss_bank_verif: 0.006923  lr: 3.50e-05  max_mem: 3748M
[08/25 23:38:19] fastreid.utils.events INFO:  eta: 0:40:13  epoch/iter: 55/14199  total_loss: 0.006892  loss_bank_verif: 0.006892  lr: 3.50e-05  max_mem: 3748M
[08/25 23:44:51] fastreid.utils.events INFO:  eta: 0:33:18  epoch/iter: 55/14399  total_loss: 0.004766  loss_bank_verif: 0.004766  lr: 3.50e-05  max_mem: 3748M
[08/25 23:46:22] fastreid INFO: training accuracy_positive is tensor([0.9989], device='cuda:0')
[08/25 23:46:22] fastreid.utils.events INFO:  eta: 0:30:45  epoch/iter: 55/14447  total_loss: 0.005313  loss_bank_verif: 0.005313  lr: 3.50e-05  max_mem: 3748M
[08/25 23:51:15] fastreid.utils.events INFO:  eta: 0:26:22  epoch/iter: 56/14599  total_loss: 0.006674  loss_bank_verif: 0.006674  lr: 3.50e-05  max_mem: 3748M
[08/25 23:54:38] fastreid INFO: training accuracy_positive is tensor([0.9990], device='cuda:0')
[08/25 23:54:38] fastreid.utils.events INFO:  eta: 0:22:49  epoch/iter: 56/14705  total_loss: 0.005807  loss_bank_verif: 0.005807  lr: 3.50e-05  max_mem: 3748M
[08/26 01:26:21] fastreid INFO: testing accuracy_positive is tensor([0.], device='cuda:0')
[08/26 01:26:21] fastreid INFO: accuracy on test set: 99.967320 %
[08/26 01:26:21] fastreid INFO: img_correct on test set: 0 
[08/26 01:26:21] fastreid INFO: img_accuracy on test set: 0.000000 %
[08/26 01:29:22] fastreid.utils.events INFO:  eta: 10:24:50  epoch/iter: 57/14799  total_loss: 0.003624  loss_bank_verif: 0.003624  lr: 3.50e-05  max_mem: 3748M
[08/26 01:34:37] fastreid INFO: training accuracy_positive is tensor([0.9990], device='cuda:0')
[08/26 01:34:37] fastreid.utils.events INFO:  eta: 0:14:35  epoch/iter: 57/14963  total_loss: 0.003909  loss_bank_verif: 0.003909  lr: 3.50e-05  max_mem: 3748M
[08/26 01:35:47] fastreid.utils.events INFO:  eta: 0:13:28  epoch/iter: 58/14999  total_loss: 0.004384  loss_bank_verif: 0.004384  lr: 3.50e-05  max_mem: 3748M
[08/26 01:42:13] fastreid.utils.events INFO:  eta: 0:07:05  epoch/iter: 58/15199  total_loss: 0.005212  loss_bank_verif: 0.005212  lr: 3.50e-05  max_mem: 3748M
[08/26 01:42:54] fastreid INFO: training accuracy_positive is tensor([0.9988], device='cuda:0')
[08/26 01:42:54] fastreid.utils.events INFO:  eta: 0:06:07  epoch/iter: 58/15221  total_loss: 0.005186  loss_bank_verif: 0.005186  lr: 3.50e-05  max_mem: 3748M
[08/26 01:48:39] fastreid.utils.events INFO:  eta: 0:00:38  epoch/iter: 59/15399  total_loss: 0.004917  loss_bank_verif: 0.004917  lr: 3.50e-05  max_mem: 3748M
[08/26 01:51:12] fastreid INFO: training accuracy_positive is tensor([0.9985], device='cuda:0')
[08/26 01:51:12] fastreid.utils.events INFO:  eta: -1 day, 23:58:06  epoch/iter: 59/15479  total_loss: 0.005266  loss_bank_verif: 0.005266  lr: 3.50e-05  max_mem: 3748M
[08/26 03:22:26] fastreid INFO: testing accuracy_positive is tensor([0.], device='cuda:0')
[08/26 03:22:26] fastreid INFO: accuracy on test set: 99.967320 %
[08/26 03:22:26] fastreid INFO: img_correct on test set: 0 
[08/26 03:22:26] fastreid INFO: img_accuracy on test set: 0.000000 %
[08/26 03:22:26] fastreid.utils.checkpoint INFO: Saving checkpoint to logs/BoT_verif_msmt17/model_final.pth
[09/11 20:03:39] fastreid INFO: Rank of current process: 0. World size: 1
[09/11 20:03:45] fastreid INFO: Environment info:
----------------------  ------------------------------------------------------------------------------------
sys.platform            linux
Python                  3.7.9 (default, Aug 31 2020, 12:42:55) [GCC 7.3.0]
numpy                   1.19.2
fastreid                1.3 @./fastreid
FASTREID_ENV_MODULE     <not set>
PyTorch                 1.6.0 @/home/huangju/anaconda3/envs/fastreid/lib/python3.7/site-packages/torch
PyTorch debug build     False
GPU available           True
GPU 0                   NVIDIA GeForce RTX 2080 Ti
CUDA_HOME               /usr/local/cuda
Pillow                  8.1.0
torchvision             0.7.0 @/home/huangju/anaconda3/envs/fastreid/lib/python3.7/site-packages/torchvision
torchvision arch flags  sm_35, sm_50, sm_60, sm_70, sm_75
cv2                     3.4.2
----------------------  ------------------------------------------------------------------------------------
PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) Math Kernel Library Version 2020.0.2 Product Build 20200624 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v1.5.0 (Git Hash e2ac1fac44c5078ca927cb9b90e1b3066a0b2ed0)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 10.2
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_37,code=compute_37
  - CuDNN 7.6.5
  - Magma 2.5.2
  - Build settings: BLAS=MKL, BUILD_TYPE=Release, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DUSE_VULKAN_WRAPPER -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, USE_CUDA=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_STATIC_DISPATCH=OFF, 

[09/11 20:03:45] fastreid INFO: Command line arguments: Namespace(config_file='./configs/BOT-verif-msmt17.yml', dist_url='tcp://127.0.0.1:50190', eval_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=[], resume=False)
[09/11 20:03:45] fastreid INFO: Contents of args.config_file=./configs/BOT-verif-msmt17.yml:
_BASE_: "./Base-bagtricks.yml"
MODEL:
  META_ARCHITECTURE: "BaselineVerifMemBank"

  BACKBONE:
    NAME: "build_resnet_backbone"
  LOSSES:
    NAME: ("VerificationLoss")

TEST:
  EVAL_PERIOD: 3

DATASETS:
  NAMES: ("Market1501",)
  TESTS: ("Market1501",)

DATALOADER:
  PK_SAMPLER: True
  NAIVE_WAY: True
  PERSON_NUMBER: 1041
  PERSON_NUMBER_TEST: 3060
OUTPUT_DIR: "logs/BoT_verif_msmt17"
[09/11 20:03:45] fastreid INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  NAIVE_WAY: True
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  PERSON_NUMBER: 1041
  PERSON_NUMBER_TEST: 3060
  PK_SAMPLER: True
  SEQ_LEN: 8
  TEST_SEQ_LEN: 0
DATASETS:
  COMBINEALL: False
  NAMES: ('Market1501',)
  TESTS: ('Market1501',)
INPUT:
  AUGMIX_PROB: 0.0
  AUTOAUG_PROB: 0.0
  CJ:
    BRIGHTNESS: 0.15
    CONTRAST: 0.15
    ENABLED: False
    HUE: 0.1
    PROB: 0.5
    SATURATION: 0.1
  DO_AUGMIX: False
  DO_AUTOAUG: False
  DO_FLIP: True
  DO_PAD: True
  DO_RANDAUG: False
  FLIP_PROB: 0.5
  MIX_TRACKLET: False
  PADDING: 10
  PADDING_MODE: constant
  RANDAUG_PROB: 0.5
  RANDAUG_STR: rand-m9-mstd0.5
  REA:
    ENABLED: True
    PROB: 0.5
    VALUE: [151.98, 142.29000000000002, 126.735]
  RPT:
    ENABLED: False
    PROB: 0.5
  SIZE_TEST: [256, 128]
  SIZE_TRAIN: [256, 128]
MODEL:
  BACKBONE:
    DEPTH: 50x
    FEAT_DIM: 2560
    LAST_STRIDE: 1
    NAME: build_resnet_backbone
    NORM: BN
    PRETRAIN: True
    PRETRAIN_PATH: 
    REMOVE: (3, 4)
    WITH_IBN: False
    WITH_NL: False
    WITH_SE: False
  DEVICE: cuda
  FREEZE_LAYERS: ['']
  HEADS:
    CLS_LAYER: linear
    EMBEDDING_DIM: 0
    HASH_LAYER_DIMS: []
    HASH_LAYER_NUM: 1
    MARGIN: 0.15
    NAME: EmbeddingHead
    NECK_FEAT: before
    NORM: BN
    NUM_CLASSES: 0
    POOL_LAYER: avgpool
    SCALE: 128
    TEMP: 1.0
    WITH_BNNECK: True
  LOSSES:
    CE:
      ALPHA: 0.2
      EPSILON: 0.1
      SCALE: 1.0
    CIRCLE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    COSFACE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    FL:
      ALPHA: 0.25
      GAMMA: 2
      SCALE: 1.0
    NAME: VerificationLoss
    TRI:
      HARD_MINING: True
      MARGIN: 0.3
      NORM_FEAT: False
      SCALE: 1.0
  META_ARCHITECTURE: BaselineVerifMemBank
  PIXEL_MEAN: [123.675, 116.28, 103.53]
  PIXEL_STD: [58.395, 57.120000000000005, 57.375]
  TRANSFORMER:
    DEPTH: 12
    EMBED_DIM: 768
    ENABLE_POS: False
    FEATURE_DIM: 2048
    INPUT_SIZE: (512, 64, 32)
    NAME: TransformerHead
    NUM_HEADS: 3
    PART_H: 4
    PART_STR: ('4x1',)
    PART_V: 1
    PATH_DROP: 0.1
    POS_DROP: 0.0
  TRANSFORMER_S:
    ATTN_DROP: 0.0
    CE_SCALE: 1.0
    DEPTH: 12
    EMBED_DIM: 768
    ENABLE_POS: False
    FEATURE_DIM: 2048
    GAP: False
    INPUT_SIZE: (512, 64, 32)
    LOCAL_PART: 4
    NAME: SpatialTransformerHead
    NUM_HEADS: 3
    PART_STR: 8x4
    PATH_DROP: 0.1
    POS_DROP: 0.0
    RET_ALL: False
  TRANSFORMER_T:
    ATTN_DROP: 0.0
    DEPTH: 12
    EMBED_DIM: 768
    ENABLE_POS: False
    GAP: False
    NAME: TemporalTransformerHead
    NUM_HEADS: 3
    PATH_DROP: 0.1
    POS_DROP: 0.0
    RET_ALL: False
    RET_ATTN: False
  WEIGHTS: 
OUTPUT_DIR: logs/BoT_verif_msmt17
SOLVER:
  BASE_LR: 0.00035
  BIAS_LR_FACTOR: 2.0
  CHECKPOINT_PERIOD: 30
  CLIP_GRADIENTS:
    CLIP_TYPE: norm
    CLIP_VALUE: 5.0
    ENABLED: False
    NORM_TYPE: 2.0
  DELAY_EPOCHS: 0
  ETA_MIN_LR: 1e-07
  FP16_ENABLED: True
  FREEZE_FC_ITERS: 0
  FREEZE_ITERS: 0
  GAMMA: 0.1
  HEADS_LR_FACTOR: 1.0
  IMS_PER_BATCH: 32
  MAX_EPOCH: 60
  MOMENTUM: 0.9
  OPT: Adam
  SCHED: MultiStepLR
  STEPS: [40, 90]
  TRANS_LR_FACTOR: 1.0
  WARMUP_FACTOR: 0.1
  WARMUP_ITERS: 2000
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0005
  WEIGHT_DECAY_BIAS: 0.0005
  WEIGHT_DECAY_NORM: 0.0005
  WEIGHT_DECAY_TRANS: 0.0005
TEST:
  AQE:
    ALPHA: 3.0
    ENABLED: False
    QE_K: 5
    QE_TIME: 1
  ERASE_NUM: 64
  EVAL_PERIOD: 3
  FLIP_ENABLED: False
  HASH_RATE: 0.3
  IMS_PER_BATCH: 128
  METRIC: cosine
  NEIGHBOR_RANGE: 100
  PRECISE_BN:
    DATASET: Market1501
    ENABLED: False
    NUM_ITER: 300
  RERANK:
    ENABLED: False
    K1: 20
    K2: 6
    LAMBDA: 0.3
  ROC_ENABLED: False
  SEQ_TEST: False
  TIMES: 1
  VERIF: False
[09/11 20:03:45] fastreid INFO: Full config saved to /home/huangju/codes/fast-reid/logs/BoT_verif_msmt17/config.yaml
[09/11 20:03:45] fastreid.utils.env INFO: Using a generated random seed 45655327
[09/11 20:03:55] fastreid INFO: Model:
BaselineVerifMemBank(
  (heads): EmbeddingHead(
    (pool_layer): AdaptiveAvgPool2d(output_size=1)
    (bottleneck): Sequential(
      (0): BatchNorm(2560, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (classifier): Linear(in_features=2560, out_features=0, bias=False)
  )
  (verif_model): VerifHead(
    (pool_layer): AdaptiveAvgPool2d(output_size=1)
    (bottleneck): Sequential(
      (0): Conv2d(2560, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
    )
    (classifier): Sequential(
      (0): Linear(in_features=1024, out_features=512, bias=True)
      (1): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): Dropout(p=0.2, inplace=False)
      (3): PReLU(num_parameters=1)
      (4): Linear(in_features=512, out_features=256, bias=True)
      (5): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (6): PReLU(num_parameters=1)
      (7): Linear(in_features=256, out_features=128, bias=True)
      (8): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (9): PReLU(num_parameters=1)
      (10): Linear(in_features=128, out_features=64, bias=True)
      (11): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (12): PReLU(num_parameters=1)
      (13): Linear(in_features=64, out_features=32, bias=True)
      (14): BatchNorm1d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (15): PReLU(num_parameters=1)
      (16): Linear(in_features=32, out_features=16, bias=True)
      (17): BatchNorm1d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (18): PReLU(num_parameters=1)
      (19): Linear(in_features=16, out_features=2, bias=False)
    )
    (drop): Dropout(p=0.5, inplace=False)
  )
)
[09/11 20:03:59] fastreid.utils.checkpoint INFO: No checkpoint found. Training model from scratch
[09/11 20:03:59] fastreid INFO: Start training from epoch 0
[09/11 20:05:51] fastreid.utils.events INFO:  epoch/iter: 0/199  total_loss: 0.5792  loss_bank_verif: 0.5792  lr: 6.63e-05  max_mem: 6004M
[09/11 20:06:22] fastreid INFO: training accuracy_positive is tensor([0.9812], device='cuda:0')
[09/11 20:06:22] fastreid.utils.events INFO:  eta: 2:15:28  epoch/iter: 0/257  total_loss: 0.509  loss_bank_verif: 0.509  lr: 7.55e-05  max_mem: 6004M
[09/11 20:07:39] fastreid.utils.events INFO:  eta: 2:15:41  epoch/iter: 1/399  total_loss: 0.3326  loss_bank_verif: 0.3326  lr: 9.78e-05  max_mem: 6004M
[09/11 20:08:41] fastreid INFO: training accuracy_positive is tensor([0.9999], device='cuda:0')
[09/11 20:08:41] fastreid.utils.events INFO:  eta: 2:13:27  epoch/iter: 1/515  total_loss: 0.2188  loss_bank_verif: 0.2188  lr: 1.16e-04  max_mem: 6004M
[09/11 20:09:27] fastreid.utils.events INFO:  eta: 2:13:38  epoch/iter: 2/599  total_loss: 0.1571  loss_bank_verif: 0.1571  lr: 1.29e-04  max_mem: 6004M
[09/11 20:11:00] fastreid INFO: training accuracy_positive is tensor([1.], device='cuda:0')
[09/11 20:11:00] fastreid.utils.events INFO:  eta: 2:11:26  epoch/iter: 2/773  total_loss: 0.08048  loss_bank_verif: 0.08048  lr: 1.57e-04  max_mem: 6004M
[09/11 22:14:55] fastreid INFO: testing accuracy_positive is tensor([1.], device='cuda:0')
[09/11 22:14:55] fastreid INFO: accuracy on test set: 0.032680 %
[09/11 22:14:55] fastreid INFO: img_correct on test set: 23512 
[09/11 22:14:55] fastreid INFO: img_accuracy on test set: 100.000000 %
[09/11 22:15:12] fastreid.utils.events INFO:  eta: 48 days, 11:55:16  epoch/iter: 3/799  total_loss: 0.07467  loss_bank_verif: 0.07467  lr: 1.61e-04  max_mem: 6004M
[09/11 22:17:35] fastreid.utils.events INFO:  eta: 2:51:23  epoch/iter: 3/999  total_loss: 0.03006  loss_bank_verif: 0.03006  lr: 1.92e-04  max_mem: 6004M
[09/11 22:17:55] fastreid INFO: training accuracy_positive is tensor([1.], device='cuda:0')
[09/11 22:17:55] fastreid.utils.events INFO:  eta: 2:31:43  epoch/iter: 3/1031  total_loss: 0.02679  loss_bank_verif: 0.02679  lr: 1.97e-04  max_mem: 6004M
[09/11 22:19:51] fastreid.utils.events INFO:  eta: 2:43:11  epoch/iter: 4/1199  total_loss: 0.01554  loss_bank_verif: 0.01554  lr: 2.24e-04  max_mem: 6004M
[09/11 22:20:54] fastreid INFO: training accuracy_positive is tensor([1.], device='cuda:0')
[09/11 22:20:54] fastreid.utils.events INFO:  eta: 2:44:53  epoch/iter: 4/1289  total_loss: 0.0116  loss_bank_verif: 0.0116  lr: 2.38e-04  max_mem: 6004M
[09/11 22:22:08] fastreid.utils.events INFO:  eta: 2:37:39  epoch/iter: 5/1399  total_loss: 0.008198  loss_bank_verif: 0.008198  lr: 2.55e-04  max_mem: 6004M
[09/11 22:23:48] fastreid INFO: training accuracy_positive is tensor([1.], device='cuda:0')
[09/11 22:23:48] fastreid.utils.events INFO:  eta: 2:35:39  epoch/iter: 5/1547  total_loss: 0.005787  loss_bank_verif: 0.005787  lr: 2.79e-04  max_mem: 6004M
[09/12 00:46:58] fastreid INFO: testing accuracy_positive is tensor([1.], device='cuda:0')
[09/12 00:46:58] fastreid INFO: accuracy on test set: 0.032680 %
[09/12 00:46:58] fastreid INFO: img_correct on test set: 23512 
[09/12 00:46:58] fastreid INFO: img_accuracy on test set: 100.000000 %
[09/12 00:47:32] fastreid.utils.events INFO:  eta: 26 days, 12:43:37  epoch/iter: 6/1599  total_loss: 0.005061  loss_bank_verif: 0.005061  lr: 2.87e-04  max_mem: 6004M
[09/12 00:49:48] fastreid.utils.events INFO:  eta: 2:33:51  epoch/iter: 6/1799  total_loss: 0.00348  loss_bank_verif: 0.00348  lr: 3.18e-04  max_mem: 6004M
[09/12 00:49:52] fastreid INFO: training accuracy_positive is tensor([1.], device='cuda:0')
[09/12 00:49:52] fastreid.utils.events INFO:  eta: 2:25:09  epoch/iter: 6/1805  total_loss: 0.003459  loss_bank_verif: 0.003459  lr: 3.19e-04  max_mem: 6004M
[09/12 00:52:06] fastreid.utils.events INFO:  eta: 2:34:52  epoch/iter: 7/1999  total_loss: 0.002303  loss_bank_verif: 0.002303  lr: 3.50e-04  max_mem: 6004M
[09/12 00:52:48] fastreid INFO: training accuracy_positive is tensor([1.], device='cuda:0')
[09/12 00:52:48] fastreid.utils.events INFO:  eta: 2:23:57  epoch/iter: 7/2063  total_loss: 0.001999  loss_bank_verif: 0.001999  lr: 3.50e-04  max_mem: 6004M
[09/12 00:54:21] fastreid.utils.events INFO:  eta: 2:30:53  epoch/iter: 8/2199  total_loss: 0.001553  loss_bank_verif: 0.001553  lr: 3.50e-04  max_mem: 6004M
[09/12 00:55:44] fastreid INFO: training accuracy_positive is tensor([1.], device='cuda:0')
[09/12 00:55:44] fastreid.utils.events INFO:  eta: 2:28:34  epoch/iter: 8/2321  total_loss: 0.001276  loss_bank_verif: 0.001276  lr: 3.50e-04  max_mem: 6004M
[09/12 03:16:29] fastreid INFO: testing accuracy_positive is tensor([1.], device='cuda:0')
[09/12 03:16:29] fastreid INFO: accuracy on test set: 0.032680 %
[09/12 03:16:29] fastreid INFO: img_correct on test set: 23512 
[09/12 03:16:29] fastreid INFO: img_accuracy on test set: 100.000000 %
[09/12 03:17:23] fastreid.utils.events INFO:  eta: 16 days, 10:06:30  epoch/iter: 9/2399  total_loss: 0.001163  loss_bank_verif: 0.001163  lr: 3.50e-04  max_mem: 6004M
[09/12 03:19:23] fastreid INFO: training accuracy_positive is tensor([1.], device='cuda:0')
[09/12 03:19:23] fastreid.utils.events INFO:  eta: 2:22:22  epoch/iter: 9/2579  total_loss: 0.000941  loss_bank_verif: 0.000941  lr: 3.50e-04  max_mem: 6004M
[09/12 03:19:36] fastreid.utils.events INFO:  eta: 2:21:22  epoch/iter: 10/2599  total_loss: 0.000929  loss_bank_verif: 0.000929  lr: 3.50e-04  max_mem: 6004M
[09/12 03:21:41] fastreid.utils.events INFO:  eta: 2:11:31  epoch/iter: 10/2799  total_loss: 0.0007785  loss_bank_verif: 0.0007785  lr: 3.50e-04  max_mem: 6004M
[09/12 03:22:04] fastreid INFO: training accuracy_positive is tensor([1.], device='cuda:0')
[09/12 03:22:04] fastreid.utils.events INFO:  eta: 2:02:45  epoch/iter: 10/2837  total_loss: 0.0007467  loss_bank_verif: 0.0007467  lr: 3.50e-04  max_mem: 6004M
[09/12 03:23:45] fastreid.utils.events INFO:  eta: 2:09:37  epoch/iter: 11/2999  total_loss: 0.000653  loss_bank_verif: 0.000653  lr: 3.50e-04  max_mem: 6004M
[09/12 03:24:48] fastreid INFO: training accuracy_positive is tensor([1.], device='cuda:0')
[09/12 03:24:48] fastreid.utils.events INFO:  eta: 2:13:33  epoch/iter: 11/3095  total_loss: 0.0006062  loss_bank_verif: 0.0006062  lr: 3.50e-04  max_mem: 6004M
[09/12 05:22:08] fastreid INFO: testing accuracy_positive is tensor([0.2230], device='cuda:0')
[09/12 05:22:08] fastreid INFO: accuracy on test set: 90.565391 %
[09/12 05:22:08] fastreid INFO: img_correct on test set: 5244 
[09/12 05:22:08] fastreid INFO: img_accuracy on test set: 22.303505 %
[09/12 05:23:18] fastreid.utils.events INFO:  eta: 9 days, 16:04:29  epoch/iter: 12/3199  total_loss: 0.0005644  loss_bank_verif: 0.0005644  lr: 3.50e-04  max_mem: 6004M
[09/12 05:25:01] fastreid INFO: training accuracy_positive is tensor([1.], device='cuda:0')
[09/12 05:25:01] fastreid.utils.events INFO:  eta: 2:14:23  epoch/iter: 12/3353  total_loss: 0.0005128  loss_bank_verif: 0.0005128  lr: 3.50e-04  max_mem: 6004M
[09/12 05:25:31] fastreid.utils.events INFO:  eta: 2:13:23  epoch/iter: 13/3399  total_loss: 0.0004983  loss_bank_verif: 0.0004983  lr: 3.50e-04  max_mem: 6004M
[09/12 05:27:45] fastreid.utils.events INFO:  eta: 2:11:14  epoch/iter: 13/3599  total_loss: 0.0004407  loss_bank_verif: 0.0004407  lr: 3.50e-04  max_mem: 6004M
[09/12 05:27:52] fastreid INFO: training accuracy_positive is tensor([1.], device='cuda:0')
[09/12 05:27:52] fastreid.utils.events INFO:  eta: 1:59:21  epoch/iter: 13/3611  total_loss: 0.0004376  loss_bank_verif: 0.0004376  lr: 3.50e-04  max_mem: 6004M
[09/12 05:29:56] fastreid.utils.events INFO:  eta: 2:07:59  epoch/iter: 14/3799  total_loss: 0.0004006  loss_bank_verif: 0.0004006  lr: 3.50e-04  max_mem: 6004M
[09/12 05:30:41] fastreid INFO: training accuracy_positive is tensor([1.], device='cuda:0')
[09/12 05:30:41] fastreid.utils.events INFO:  eta: 2:04:27  epoch/iter: 14/3869  total_loss: 0.0003853  loss_bank_verif: 0.0003853  lr: 3.50e-04  max_mem: 6004M
[09/12 07:25:20] fastreid INFO: testing accuracy_positive is tensor([0.0011], device='cuda:0')
[09/12 07:25:20] fastreid INFO: accuracy on test set: 99.905780 %
[09/12 07:25:20] fastreid INFO: img_correct on test set: 27 
[09/12 07:25:20] fastreid INFO: img_accuracy on test set: 0.114835 %
[09/12 07:26:38] fastreid.utils.events INFO:  eta: 7 days, 1:44:32  epoch/iter: 15/3999  total_loss: 0.0003722  loss_bank_verif: 0.0003722  lr: 3.50e-04  max_mem: 6004M
[09/12 07:27:58] fastreid INFO: training accuracy_positive is tensor([1.], device='cuda:0')
[09/12 07:27:58] fastreid.utils.events INFO:  eta: 1:58:49  epoch/iter: 15/4127  total_loss: 0.0003548  loss_bank_verif: 0.0003548  lr: 3.50e-04  max_mem: 6004M
[09/12 07:28:47] fastreid.utils.events INFO:  eta: 2:06:40  epoch/iter: 16/4199  total_loss: 0.0003417  loss_bank_verif: 0.0003417  lr: 3.50e-04  max_mem: 6004M
[09/12 07:30:54] fastreid INFO: training accuracy_positive is tensor([1.], device='cuda:0')
[09/12 07:30:54] fastreid.utils.events INFO:  eta: 2:05:42  epoch/iter: 16/4385  total_loss: 0.0003254  loss_bank_verif: 0.0003254  lr: 3.50e-04  max_mem: 6004M
[09/12 07:31:05] fastreid.utils.events INFO:  eta: 2:18:00  epoch/iter: 17/4399  total_loss: 0.0003256  loss_bank_verif: 0.0003256  lr: 3.50e-04  max_mem: 6004M
[09/12 07:33:18] fastreid.utils.events INFO:  eta: 2:00:13  epoch/iter: 17/4599  total_loss: 0.0003118  loss_bank_verif: 0.0003118  lr: 3.50e-04  max_mem: 6004M
[09/12 07:33:48] fastreid INFO: training accuracy_positive is tensor([1.], device='cuda:0')
[09/12 07:33:48] fastreid.utils.events INFO:  eta: 2:03:37  epoch/iter: 17/4643  total_loss: 0.0003088  loss_bank_verif: 0.0003088  lr: 3.50e-04  max_mem: 6004M
[09/12 09:27:03] fastreid INFO: testing accuracy_positive is tensor([0.4090], device='cuda:0')
[09/12 09:27:03] fastreid INFO: accuracy on test set: 93.732430 %
[09/12 09:27:03] fastreid INFO: img_correct on test set: 9618 
[09/12 09:27:03] fastreid INFO: img_accuracy on test set: 40.906771 %
[09/12 09:28:47] fastreid.utils.events INFO:  eta: 5 days, 10:27:22  epoch/iter: 18/4799  total_loss: 0.0003036  loss_bank_verif: 0.0003036  lr: 3.50e-04  max_mem: 6004M
[09/12 09:29:53] fastreid INFO: training accuracy_positive is tensor([1.], device='cuda:0')
[09/12 09:29:53] fastreid.utils.events INFO:  eta: 1:53:08  epoch/iter: 18/4901  total_loss: 0.0002977  loss_bank_verif: 0.0002977  lr: 3.50e-04  max_mem: 6004M
[09/12 09:30:57] fastreid.utils.events INFO:  eta: 1:53:03  epoch/iter: 19/4999  total_loss: 0.000286  loss_bank_verif: 0.000286  lr: 3.50e-04  max_mem: 6004M
[09/12 09:32:44] fastreid INFO: training accuracy_positive is tensor([1.], device='cuda:0')
[09/12 09:32:44] fastreid.utils.events INFO:  eta: 1:54:00  epoch/iter: 19/5159  total_loss: 0.00028  loss_bank_verif: 0.00028  lr: 3.50e-04  max_mem: 6004M
[09/12 09:33:11] fastreid.utils.events INFO:  eta: 1:56:22  epoch/iter: 20/5199  total_loss: 0.0002777  loss_bank_verif: 0.0002777  lr: 3.50e-04  max_mem: 6004M
[09/12 09:35:23] fastreid.utils.events INFO:  eta: 1:50:02  epoch/iter: 20/5399  total_loss: 0.0002753  loss_bank_verif: 0.0002753  lr: 3.50e-04  max_mem: 6004M
[09/12 09:35:34] fastreid INFO: training accuracy_positive is tensor([1.], device='cuda:0')
[09/12 09:35:34] fastreid.utils.events INFO:  eta: 1:46:53  epoch/iter: 20/5417  total_loss: 0.0002742  loss_bank_verif: 0.0002742  lr: 3.50e-04  max_mem: 6004M
[09/12 11:29:47] fastreid INFO: Rank of current process: 0. World size: 1
[09/12 11:29:49] fastreid INFO: Environment info:
----------------------  ------------------------------------------------------------------------------------
sys.platform            linux
Python                  3.7.9 (default, Aug 31 2020, 12:42:55) [GCC 7.3.0]
numpy                   1.19.2
fastreid                1.3 @./fastreid
FASTREID_ENV_MODULE     <not set>
PyTorch                 1.6.0 @/home/huangju/anaconda3/envs/fastreid/lib/python3.7/site-packages/torch
PyTorch debug build     False
GPU available           True
GPU 0                   NVIDIA GeForce RTX 2080 Ti
CUDA_HOME               /usr/local/cuda
Pillow                  8.1.0
torchvision             0.7.0 @/home/huangju/anaconda3/envs/fastreid/lib/python3.7/site-packages/torchvision
torchvision arch flags  sm_35, sm_50, sm_60, sm_70, sm_75
cv2                     3.4.2
----------------------  ------------------------------------------------------------------------------------
PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) Math Kernel Library Version 2020.0.2 Product Build 20200624 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v1.5.0 (Git Hash e2ac1fac44c5078ca927cb9b90e1b3066a0b2ed0)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 10.2
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_37,code=compute_37
  - CuDNN 7.6.5
  - Magma 2.5.2
  - Build settings: BLAS=MKL, BUILD_TYPE=Release, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DUSE_VULKAN_WRAPPER -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, USE_CUDA=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_STATIC_DISPATCH=OFF, 

[09/12 11:29:49] fastreid INFO: Command line arguments: Namespace(config_file='./configs/BOT-verif-msmt17.yml', dist_url='tcp://127.0.0.1:50190', eval_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=[], resume=False)
[09/12 11:29:49] fastreid INFO: Contents of args.config_file=./configs/BOT-verif-msmt17.yml:
_BASE_: "./Base-bagtricks.yml"
MODEL:
  META_ARCHITECTURE: "BaselineVerifMemBank"

  BACKBONE:
    NAME: "build_resnet_backbone"
  LOSSES:
    NAME: ("VerificationLoss")

TEST:
  EVAL_PERIOD: 3

DATASETS:
  NAMES: ("Market1501",)
  TESTS: ("Market1501",)

DATALOADER:
  PK_SAMPLER: True
  NAIVE_WAY: True
  PERSON_NUMBER: 1041
  PERSON_NUMBER_TEST: 3060
OUTPUT_DIR: "logs/BoT_verif_msmt17"
[09/12 11:29:49] fastreid INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  NAIVE_WAY: True
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  PERSON_NUMBER: 1041
  PERSON_NUMBER_TEST: 3060
  PK_SAMPLER: True
  SEQ_LEN: 8
  TEST_SEQ_LEN: 0
DATASETS:
  COMBINEALL: False
  NAMES: ('Market1501',)
  TESTS: ('Market1501',)
INPUT:
  AUGMIX_PROB: 0.0
  AUTOAUG_PROB: 0.0
  CJ:
    BRIGHTNESS: 0.15
    CONTRAST: 0.15
    ENABLED: False
    HUE: 0.1
    PROB: 0.5
    SATURATION: 0.1
  DO_AUGMIX: False
  DO_AUTOAUG: False
  DO_FLIP: True
  DO_PAD: True
  DO_RANDAUG: False
  FLIP_PROB: 0.5
  MIX_TRACKLET: False
  PADDING: 10
  PADDING_MODE: constant
  RANDAUG_PROB: 0.5
  RANDAUG_STR: rand-m9-mstd0.5
  REA:
    ENABLED: True
    PROB: 0.5
    VALUE: [151.98, 142.29000000000002, 126.735]
  RPT:
    ENABLED: False
    PROB: 0.5
  SIZE_TEST: [256, 128]
  SIZE_TRAIN: [256, 128]
MODEL:
  BACKBONE:
    DEPTH: 50x
    FEAT_DIM: 2560
    LAST_STRIDE: 1
    NAME: build_resnet_backbone
    NORM: BN
    PRETRAIN: True
    PRETRAIN_PATH: 
    REMOVE: (3, 4)
    WITH_IBN: False
    WITH_NL: False
    WITH_SE: False
  DEVICE: cuda
  FREEZE_LAYERS: ['']
  HEADS:
    CLS_LAYER: linear
    EMBEDDING_DIM: 0
    HASH_LAYER_DIMS: []
    HASH_LAYER_NUM: 1
    MARGIN: 0.15
    NAME: EmbeddingHead
    NECK_FEAT: before
    NORM: BN
    NUM_CLASSES: 0
    POOL_LAYER: avgpool
    SCALE: 128
    TEMP: 1.0
    WITH_BNNECK: True
  LOSSES:
    CE:
      ALPHA: 0.2
      EPSILON: 0.1
      SCALE: 1.0
    CIRCLE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    COSFACE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    FL:
      ALPHA: 0.25
      GAMMA: 2
      SCALE: 1.0
    NAME: VerificationLoss
    TRI:
      HARD_MINING: True
      MARGIN: 0.3
      NORM_FEAT: False
      SCALE: 1.0
  META_ARCHITECTURE: BaselineVerifMemBank
  PIXEL_MEAN: [123.675, 116.28, 103.53]
  PIXEL_STD: [58.395, 57.120000000000005, 57.375]
  TRANSFORMER:
    DEPTH: 12
    EMBED_DIM: 768
    ENABLE_POS: False
    FEATURE_DIM: 2048
    INPUT_SIZE: (512, 64, 32)
    NAME: TransformerHead
    NUM_HEADS: 3
    PART_H: 4
    PART_STR: ('4x1',)
    PART_V: 1
    PATH_DROP: 0.1
    POS_DROP: 0.0
  TRANSFORMER_S:
    ATTN_DROP: 0.0
    CE_SCALE: 1.0
    DEPTH: 12
    EMBED_DIM: 768
    ENABLE_POS: False
    FEATURE_DIM: 2048
    GAP: False
    INPUT_SIZE: (512, 64, 32)
    LOCAL_PART: 4
    NAME: SpatialTransformerHead
    NUM_HEADS: 3
    PART_STR: 8x4
    PATH_DROP: 0.1
    POS_DROP: 0.0
    RET_ALL: False
  TRANSFORMER_T:
    ATTN_DROP: 0.0
    DEPTH: 12
    EMBED_DIM: 768
    ENABLE_POS: False
    GAP: False
    NAME: TemporalTransformerHead
    NUM_HEADS: 3
    PATH_DROP: 0.1
    POS_DROP: 0.0
    RET_ALL: False
    RET_ATTN: False
  WEIGHTS: 
OUTPUT_DIR: logs/BoT_verif_msmt17
SOLVER:
  BASE_LR: 0.00035
  BIAS_LR_FACTOR: 2.0
  CHECKPOINT_PERIOD: 30
  CLIP_GRADIENTS:
    CLIP_TYPE: norm
    CLIP_VALUE: 5.0
    ENABLED: False
    NORM_TYPE: 2.0
  DELAY_EPOCHS: 0
  ETA_MIN_LR: 1e-07
  FP16_ENABLED: True
  FREEZE_FC_ITERS: 0
  FREEZE_ITERS: 0
  GAMMA: 0.1
  HEADS_LR_FACTOR: 1.0
  IMS_PER_BATCH: 32
  MAX_EPOCH: 60
  MOMENTUM: 0.9
  OPT: Adam
  SCHED: MultiStepLR
  STEPS: [40, 90]
  TRANS_LR_FACTOR: 1.0
  WARMUP_FACTOR: 0.1
  WARMUP_ITERS: 2000
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0005
  WEIGHT_DECAY_BIAS: 0.0005
  WEIGHT_DECAY_NORM: 0.0005
  WEIGHT_DECAY_TRANS: 0.0005
TEST:
  AQE:
    ALPHA: 3.0
    ENABLED: False
    QE_K: 5
    QE_TIME: 1
  ERASE_NUM: 64
  EVAL_PERIOD: 3
  FLIP_ENABLED: False
  HASH_RATE: 0.3
  IMS_PER_BATCH: 128
  METRIC: cosine
  NEIGHBOR_RANGE: 100
  PRECISE_BN:
    DATASET: Market1501
    ENABLED: False
    NUM_ITER: 300
  RERANK:
    ENABLED: False
    K1: 20
    K2: 6
    LAMBDA: 0.3
  ROC_ENABLED: False
  SEQ_TEST: False
  TIMES: 1
  VERIF: False
[09/12 11:29:50] fastreid INFO: Full config saved to /home/huangju/codes/fast-reid/logs/BoT_verif_msmt17/config.yaml
[09/12 11:29:50] fastreid.utils.env INFO: Using a generated random seed 50121799
[09/12 11:29:52] fastreid INFO: Model:
BaselineVerifMemBank(
  (heads): EmbeddingHead(
    (pool_layer): AdaptiveAvgPool2d(output_size=1)
    (bottleneck): Sequential(
      (0): BatchNorm(2560, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (classifier): Linear(in_features=2560, out_features=0, bias=False)
  )
  (verif_model): VerifHead(
    (pool_layer): AdaptiveAvgPool2d(output_size=1)
    (bottleneck): Sequential(
      (0): Conv2d(2560, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
    )
    (classifier): Sequential(
      (0): Linear(in_features=1024, out_features=512, bias=True)
      (1): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): Dropout(p=0.2, inplace=False)
      (3): PReLU(num_parameters=1)
      (4): Linear(in_features=512, out_features=256, bias=True)
      (5): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (6): PReLU(num_parameters=1)
      (7): Linear(in_features=256, out_features=128, bias=True)
      (8): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (9): PReLU(num_parameters=1)
      (10): Linear(in_features=128, out_features=64, bias=True)
      (11): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (12): PReLU(num_parameters=1)
      (13): Linear(in_features=64, out_features=32, bias=True)
      (14): BatchNorm1d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (15): PReLU(num_parameters=1)
      (16): Linear(in_features=32, out_features=16, bias=True)
      (17): BatchNorm1d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (18): PReLU(num_parameters=1)
      (19): Linear(in_features=16, out_features=2, bias=False)
    )
    (drop): Dropout(p=0.5, inplace=False)
  )
)
[09/12 11:29:52] fastreid.utils.checkpoint INFO: No checkpoint found. Training model from scratch
[09/12 11:29:52] fastreid INFO: Start training from epoch 0
[09/12 11:32:04] fastreid.utils.events INFO:  epoch/iter: 0/199  total_loss: 0.5782  loss_bank_verif: 0.5782  lr: 6.63e-05  max_mem: 6004M
[09/12 11:32:42] fastreid INFO: training accuracy_positive is tensor([0.9909], device='cuda:0')
[09/12 11:32:42] fastreid.utils.events INFO:  eta: 2:47:05  epoch/iter: 0/257  total_loss: 0.499  loss_bank_verif: 0.499  lr: 7.55e-05  max_mem: 6004M
[09/12 11:34:15] fastreid.utils.events INFO:  eta: 2:43:41  epoch/iter: 1/399  total_loss: 0.3245  loss_bank_verif: 0.3245  lr: 9.78e-05  max_mem: 6004M
[09/12 11:35:31] fastreid INFO: training accuracy_positive is tensor([1.], device='cuda:0')
[09/12 11:35:31] fastreid.utils.events INFO:  eta: 2:43:08  epoch/iter: 1/515  total_loss: 0.2103  loss_bank_verif: 0.2103  lr: 1.16e-04  max_mem: 6004M
[09/12 11:36:25] fastreid.utils.events INFO:  eta: 2:40:02  epoch/iter: 2/599  total_loss: 0.1493  loss_bank_verif: 0.1493  lr: 1.29e-04  max_mem: 6004M
[09/12 11:38:19] fastreid INFO: training accuracy_positive is tensor([1.], device='cuda:0')
[09/12 11:38:19] fastreid.utils.events INFO:  eta: 2:39:30  epoch/iter: 2/773  total_loss: 0.07102  loss_bank_verif: 0.07102  lr: 1.57e-04  max_mem: 6004M
[09/12 13:57:32] fastreid INFO: testing accuracy_positive is tensor([1.], device='cuda:0')
[09/12 13:57:32] fastreid INFO: accuracy on test set: 0.032680 %
[09/12 13:57:32] fastreid INFO: img_correct on test set: 23512 
[09/12 13:57:32] fastreid INFO: img_accuracy on test set: 100.000000 %
[09/12 13:57:50] fastreid.utils.events INFO:  eta: 54 days, 11:26:55  epoch/iter: 3/799  total_loss: 0.06578  loss_bank_verif: 0.06578  lr: 1.61e-04  max_mem: 6004M
[09/12 13:59:57] fastreid.utils.events INFO:  eta: 2:33:11  epoch/iter: 3/999  total_loss: 0.0296  loss_bank_verif: 0.0296  lr: 1.92e-04  max_mem: 6004M
[09/12 14:00:18] fastreid INFO: training accuracy_positive is tensor([1.], device='cuda:0')
[09/12 14:00:18] fastreid.utils.events INFO:  eta: 2:39:32  epoch/iter: 3/1031  total_loss: 0.02616  loss_bank_verif: 0.02616  lr: 1.97e-04  max_mem: 6004M
[09/12 14:02:07] fastreid.utils.events INFO:  eta: 2:32:49  epoch/iter: 4/1199  total_loss: 0.0145  loss_bank_verif: 0.0145  lr: 2.24e-04  max_mem: 6004M
[09/12 14:03:07] fastreid INFO: training accuracy_positive is tensor([1.], device='cuda:0')
[09/12 14:03:07] fastreid.utils.events INFO:  eta: 2:37:28  epoch/iter: 4/1289  total_loss: 0.01105  loss_bank_verif: 0.01105  lr: 2.38e-04  max_mem: 6004M
[09/12 14:04:21] fastreid.utils.events INFO:  eta: 2:37:55  epoch/iter: 5/1399  total_loss: 0.008165  loss_bank_verif: 0.008165  lr: 2.55e-04  max_mem: 6004M
[09/12 14:05:58] fastreid INFO: training accuracy_positive is tensor([1.], device='cuda:0')
[09/12 14:05:58] fastreid.utils.events INFO:  eta: 2:30:27  epoch/iter: 5/1547  total_loss: 0.005638  loss_bank_verif: 0.005638  lr: 2.79e-04  max_mem: 6004M
[09/12 16:24:26] fastreid INFO: testing accuracy_positive is tensor([1.], device='cuda:0')
[09/12 16:24:26] fastreid INFO: accuracy on test set: 0.032680 %
[09/12 16:24:26] fastreid INFO: img_correct on test set: 23512 
[09/12 16:24:26] fastreid INFO: img_accuracy on test set: 100.000000 %
[09/12 16:25:00] fastreid.utils.events INFO:  eta: 25 days, 15:54:29  epoch/iter: 6/1599  total_loss: 0.004949  loss_bank_verif: 0.004949  lr: 2.87e-04  max_mem: 6004M
[09/12 16:27:12] fastreid.utils.events INFO:  eta: 2:29:02  epoch/iter: 6/1799  total_loss: 0.003216  loss_bank_verif: 0.003216  lr: 3.18e-04  max_mem: 6004M
[09/12 16:27:16] fastreid INFO: training accuracy_positive is tensor([1.], device='cuda:0')
[09/12 16:27:16] fastreid.utils.events INFO:  eta: 2:25:57  epoch/iter: 6/1805  total_loss: 0.003199  loss_bank_verif: 0.003199  lr: 3.19e-04  max_mem: 6004M
[09/12 16:29:21] fastreid.utils.events INFO:  eta: 2:24:34  epoch/iter: 7/1999  total_loss: 0.002177  loss_bank_verif: 0.002177  lr: 3.50e-04  max_mem: 6004M
[09/12 16:30:02] fastreid INFO: training accuracy_positive is tensor([1.], device='cuda:0')
[09/12 16:30:02] fastreid.utils.events INFO:  eta: 2:23:28  epoch/iter: 7/2063  total_loss: 0.001969  loss_bank_verif: 0.001969  lr: 3.50e-04  max_mem: 6004M
[09/12 16:31:26] fastreid.utils.events INFO:  eta: 2:15:19  epoch/iter: 8/2199  total_loss: 0.001623  loss_bank_verif: 0.001623  lr: 3.50e-04  max_mem: 6004M
[09/12 16:32:37] fastreid INFO: training accuracy_positive is tensor([1.], device='cuda:0')
[09/12 16:32:37] fastreid.utils.events INFO:  eta: 2:07:01  epoch/iter: 8/2321  total_loss: 0.001331  loss_bank_verif: 0.001331  lr: 3.50e-04  max_mem: 6004M
[09/12 18:49:55] fastreid INFO: testing accuracy_positive is tensor([1.], device='cuda:0')
[09/12 18:49:55] fastreid INFO: accuracy on test set: 0.032680 %
[09/12 18:49:55] fastreid INFO: img_correct on test set: 23512 
[09/12 18:49:55] fastreid INFO: img_accuracy on test set: 100.000000 %
[09/12 18:50:47] fastreid.utils.events INFO:  eta: 16 days, 0:23:23  epoch/iter: 9/2399  total_loss: 0.001198  loss_bank_verif: 0.001198  lr: 3.50e-04  max_mem: 6004M
[09/12 18:52:44] fastreid INFO: training accuracy_positive is tensor([1.], device='cuda:0')
[09/12 18:52:44] fastreid.utils.events INFO:  eta: 2:19:46  epoch/iter: 9/2579  total_loss: 0.0009719  loss_bank_verif: 0.0009719  lr: 3.50e-04  max_mem: 6004M
[09/12 18:52:58] fastreid.utils.events INFO:  eta: 2:19:25  epoch/iter: 10/2599  total_loss: 0.0009506  loss_bank_verif: 0.0009506  lr: 3.50e-04  max_mem: 6004M
[09/12 18:55:06] fastreid.utils.events INFO:  eta: 2:14:57  epoch/iter: 10/2799  total_loss: 0.0007674  loss_bank_verif: 0.0007674  lr: 3.50e-04  max_mem: 6004M
[09/12 18:55:30] fastreid INFO: training accuracy_positive is tensor([1.], device='cuda:0')
[09/12 18:55:30] fastreid.utils.events INFO:  eta: 2:15:42  epoch/iter: 10/2837  total_loss: 0.0007416  loss_bank_verif: 0.0007416  lr: 3.50e-04  max_mem: 6004M
[09/12 18:57:16] fastreid.utils.events INFO:  eta: 2:15:25  epoch/iter: 11/2999  total_loss: 0.000644  loss_bank_verif: 0.000644  lr: 3.50e-04  max_mem: 6004M
[09/12 18:58:21] fastreid INFO: training accuracy_positive is tensor([1.], device='cuda:0')
[09/12 18:58:21] fastreid.utils.events INFO:  eta: 2:19:06  epoch/iter: 11/3095  total_loss: 0.0005942  loss_bank_verif: 0.0005942  lr: 3.50e-04  max_mem: 6004M
[09/12 21:17:01] fastreid INFO: testing accuracy_positive is tensor([1.], device='cuda:0')
[09/12 21:17:01] fastreid INFO: accuracy on test set: 0.032680 %
[09/12 21:17:01] fastreid INFO: img_correct on test set: 23512 
[09/12 21:17:01] fastreid INFO: img_accuracy on test set: 100.000000 %
[09/12 21:18:09] fastreid.utils.events INFO:  eta: 11 days, 9:46:13  epoch/iter: 12/3199  total_loss: 0.0005474  loss_bank_verif: 0.0005474  lr: 3.50e-04  max_mem: 6004M
[09/12 21:19:50] fastreid INFO: training accuracy_positive is tensor([1.], device='cuda:0')
[09/12 21:19:50] fastreid.utils.events INFO:  eta: 2:11:19  epoch/iter: 12/3353  total_loss: 0.0005027  loss_bank_verif: 0.0005027  lr: 3.50e-04  max_mem: 6004M
[09/12 21:20:21] fastreid.utils.events INFO:  eta: 2:16:26  epoch/iter: 13/3399  total_loss: 0.0004906  loss_bank_verif: 0.0004906  lr: 3.50e-04  max_mem: 6004M
[09/12 21:22:34] fastreid.utils.events INFO:  eta: 2:10:56  epoch/iter: 13/3599  total_loss: 0.0004447  loss_bank_verif: 0.0004447  lr: 3.50e-04  max_mem: 6004M
[09/12 21:22:42] fastreid INFO: training accuracy_positive is tensor([1.], device='cuda:0')
[09/12 21:22:42] fastreid.utils.events INFO:  eta: 2:07:03  epoch/iter: 13/3611  total_loss: 0.0004416  loss_bank_verif: 0.0004416  lr: 3.50e-04  max_mem: 6004M
[09/12 21:24:46] fastreid.utils.events INFO:  eta: 2:07:36  epoch/iter: 14/3799  total_loss: 0.0003896  loss_bank_verif: 0.0003896  lr: 3.50e-04  max_mem: 6004M
[09/12 21:25:32] fastreid INFO: training accuracy_positive is tensor([1.], device='cuda:0')
[09/12 21:25:32] fastreid.utils.events INFO:  eta: 2:06:18  epoch/iter: 14/3869  total_loss: 0.0003773  loss_bank_verif: 0.0003773  lr: 3.50e-04  max_mem: 6004M
[09/12 21:39:00] fastreid INFO: Rank of current process: 0. World size: 1
[09/12 21:39:02] fastreid INFO: Environment info:
----------------------  ------------------------------------------------------------------------------------
[09/13 10:06:18] fastreid INFO: Rank of current process: 0. World size: 1
[09/13 10:06:20] fastreid INFO: Environment info:
----------------------  ------------------------------------------------------------------------------------
sys.platform            linux
Python                  3.7.9 (default, Aug 31 2020, 12:42:55) [GCC 7.3.0]
numpy                   1.19.2
fastreid                1.3 @./fastreid
FASTREID_ENV_MODULE     <not set>
PyTorch                 1.6.0 @/home/huangju/anaconda3/envs/fastreid/lib/python3.7/site-packages/torch
PyTorch debug build     False
GPU available           True
GPU 0                   NVIDIA GeForce RTX 2080 Ti
CUDA_HOME               /usr/local/cuda
Pillow                  8.1.0
torchvision             0.7.0 @/home/huangju/anaconda3/envs/fastreid/lib/python3.7/site-packages/torchvision
torchvision arch flags  sm_35, sm_50, sm_60, sm_70, sm_75
cv2                     3.4.2
----------------------  ------------------------------------------------------------------------------------
PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) Math Kernel Library Version 2020.0.2 Product Build 20200624 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v1.5.0 (Git Hash e2ac1fac44c5078ca927cb9b90e1b3066a0b2ed0)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 10.2
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_37,code=compute_37
  - CuDNN 7.6.5
  - Magma 2.5.2
  - Build settings: BLAS=MKL, BUILD_TYPE=Release, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DUSE_VULKAN_WRAPPER -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, USE_CUDA=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_STATIC_DISPATCH=OFF, 

[09/13 10:06:20] fastreid INFO: Command line arguments: Namespace(config_file='./configs/BOT-verif-msmt17.yml', dist_url='tcp://127.0.0.1:50190', eval_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=[], resume=False)
[09/13 10:06:20] fastreid INFO: Contents of args.config_file=./configs/BOT-verif-msmt17.yml:
_BASE_: "./Base-bagtricks.yml"
MODEL:
  META_ARCHITECTURE: "BaselineVerifMemBank"

  BACKBONE:
    NAME: "build_resnet_backbone"
  LOSSES:
    NAME: ("VerificationLoss")

TEST:
  EVAL_PERIOD: 3

DATASETS:
  NAMES: ("Market1501",)
  TESTS: ("Market1501",)

DATALOADER:
  PK_SAMPLER: True
  NAIVE_WAY: True
  PERSON_NUMBER: 1041
  PERSON_NUMBER_TEST: 3060
OUTPUT_DIR: "logs/BoT_verif_msmt17"
[09/13 10:06:20] fastreid INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  NAIVE_WAY: True
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  PERSON_NUMBER: 1041
  PERSON_NUMBER_TEST: 3060
  PK_SAMPLER: True
  SEQ_LEN: 8
  TEST_SEQ_LEN: 0
DATASETS:
  COMBINEALL: False
  NAMES: ('Market1501',)
  TESTS: ('Market1501',)
INPUT:
  AUGMIX_PROB: 0.0
  AUTOAUG_PROB: 0.0
  CJ:
    BRIGHTNESS: 0.15
    CONTRAST: 0.15
    ENABLED: False
    HUE: 0.1
    PROB: 0.5
    SATURATION: 0.1
  DO_AUGMIX: False
  DO_AUTOAUG: False
  DO_FLIP: True
  DO_PAD: True
  DO_RANDAUG: False
  FLIP_PROB: 0.5
  MIX_TRACKLET: False
  PADDING: 10
  PADDING_MODE: constant
  RANDAUG_PROB: 0.5
  RANDAUG_STR: rand-m9-mstd0.5
  REA:
    ENABLED: True
    PROB: 0.5
    VALUE: [151.98, 142.29000000000002, 126.735]
  RPT:
    ENABLED: False
    PROB: 0.5
  SIZE_TEST: [256, 128]
  SIZE_TRAIN: [256, 128]
MODEL:
  BACKBONE:
    DEPTH: 50x
    FEAT_DIM: 2560
    LAST_STRIDE: 1
    NAME: build_resnet_backbone
    NORM: BN
    PRETRAIN: True
    PRETRAIN_PATH: 
    REMOVE: (3, 4)
    WITH_IBN: False
    WITH_NL: False
    WITH_SE: False
  DEVICE: cuda
  FREEZE_LAYERS: ['']
  HEADS:
    CLS_LAYER: linear
    EMBEDDING_DIM: 0
    HASH_LAYER_DIMS: []
    HASH_LAYER_NUM: 1
    MARGIN: 0.15
    NAME: EmbeddingHead
    NECK_FEAT: before
    NORM: BN
    NUM_CLASSES: 0
    POOL_LAYER: avgpool
    SCALE: 128
    TEMP: 1.0
    WITH_BNNECK: True
  LOSSES:
    CE:
      ALPHA: 0.2
      EPSILON: 0.1
      SCALE: 1.0
    CIRCLE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    COSFACE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    FL:
      ALPHA: 0.25
      GAMMA: 2
      SCALE: 1.0
    NAME: VerificationLoss
    TRI:
      HARD_MINING: True
      MARGIN: 0.3
      NORM_FEAT: False
      SCALE: 1.0
  META_ARCHITECTURE: BaselineVerifMemBank
  PIXEL_MEAN: [123.675, 116.28, 103.53]
  PIXEL_STD: [58.395, 57.120000000000005, 57.375]
  TRANSFORMER:
    DEPTH: 12
    EMBED_DIM: 768
    ENABLE_POS: False
    FEATURE_DIM: 2048
    INPUT_SIZE: (512, 64, 32)
    NAME: TransformerHead
    NUM_HEADS: 3
    PART_H: 4
    PART_STR: ('4x1',)
    PART_V: 1
    PATH_DROP: 0.1
    POS_DROP: 0.0
  TRANSFORMER_S:
    ATTN_DROP: 0.0
    CE_SCALE: 1.0
    DEPTH: 12
    EMBED_DIM: 768
    ENABLE_POS: False
    FEATURE_DIM: 2048
    GAP: False
    INPUT_SIZE: (512, 64, 32)
    LOCAL_PART: 4
    NAME: SpatialTransformerHead
    NUM_HEADS: 3
    PART_STR: 8x4
    PATH_DROP: 0.1
    POS_DROP: 0.0
    RET_ALL: False
  TRANSFORMER_T:
    ATTN_DROP: 0.0
    DEPTH: 12
    EMBED_DIM: 768
    ENABLE_POS: False
    GAP: False
    NAME: TemporalTransformerHead
    NUM_HEADS: 3
    PATH_DROP: 0.1
    POS_DROP: 0.0
    RET_ALL: False
    RET_ATTN: False
  WEIGHTS: 
OUTPUT_DIR: logs/BoT_verif_msmt17
SOLVER:
  BASE_LR: 0.00035
  BIAS_LR_FACTOR: 2.0
  CHECKPOINT_PERIOD: 30
  CLIP_GRADIENTS:
    CLIP_TYPE: norm
    CLIP_VALUE: 5.0
    ENABLED: False
    NORM_TYPE: 2.0
  DELAY_EPOCHS: 0
  ETA_MIN_LR: 1e-07
  FP16_ENABLED: True
  FREEZE_FC_ITERS: 0
  FREEZE_ITERS: 0
  GAMMA: 0.1
  HEADS_LR_FACTOR: 1.0
  IMS_PER_BATCH: 32
  MAX_EPOCH: 60
  MOMENTUM: 0.9
  OPT: Adam
  SCHED: MultiStepLR
  STEPS: [40, 90]
  TRANS_LR_FACTOR: 1.0
  WARMUP_FACTOR: 0.1
  WARMUP_ITERS: 2000
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0005
  WEIGHT_DECAY_BIAS: 0.0005
  WEIGHT_DECAY_NORM: 0.0005
  WEIGHT_DECAY_TRANS: 0.0005
TEST:
  AQE:
    ALPHA: 3.0
    ENABLED: False
    QE_K: 5
    QE_TIME: 1
  ERASE_NUM: 64
  EVAL_PERIOD: 3
  FLIP_ENABLED: False
  HASH_RATE: 0.3
  IMS_PER_BATCH: 128
  METRIC: cosine
  NEIGHBOR_RANGE: 100
  PRECISE_BN:
    DATASET: Market1501
    ENABLED: False
    NUM_ITER: 300
  RERANK:
    ENABLED: False
    K1: 20
    K2: 6
    LAMBDA: 0.3
  ROC_ENABLED: False
  SEQ_TEST: False
  TIMES: 1
  VERIF: False
[09/13 10:06:21] fastreid INFO: Full config saved to /home/huangju/codes/fast-reid/logs/BoT_verif_msmt17/config.yaml
[09/13 10:06:21] fastreid.utils.env INFO: Using a generated random seed 21099985
[09/13 10:06:23] fastreid INFO: Model:
BaselineVerifMemBank(
  (heads): EmbeddingHead(
    (pool_layer): AdaptiveAvgPool2d(output_size=1)
    (bottleneck): Sequential(
      (0): BatchNorm(2560, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (classifier): Linear(in_features=2560, out_features=0, bias=False)
  )
  (verif_model): VerifHead(
    (pool_layer): AdaptiveAvgPool2d(output_size=1)
    (bottleneck): Sequential(
      (0): Conv2d(2560, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
    )
    (classifier): Sequential(
      (0): Linear(in_features=1024, out_features=512, bias=True)
      (1): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): Dropout(p=0.2, inplace=False)
      (3): PReLU(num_parameters=1)
      (4): Linear(in_features=512, out_features=256, bias=True)
      (5): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (6): Dropout(p=0.2, inplace=False)
      (7): PReLU(num_parameters=1)
      (8): Linear(in_features=256, out_features=128, bias=True)
      (9): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (10): Dropout(p=0.2, inplace=False)
      (11): PReLU(num_parameters=1)
      (12): Linear(in_features=128, out_features=64, bias=True)
      (13): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (14): Dropout(p=0.2, inplace=False)
      (15): PReLU(num_parameters=1)
      (16): Linear(in_features=64, out_features=32, bias=True)
      (17): BatchNorm1d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (18): Dropout(p=0.2, inplace=False)
      (19): PReLU(num_parameters=1)
      (20): Linear(in_features=32, out_features=16, bias=True)
      (21): BatchNorm1d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (22): Dropout(p=0.2, inplace=False)
      (23): PReLU(num_parameters=1)
      (24): Linear(in_features=16, out_features=2, bias=False)
    )
    (drop): Dropout(p=0.5, inplace=False)
  )
)
[09/13 10:06:23] fastreid.utils.checkpoint INFO: No checkpoint found. Training model from scratch
[09/13 10:06:23] fastreid INFO: Start training from epoch 0
[09/13 10:20:18] fastreid.utils.events INFO:  epoch/iter: 0/199  total_loss: 303.5  loss_bank_verif: 303.5  lr: 6.63e-05  max_mem: 8431M
[09/13 10:24:03] fastreid INFO: training accuracy_positive is tensor([0.0168], device='cuda:0')
[09/13 10:24:03] fastreid.utils.events INFO:  eta: 16:22:03  epoch/iter: 0/257  total_loss: 264.3  loss_bank_verif: 264.3  lr: 7.55e-05  max_mem: 8431M
[09/13 10:32:11] fastreid.utils.events INFO:  eta: 14:20:28  epoch/iter: 1/399  total_loss: 175.4  loss_bank_verif: 175.4  lr: 9.78e-05  max_mem: 8431M
[09/13 10:38:54] fastreid INFO: training accuracy_positive is tensor([0.0005], device='cuda:0')
[09/13 10:38:54] fastreid.utils.events INFO:  eta: 14:22:01  epoch/iter: 1/515  total_loss: 117.4  loss_bank_verif: 117.4  lr: 1.16e-04  max_mem: 8431M
[09/13 10:43:13] fastreid.utils.events INFO:  eta: 12:42:54  epoch/iter: 2/599  total_loss: 85.61  loss_bank_verif: 85.61  lr: 1.29e-04  max_mem: 8431M
[09/13 10:52:39] fastreid INFO: training accuracy_positive is tensor([0.3973], device='cuda:0')
[09/13 10:52:39] fastreid.utils.events INFO:  eta: 13:14:11  epoch/iter: 2/773  total_loss: 44.87  loss_bank_verif: 44.87  lr: 1.57e-04  max_mem: 8431M
[09/13 12:29:16] fastreid INFO: testing accuracy_positive is tensor([0.0221], device='cuda:0')
[09/13 12:29:16] fastreid INFO: accuracy on test set: 97.352222 %
[09/13 12:30:17] fastreid.utils.events INFO:  eta: 38 days, 2:53:53  epoch/iter: 3/799  total_loss: 41.3  loss_bank_verif: 41.3  lr: 1.61e-04  max_mem: 8431M
[09/13 12:37:38] fastreid.utils.events INFO:  eta: 8:50:25  epoch/iter: 3/999  total_loss: 22.56  loss_bank_verif: 22.56  lr: 1.92e-04  max_mem: 8431M
[09/13 12:38:45] fastreid INFO: training accuracy_positive is tensor([0.5164], device='cuda:0')
[09/13 12:38:45] fastreid.utils.events INFO:  eta: 8:22:38  epoch/iter: 3/1031  total_loss: 20.54  loss_bank_verif: 20.54  lr: 1.97e-04  max_mem: 8431M
[09/13 12:44:58] fastreid.utils.events INFO:  eta: 8:45:40  epoch/iter: 4/1199  total_loss: 14.35  loss_bank_verif: 14.35  lr: 2.24e-04  max_mem: 8431M
[09/13 12:48:12] fastreid INFO: training accuracy_positive is tensor([0.5384], device='cuda:0')
[09/13 12:48:12] fastreid.utils.events INFO:  eta: 8:27:11  epoch/iter: 4/1289  total_loss: 12.48  loss_bank_verif: 12.48  lr: 2.38e-04  max_mem: 8431M























[09/16 14:16:29] fastreid INFO: Rank of current process: 0. World size: 1
[09/16 14:16:35] fastreid INFO: Environment info:
----------------------  ------------------------------------------------------------------------------------
sys.platform            linux
Python                  3.7.9 (default, Aug 31 2020, 12:42:55) [GCC 7.3.0]
numpy                   1.19.2
fastreid                1.3 @./fastreid
FASTREID_ENV_MODULE     <not set>
PyTorch                 1.6.0 @/home/huangju/anaconda3/envs/fastreid/lib/python3.7/site-packages/torch
PyTorch debug build     False
GPU available           True
GPU 0                   NVIDIA GeForce RTX 2080 Ti
CUDA_HOME               /usr/local/cuda
Pillow                  8.1.0
torchvision             0.7.0 @/home/huangju/anaconda3/envs/fastreid/lib/python3.7/site-packages/torchvision
torchvision arch flags  sm_35, sm_50, sm_60, sm_70, sm_75
cv2                     3.4.2
----------------------  ------------------------------------------------------------------------------------
PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) Math Kernel Library Version 2020.0.2 Product Build 20200624 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v1.5.0 (Git Hash e2ac1fac44c5078ca927cb9b90e1b3066a0b2ed0)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 10.2
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_37,code=compute_37
  - CuDNN 7.6.5
  - Magma 2.5.2
  - Build settings: BLAS=MKL, BUILD_TYPE=Release, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DUSE_VULKAN_WRAPPER -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, USE_CUDA=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_STATIC_DISPATCH=OFF, 

[09/16 14:16:35] fastreid INFO: Command line arguments: Namespace(config_file='./configs/BOT-verif-msmt17.yml', dist_url='tcp://127.0.0.1:50190', eval_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=[], resume=False)
[09/16 14:16:35] fastreid INFO: Contents of args.config_file=./configs/BOT-verif-msmt17.yml:
_BASE_: "./Base-bagtricks.yml"
MODEL:
  META_ARCHITECTURE: "BaselineVerifMemBank"

  BACKBONE:
    NAME: "build_resnet_backbone"
  LOSSES:
    NAME: ("VerificationLoss")

TEST:
  EVAL_PERIOD: 3

DATASETS:
  NAMES: ("Market1501",)
  TESTS: ("Market1501",)

DATALOADER:
  PK_SAMPLER: True
  NAIVE_WAY: True
  PERSON_NUMBER: 1041
  PERSON_NUMBER_TEST: 3060
OUTPUT_DIR: "logs/BoT_verif_msmt17"
[09/16 14:16:35] fastreid INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  NAIVE_WAY: True
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  PERSON_NUMBER: 1041
  PERSON_NUMBER_TEST: 3060
  PK_SAMPLER: True
  SEQ_LEN: 8
  TEST_SEQ_LEN: 0
DATASETS:
  COMBINEALL: False
  NAMES: ('Market1501',)
  TESTS: ('Market1501',)
INPUT:
  AUGMIX_PROB: 0.0
  AUTOAUG_PROB: 0.0
  CJ:
    BRIGHTNESS: 0.15
    CONTRAST: 0.15
    ENABLED: False
    HUE: 0.1
    PROB: 0.5
    SATURATION: 0.1
  DO_AUGMIX: False
  DO_AUTOAUG: False
  DO_FLIP: True
  DO_PAD: True
  DO_RANDAUG: False
  FLIP_PROB: 0.5
  MIX_TRACKLET: False
  PADDING: 10
  PADDING_MODE: constant
  RANDAUG_PROB: 0.5
  RANDAUG_STR: rand-m9-mstd0.5
  REA:
    ENABLED: True
    PROB: 0.5
    VALUE: [151.98, 142.29000000000002, 126.735]
  RPT:
    ENABLED: False
    PROB: 0.5
  SIZE_TEST: [256, 128]
  SIZE_TRAIN: [256, 128]
MODEL:
  BACKBONE:
    DEPTH: 50x
    FEAT_DIM: 2560
    LAST_STRIDE: 1
    NAME: build_resnet_backbone
    NORM: BN
    PRETRAIN: True
    PRETRAIN_PATH: 
    REMOVE: (3, 4)
    WITH_IBN: False
    WITH_NL: False
    WITH_SE: False
  DEVICE: cuda
  FREEZE_LAYERS: ['']
  HEADS:
    CLS_LAYER: linear
    EMBEDDING_DIM: 0
    HASH_LAYER_DIMS: []
    HASH_LAYER_NUM: 1
    MARGIN: 0.15
    NAME: EmbeddingHead
    NECK_FEAT: before
    NORM: BN
    NUM_CLASSES: 0
    POOL_LAYER: avgpool
    SCALE: 128
    TEMP: 1.0
    WITH_BNNECK: True
  LOSSES:
    CE:
      ALPHA: 0.2
      EPSILON: 0.1
      SCALE: 1.0
    CIRCLE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    COSFACE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    FL:
      ALPHA: 0.25
      GAMMA: 2
      SCALE: 1.0
    NAME: VerificationLoss
    TRI:
      HARD_MINING: True
      MARGIN: 0.3
      NORM_FEAT: False
      SCALE: 1.0
  META_ARCHITECTURE: BaselineVerifMemBank
  PIXEL_MEAN: [123.675, 116.28, 103.53]
  PIXEL_STD: [58.395, 57.120000000000005, 57.375]
  TRANSFORMER:
    DEPTH: 12
    EMBED_DIM: 768
    ENABLE_POS: False
    FEATURE_DIM: 2048
    INPUT_SIZE: (512, 64, 32)
    NAME: TransformerHead
    NUM_HEADS: 3
    PART_H: 4
    PART_STR: ('4x1',)
    PART_V: 1
    PATH_DROP: 0.1
    POS_DROP: 0.0
  TRANSFORMER_S:
    ATTN_DROP: 0.0
    CE_SCALE: 1.0
    DEPTH: 12
    EMBED_DIM: 768
    ENABLE_POS: False
    FEATURE_DIM: 2048
    GAP: False
    INPUT_SIZE: (512, 64, 32)
    LOCAL_PART: 4
    NAME: SpatialTransformerHead
    NUM_HEADS: 3
    PART_STR: 8x4
    PATH_DROP: 0.1
    POS_DROP: 0.0
    RET_ALL: False
  TRANSFORMER_T:
    ATTN_DROP: 0.0
    DEPTH: 12
    EMBED_DIM: 768
    ENABLE_POS: False
    GAP: False
    NAME: TemporalTransformerHead
    NUM_HEADS: 3
    PATH_DROP: 0.1
    POS_DROP: 0.0
    RET_ALL: False
    RET_ATTN: False
  WEIGHTS: 
OUTPUT_DIR: logs/BoT_verif_msmt17
SOLVER:
  BASE_LR: 0.00035
  BIAS_LR_FACTOR: 2.0
  CHECKPOINT_PERIOD: 30
  CLIP_GRADIENTS:
    CLIP_TYPE: norm
    CLIP_VALUE: 5.0
    ENABLED: False
    NORM_TYPE: 2.0
  DELAY_EPOCHS: 0
  ETA_MIN_LR: 1e-07
  FP16_ENABLED: True
  FREEZE_FC_ITERS: 0
  FREEZE_ITERS: 0
  GAMMA: 0.1
  HEADS_LR_FACTOR: 1.0
  IMS_PER_BATCH: 32
  MAX_EPOCH: 60
  MOMENTUM: 0.9
  OPT: Adam
  SCHED: MultiStepLR
  STEPS: [40, 90]
  TRANS_LR_FACTOR: 1.0
  WARMUP_FACTOR: 0.1
  WARMUP_ITERS: 2000
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0005
  WEIGHT_DECAY_BIAS: 0.0005
  WEIGHT_DECAY_NORM: 0.0005
  WEIGHT_DECAY_TRANS: 0.0005
TEST:
  AQE:
    ALPHA: 3.0
    ENABLED: False
    QE_K: 5
    QE_TIME: 1
  ERASE_NUM: 64
  EVAL_PERIOD: 3
  FLIP_ENABLED: False
  HASH_RATE: 0.3
  IMS_PER_BATCH: 128
  METRIC: cosine
  NEIGHBOR_RANGE: 100
  PRECISE_BN:
    DATASET: Market1501
    ENABLED: False
    NUM_ITER: 300
  RERANK:
    ENABLED: False
    K1: 20
    K2: 6
    LAMBDA: 0.3
  ROC_ENABLED: False
  SEQ_TEST: False
  TIMES: 1
  VERIF: False
[09/16 14:16:35] fastreid INFO: Full config saved to /home/huangju/codes/fast-reid/logs/BoT_verif_msmt17/config.yaml
[09/16 14:16:35] fastreid.utils.env INFO: Using a generated random seed 35966181
[09/16 14:16:46] fastreid INFO: Model:
BaselineVerifMemBank(
  (heads): EmbeddingHead(
    (pool_layer): AdaptiveAvgPool2d(output_size=1)
    (bottleneck): Sequential(
      (0): BatchNorm(2560, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (classifier): Linear(in_features=2560, out_features=0, bias=False)
  )
  (verif_model): VerifHead(
    (pool_layer): AdaptiveAvgPool2d(output_size=1)
    (bottleneck): Sequential(
      (0): Conv2d(2560, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
    )
    (classifier): Sequential(
      (0): Linear(in_features=1024, out_features=512, bias=True)
      (1): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): Dropout(p=0.2, inplace=False)
      (3): PReLU(num_parameters=1)
      (4): Linear(in_features=512, out_features=256, bias=True)
      (5): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (6): Dropout(p=0.2, inplace=False)
      (7): PReLU(num_parameters=1)
      (8): Linear(in_features=256, out_features=128, bias=True)
      (9): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (10): Dropout(p=0.2, inplace=False)
      (11): PReLU(num_parameters=1)
      (12): Linear(in_features=128, out_features=64, bias=True)
      (13): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (14): Dropout(p=0.2, inplace=False)
      (15): PReLU(num_parameters=1)
      (16): Linear(in_features=64, out_features=32, bias=True)
      (17): BatchNorm1d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (18): Dropout(p=0.2, inplace=False)
      (19): PReLU(num_parameters=1)
      (20): Linear(in_features=32, out_features=16, bias=True)
      (21): BatchNorm1d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (22): Dropout(p=0.2, inplace=False)
      (23): PReLU(num_parameters=1)
      (24): Linear(in_features=16, out_features=2, bias=False)
    )
    (drop): Dropout(p=0.5, inplace=False)
  )
)
[09/16 14:16:52] fastreid.utils.checkpoint INFO: No checkpoint found. Training model from scratch
[09/16 14:16:53] fastreid INFO: Start training from epoch 0
[09/16 14:28:01] fastreid.utils.events INFO:  epoch/iter: 0/199  total_loss: 301.3  loss_bank_verif: 301.3  lr: 6.63e-05  max_mem: 8363M
[09/16 14:30:33] fastreid INFO: training accuracy_positive is tensor([0.0171], device='cuda:0')
[09/16 14:30:33] fastreid.utils.events INFO:  eta: 11:05:21  epoch/iter: 0/257  total_loss: 264.6  loss_bank_verif: 264.6  lr: 7.55e-05  max_mem: 8363M
[09/16 14:36:03] fastreid.utils.events INFO:  eta: 9:40:21  epoch/iter: 1/399  total_loss: 177  loss_bank_verif: 177  lr: 9.78e-05  max_mem: 8363M
[09/16 14:40:18] fastreid INFO: training accuracy_positive is tensor([0.0005], device='cuda:0')
[09/16 14:40:18] fastreid.utils.events INFO:  eta: 9:07:39  epoch/iter: 1/515  total_loss: 118.8  loss_bank_verif: 118.8  lr: 1.16e-04  max_mem: 8363M
[09/16 14:43:08] fastreid.utils.events INFO:  eta: 8:19:44  epoch/iter: 2/599  total_loss: 87.81  loss_bank_verif: 87.81  lr: 1.29e-04  max_mem: 8363M
[09/16 14:48:58] fastreid INFO: training accuracy_positive is tensor([0.2362], device='cuda:0')
[09/16 14:48:58] fastreid.utils.events INFO:  eta: 8:10:15  epoch/iter: 2/773  total_loss: 46.68  loss_bank_verif: 46.68  lr: 1.57e-04  max_mem: 8363M
[09/16 16:12:12] fastreid INFO: Rank of current process: 0. World size: 1
[09/16 16:12:14] fastreid INFO: Environment info:
----------------------  ------------------------------------------------------------------------------------
sys.platform            linux
Python                  3.7.9 (default, Aug 31 2020, 12:42:55) [GCC 7.3.0]
numpy                   1.19.2
fastreid                1.3 @./fastreid
FASTREID_ENV_MODULE     <not set>
PyTorch                 1.6.0 @/home/huangju/anaconda3/envs/fastreid/lib/python3.7/site-packages/torch
PyTorch debug build     False
GPU available           True
GPU 0                   NVIDIA GeForce RTX 2080 Ti
CUDA_HOME               /usr/local/cuda
Pillow                  8.1.0
torchvision             0.7.0 @/home/huangju/anaconda3/envs/fastreid/lib/python3.7/site-packages/torchvision
torchvision arch flags  sm_35, sm_50, sm_60, sm_70, sm_75
cv2                     3.4.2
----------------------  ------------------------------------------------------------------------------------
PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) Math Kernel Library Version 2020.0.2 Product Build 20200624 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v1.5.0 (Git Hash e2ac1fac44c5078ca927cb9b90e1b3066a0b2ed0)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 10.2
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_37,code=compute_37
  - CuDNN 7.6.5
  - Magma 2.5.2
  - Build settings: BLAS=MKL, BUILD_TYPE=Release, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DUSE_VULKAN_WRAPPER -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, USE_CUDA=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_STATIC_DISPATCH=OFF, 

[09/16 16:12:14] fastreid INFO: Command line arguments: Namespace(config_file='./configs/BOT-verif-msmt17.yml', dist_url='tcp://127.0.0.1:50190', eval_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=[], resume=False)
[09/16 16:12:14] fastreid INFO: Contents of args.config_file=./configs/BOT-verif-msmt17.yml:
_BASE_: "./Base-bagtricks.yml"
MODEL:
  META_ARCHITECTURE: "BaselineVerifMemBank"

  BACKBONE:
    NAME: "build_resnet_backbone"
  LOSSES:
    NAME: ("VerificationLoss")

TEST:
  EVAL_PERIOD: 3

DATASETS:
  NAMES: ("Market1501",)
  TESTS: ("Market1501",)

DATALOADER:
  PK_SAMPLER: True
  NAIVE_WAY: True
  PERSON_NUMBER: 1041
  PERSON_NUMBER_TEST: 3060
OUTPUT_DIR: "logs/BoT_verif_msmt17"
[09/16 16:12:14] fastreid INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  NAIVE_WAY: True
  NUM_INSTANCE: 4
  NUM_WORKERS: 8
  PERSON_NUMBER: 1041
  PERSON_NUMBER_TEST: 3060
  PK_SAMPLER: True
  SEQ_LEN: 8
  TEST_SEQ_LEN: 0
DATASETS:
  COMBINEALL: False
  NAMES: ('Market1501',)
  TESTS: ('Market1501',)
INPUT:
  AUGMIX_PROB: 0.0
  AUTOAUG_PROB: 0.0
  CJ:
    BRIGHTNESS: 0.15
    CONTRAST: 0.15
    ENABLED: False
    HUE: 0.1
    PROB: 0.5
    SATURATION: 0.1
  DO_AUGMIX: False
  DO_AUTOAUG: False
  DO_FLIP: True
  DO_PAD: True
  DO_RANDAUG: False
  FLIP_PROB: 0.5
  MIX_TRACKLET: False
  PADDING: 10
  PADDING_MODE: constant
  RANDAUG_PROB: 0.5
  RANDAUG_STR: rand-m9-mstd0.5
  REA:
    ENABLED: True
    PROB: 0.5
    VALUE: [151.98, 142.29000000000002, 126.735]
  RPT:
    ENABLED: False
    PROB: 0.5
  SIZE_TEST: [256, 128]
  SIZE_TRAIN: [256, 128]
MODEL:
  BACKBONE:
    DEPTH: 50x
    FEAT_DIM: 2560
    LAST_STRIDE: 1
    NAME: build_resnet_backbone
    NORM: BN
    PRETRAIN: True
    PRETRAIN_PATH: 
    REMOVE: (3, 4)
    WITH_IBN: False
    WITH_NL: False
    WITH_SE: False
  DEVICE: cuda
  FREEZE_LAYERS: ['']
  HEADS:
    CLS_LAYER: linear
    EMBEDDING_DIM: 0
    HASH_LAYER_DIMS: []
    HASH_LAYER_NUM: 1
    MARGIN: 0.15
    NAME: EmbeddingHead
    NECK_FEAT: before
    NORM: BN
    NUM_CLASSES: 0
    POOL_LAYER: avgpool
    SCALE: 128
    TEMP: 1.0
    WITH_BNNECK: True
  LOSSES:
    CE:
      ALPHA: 0.2
      EPSILON: 0.1
      SCALE: 1.0
    CIRCLE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    COSFACE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    FL:
      ALPHA: 0.25
      GAMMA: 2
      SCALE: 1.0
    NAME: VerificationLoss
    TRI:
      HARD_MINING: True
      MARGIN: 0.3
      NORM_FEAT: False
      SCALE: 1.0
  META_ARCHITECTURE: BaselineVerifMemBank
  PIXEL_MEAN: [123.675, 116.28, 103.53]
  PIXEL_STD: [58.395, 57.120000000000005, 57.375]
  TRANSFORMER:
    DEPTH: 12
    EMBED_DIM: 768
    ENABLE_POS: False
    FEATURE_DIM: 2048
    INPUT_SIZE: (512, 64, 32)
    NAME: TransformerHead
    NUM_HEADS: 3
    PART_H: 4
    PART_STR: ('4x1',)
    PART_V: 1
    PATH_DROP: 0.1
    POS_DROP: 0.0
  TRANSFORMER_S:
    ATTN_DROP: 0.0
    CE_SCALE: 1.0
    DEPTH: 12
    EMBED_DIM: 768
    ENABLE_POS: False
    FEATURE_DIM: 2048
    GAP: False
    INPUT_SIZE: (512, 64, 32)
    LOCAL_PART: 4
    NAME: SpatialTransformerHead
    NUM_HEADS: 3
    PART_STR: 8x4
    PATH_DROP: 0.1
    POS_DROP: 0.0
    RET_ALL: False
  TRANSFORMER_T:
    ATTN_DROP: 0.0
    DEPTH: 12
    EMBED_DIM: 768
    ENABLE_POS: False
    GAP: False
    NAME: TemporalTransformerHead
    NUM_HEADS: 3
    PATH_DROP: 0.1
    POS_DROP: 0.0
    RET_ALL: False
    RET_ATTN: False
  WEIGHTS: 
OUTPUT_DIR: logs/BoT_verif_msmt17
SOLVER:
  BASE_LR: 0.00035
  BIAS_LR_FACTOR: 2.0
  CHECKPOINT_PERIOD: 30
  CLIP_GRADIENTS:
    CLIP_TYPE: norm
    CLIP_VALUE: 5.0
    ENABLED: False
    NORM_TYPE: 2.0
  DELAY_EPOCHS: 0
  ETA_MIN_LR: 1e-07
  FP16_ENABLED: True
  FREEZE_FC_ITERS: 0
  FREEZE_ITERS: 0
  GAMMA: 0.1
  HEADS_LR_FACTOR: 1.0
  IMS_PER_BATCH: 32
  MAX_EPOCH: 60
  MOMENTUM: 0.9
  OPT: Adam
  SCHED: MultiStepLR
  STEPS: [40, 90]
  TRANS_LR_FACTOR: 1.0
  WARMUP_FACTOR: 0.1
  WARMUP_ITERS: 2000
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0005
  WEIGHT_DECAY_BIAS: 0.0005
  WEIGHT_DECAY_NORM: 0.0005
  WEIGHT_DECAY_TRANS: 0.0005
TEST:
  AQE:
    ALPHA: 3.0
    ENABLED: False
    QE_K: 5
    QE_TIME: 1
  ERASE_NUM: 64
  EVAL_PERIOD: 3
  FLIP_ENABLED: False
  HASH_RATE: 0.3
  IMS_PER_BATCH: 128
  METRIC: cosine
  NEIGHBOR_RANGE: 100
  PRECISE_BN:
    DATASET: Market1501
    ENABLED: False
    NUM_ITER: 300
  RERANK:
    ENABLED: False
    K1: 20
    K2: 6
    LAMBDA: 0.3
  ROC_ENABLED: False
  SEQ_TEST: False
  TIMES: 1
  VERIF: False
[09/16 16:12:14] fastreid INFO: Full config saved to /home/huangju/codes/fast-reid/logs/BoT_verif_msmt17/config.yaml
[09/16 16:12:14] fastreid.utils.env INFO: Using a generated random seed 14983841
[09/16 16:12:16] fastreid INFO: Model:
BaselineVerifMemBank(
  (heads): EmbeddingHead(
    (pool_layer): AdaptiveAvgPool2d(output_size=1)
    (bottleneck): Sequential(
      (0): BatchNorm(2560, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (classifier): Linear(in_features=2560, out_features=0, bias=False)
  )
  (verif_model): VerifHead(
    (pool_layer): AdaptiveAvgPool2d(output_size=1)
    (bottleneck): Sequential(
      (0): Conv2d(2560, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
    )
    (classifier): Sequential(
      (0): Linear(in_features=1024, out_features=512, bias=True)
      (1): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): Dropout(p=0.2, inplace=False)
      (3): PReLU(num_parameters=1)
      (4): Linear(in_features=512, out_features=256, bias=True)
      (5): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (6): Dropout(p=0.2, inplace=False)
      (7): PReLU(num_parameters=1)
      (8): Linear(in_features=256, out_features=128, bias=True)
      (9): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (10): Dropout(p=0.2, inplace=False)
      (11): PReLU(num_parameters=1)
      (12): Linear(in_features=128, out_features=64, bias=True)
      (13): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (14): Dropout(p=0.2, inplace=False)
      (15): PReLU(num_parameters=1)
      (16): Linear(in_features=64, out_features=32, bias=True)
      (17): BatchNorm1d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (18): Dropout(p=0.2, inplace=False)
      (19): PReLU(num_parameters=1)
      (20): Linear(in_features=32, out_features=16, bias=True)
      (21): BatchNorm1d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (22): Dropout(p=0.2, inplace=False)
      (23): PReLU(num_parameters=1)
      (24): Linear(in_features=16, out_features=2, bias=False)
    )
    (drop): Dropout(p=0.5, inplace=False)
  )
)
[09/16 16:12:16] fastreid.utils.checkpoint INFO: No checkpoint found. Training model from scratch
[09/16 16:12:16] fastreid INFO: Start training from epoch 0
[09/16 16:23:23] fastreid.utils.events INFO:  epoch/iter: 0/199  total_loss: 306.6  loss_bank_verif: 306.6  lr: 6.63e-05  max_mem: 8371M
[09/16 16:25:46] fastreid INFO: training accuracy_positive is tensor([0.0283], device='cuda:0')
[09/16 16:25:46] fastreid.utils.events INFO:  eta: 10:21:51  epoch/iter: 0/257  total_loss: 269.8  loss_bank_verif: 269.8  lr: 7.55e-05  max_mem: 8371M
[09/16 16:31:49] fastreid.utils.events INFO:  eta: 10:40:33  epoch/iter: 1/399  total_loss: 184.7  loss_bank_verif: 184.7  lr: 9.78e-05  max_mem: 8371M
[09/16 16:35:54] fastreid INFO: training accuracy_positive is tensor([0.0005], device='cuda:0')
[09/16 16:35:54] fastreid.utils.events INFO:  eta: 8:44:57  epoch/iter: 1/515  total_loss: 124.8  loss_bank_verif: 124.8  lr: 1.16e-04  max_mem: 8371M
[09/16 16:38:52] fastreid.utils.events INFO:  eta: 8:44:01  epoch/iter: 2/599  total_loss: 92.98  loss_bank_verif: 92.98  lr: 1.29e-04  max_mem: 8371M
[09/16 16:44:38] fastreid INFO: training accuracy_positive is tensor([0.2269], device='cuda:0')
[09/16 16:44:38] fastreid.utils.events INFO:  eta: 8:04:58  epoch/iter: 2/773  total_loss: 50.12  loss_bank_verif: 50.12  lr: 1.57e-04  max_mem: 8371M
